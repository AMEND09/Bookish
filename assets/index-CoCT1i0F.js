const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/quagga.min-CA_kn7cW.js","assets/vendor-CGGxujwj.js"])))=>i.map(i=>d[i]);
var gt=Object.defineProperty;var yt=(i,t,c)=>t in i?gt(i,t,{enumerable:!0,configurable:!0,writable:!0,value:c}):i[t]=c;var ce=(i,t,c)=>yt(i,typeof t!="symbol"?t+"":t,c);import{a as pt,b as bt,g as vt,c as ke,r as E,u as z,d as tt,e as wt,R as jt,B as Nt,f as St,h as W}from"./vendor-CGGxujwj.js";import{r as kt,c as Ct,a as Et}from"./gun-CJ6ok8hl.js";import{B as q,U as st,L as Tt,E as At,a as Pt,A as Re,T as rt,P as ae,H as Te,b as we,S as _t,c as Ae,d as Bt,e as Dt,f as ot,M as nt,C as le,g as It,F as Rt,h as Oe,i as ue,j as Ot,k as Ut,l as Z,m as Ue,n as Fe,X as De,o as Ge,I as Ft,p as Gt,q as Lt,r as Mt,s as me,t as Jt,u as at,v as $t,w as Ht,x as Yt,y as Kt,z as lt,D as Le,G as Pe,J as qt,K as zt,N as Me,O as Je,Z as Wt,R as Vt}from"./icons-B0GFU1WR.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function c(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=c(s);fetch(s.href,r)}})();var Ce={exports:{}},de={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $e;function Qt(){if($e)return de;$e=1;var i=pt(),t=Symbol.for("react.element"),c=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function l(h,a,d){var u,n={},f=null,v=null;d!==void 0&&(f=""+d),a.key!==void 0&&(f=""+a.key),a.ref!==void 0&&(v=a.ref);for(u in a)o.call(a,u)&&!r.hasOwnProperty(u)&&(n[u]=a[u]);if(h&&h.defaultProps)for(u in a=h.defaultProps,a)n[u]===void 0&&(n[u]=a[u]);return{$$typeof:t,type:h,key:f,ref:v,props:n,_owner:s.current}}return de.Fragment=c,de.jsx=l,de.jsxs=l,de}var He;function Xt(){return He||(He=1,Ce.exports=Qt()),Ce.exports}var e=Xt(),pe={},Ye;function Zt(){if(Ye)return pe;Ye=1;var i=bt();return pe.createRoot=i.createRoot,pe.hydrateRoot=i.hydrateRoot,pe}var es=Zt(),ts=kt();const V=vt(ts);var je={exports:{}};je.exports;var Ke;function ss(){return Ke||(Ke=1,function(i){(function(){function t(o,s){return s?Ct(o):o.slice?t[r(o)]:function(l,h){o(l={exports:{}}),t[r(h)]=l.exports};function r(l){return l.split("/").slice(-1).toString().replace(".js","")}}var c=i;t(function(o){typeof self<"u"&&(o.window=self),typeof window<"u"&&(o.window=window);var s=o.window||o,r,l=s.SEA||{};(l.window=o.window)&&(l.window.SEA=l);try{r+""!=typeof c&&(c.exports=l)}catch{}o.exports=l})(t,"./root"),t(function(o){var s=t("./root");try{s.window&&location.protocol.indexOf("s")<0&&location.host.indexOf("localhost")<0&&!/^127\.\d+\.\d+\.\d+$/.test(location.hostname)&&location.protocol.indexOf("file:")<0&&(console.warn("HTTPS needed for WebCrypto in SEA, redirecting..."),location.protocol="https:")}catch{}})(t,"./https"),t(function(o){var s;if(s+""==typeof btoa){if(s+""==typeof Buffer)try{ke.Buffer=t("buffer",1).Buffer}catch{console.log("Please `npm install buffer` or add it to your package.json !")}ke.btoa=function(r){return Buffer.from(r,"binary").toString("base64")},ke.atob=function(r){return Buffer.from(r,"base64").toString("binary")}}})(t,"./base64"),t(function(o){t("./base64");function s(){}Object.assign(s,{from:Array.from}),s.prototype=Object.create(Array.prototype),s.prototype.toString=function(r,l,h){r=r||"utf8",l=l||0;const a=this.length;if(r==="hex"){const d=new Uint8Array(this);return[...Array((h&&h+1||a)-l).keys()].map(u=>d[u+l].toString(16).padStart(2,"0")).join("")}if(r==="utf8")return Array.from({length:(h||a)-l},(d,u)=>String.fromCharCode(this[u+l])).join("");if(r==="base64")return btoa(this)},o.exports=s})(t,"./array"),t(function(o){t("./base64");var s=t("./array");function r(...l){return console.warn("new SafeBuffer() is depreciated, please use SafeBuffer.from()"),r.from(...l)}r.prototype=Object.create(Array.prototype),Object.assign(r,{from(){if(!Object.keys(arguments).length||arguments[0]==null)throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");const l=arguments[0];let h;if(typeof l=="string"){const d=arguments[1]||"utf8";if(d==="hex"){const u=l.match(/([\da-fA-F]{2})/g).map(n=>parseInt(n,16));if(!u||!u.length)throw new TypeError("Invalid first argument for type 'hex'.");h=s.from(u)}else if(d==="utf8"||d==="binary"){const u=l.length,n=new Uint16Array(u);Array.from({length:u},(f,v)=>n[v]=l.charCodeAt(v)),h=s.from(n)}else if(d==="base64"){const u=atob(l),n=u.length,f=new Uint8Array(n);Array.from({length:n},(v,m)=>f[m]=u.charCodeAt(m)),h=s.from(f)}else d==="binary"?h=s.from(l):console.info("SafeBuffer.from unknown encoding: "+d);return h}if(l.byteLength,l.byteLength?l.byteLength:l.length){let d;return l instanceof ArrayBuffer&&(d=new Uint8Array(l)),s.from(d||l)}},alloc(l,h=0){return s.from(new Uint8Array(Array.from({length:l},()=>h)))},allocUnsafe(l){return s.from(new Uint8Array(Array.from({length:l})))},concat(l){if(!Array.isArray(l))throw new TypeError("First argument must be Array containing ArrayBuffer or Uint8Array instances.");return s.from(l.reduce((h,a)=>h.concat(Array.from(a)),[]))}}),r.prototype.from=r.from,r.prototype.toString=s.prototype.toString,o.exports=r})(t,"./buffer"),t(function(o){const s=t("./root"),r={Buffer:t("./buffer")};var l={},h;if(JSON.parseAsync=JSON.parseAsync||function(d,u,n){var f;try{u(f,JSON.parse(d,n))}catch(v){u(v)}},JSON.stringifyAsync=JSON.stringifyAsync||function(d,u,n,f){var v;try{u(v,JSON.stringify(d,n,f))}catch(m){u(m)}},r.parse=function(d,u){return new Promise(function(n,f){JSON.parseAsync(d,function(v,m){v?f(v):n(m)},u)})},r.stringify=function(d,u,n){return new Promise(function(f,v){JSON.stringifyAsync(d,function(m,w){m?v(m):f(w)},u,n)})},s.window&&(r.crypto=s.window.crypto||s.window.msCrypto,r.subtle=(r.crypto||l).subtle||(r.crypto||l).webkitSubtle,r.TextEncoder=s.window.TextEncoder,r.TextDecoder=s.window.TextDecoder,r.random=d=>r.Buffer.from(r.crypto.getRandomValues(new Uint8Array(r.Buffer.alloc(d))))),!r.TextDecoder){const{TextEncoder:d,TextDecoder:u}=t((h+""==typeof c?".":"")+"./lib/text-encoding",1);r.TextDecoder=u,r.TextEncoder=d}if(!r.crypto)try{var a=t("crypto",1);Object.assign(r,{crypto:a,random:u=>r.Buffer.from(a.randomBytes(u))});const{Crypto:d}=t("@peculiar/webcrypto",1);r.ossl=r.subtle=new d({directory:"ossl"}).subtle}catch{console.log("Please `npm install @peculiar/webcrypto` or add it to your package.json !")}o.exports=r})(t,"./shim"),t(function(o){var s=t("./root"),r=t("./shim"),l={};l.pbkdf2={hash:{name:"SHA-256"},iter:1e5,ks:64},l.ecdsa={pair:{name:"ECDSA",namedCurve:"P-256"},sign:{name:"ECDSA",hash:{name:"SHA-256"}}},l.ecdh={name:"ECDH",namedCurve:"P-256"},l.jwk=function(h,a){h=h.split(".");var d=h[0],u=h[1],n={kty:"EC",crv:"P-256",x:d,y:u,ext:!0};return n.key_ops=a?["sign"]:["verify"],a&&(n.d=a),n},l.keyToJwk=function(h){return{kty:"oct",k:h.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""),ext:!1,alg:"A256GCM"}},l.recall={validity:12*60*60,hook:function(h){return h}},l.check=function(h){return typeof h=="string"&&h.slice(0,4)==="SEA{"},l.parse=async function(a){try{var d=typeof a=="string";return d&&a.slice(0,4)==="SEA{"&&(a=a.slice(3)),d?await r.parse(a):a}catch{}return a},s.opt=l,o.exports=l})(t,"./settings"),t(function(o){var s=t("./shim");o.exports=async function(r,l){var h=typeof r=="string"?r:await s.stringify(r),a=await s.subtle.digest({name:l||"SHA-256"},new s.TextEncoder().encode(h));return s.Buffer.from(a)}})(t,"./sha256"),t(function(o){const s=t("./shim"),r=s.subtle,l=s.ossl?s.ossl:r,h=a=>l.digest({name:"SHA-1"},new ArrayBuffer(a));o.exports=h})(t,"./sha1"),t(function(o){var s=t("./root"),r=t("./shim"),l=t("./settings"),h=t("./sha256"),a;s.work=s.work||(async(d,u,n,f)=>{try{var v=(u||{}).epub||u;if(f=f||{},v instanceof Function&&(n=v,v=a),d=typeof d=="string"?d:await r.stringify(d),(f.name||"").toLowerCase().slice(0,3)==="sha"){var m=r.Buffer.from(await h(d,f.name),"binary").toString(f.encode||"base64");if(n)try{n(m)}catch(x){console.log(x)}return m}v=v||r.random(9);var w=await(r.ossl||r.subtle).importKey("raw",new r.TextEncoder().encode(d),{name:f.name||"PBKDF2"},!1,["deriveBits"]),g=await(r.ossl||r.subtle).deriveBits({name:f.name||"PBKDF2",iterations:f.iterations||l.pbkdf2.iter,salt:new r.TextEncoder().encode(f.salt||v),hash:f.hash||l.pbkdf2.hash},w,f.length||l.pbkdf2.ks*8);d=r.random(d.length);var j=r.Buffer.from(g,"binary").toString(f.encode||"base64");if(n)try{n(j)}catch(x){console.log(x)}return j}catch(x){if(console.log(x),s.err=x,s.throw)throw x;n&&n();return}}),o.exports=s.work})(t,"./work"),t(function(o){var s=t("./root"),r=t("./shim");t("./settings"),s.name=s.name||(async(l,h)=>{try{if(l)try{l()}catch(a){console.log(a)}return}catch(a){if(console.log(a),s.err=a,s.throw)throw a;l&&l();return}}),s.pair=s.pair||(async(l,h)=>{try{var a=r.ossl||r.subtle,d=await r.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]).then(async f=>{var v={};v.priv=(await r.subtle.exportKey("jwk",f.privateKey)).d;var m=await r.subtle.exportKey("jwk",f.publicKey);return v.pub=m.x+"."+m.y,v});try{var u=await a.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]).then(async f=>{var v={};v.epriv=(await a.exportKey("jwk",f.privateKey)).d;var m=await a.exportKey("jwk",f.publicKey);return v.epub=m.x+"."+m.y,v})}catch(f){if(s.window)throw f;if(f=="Error: ECDH is not a supported algorithm")console.log("Ignoring ECDH...");else throw f}u=u||{};var n={pub:d.pub,priv:d.priv,epub:u.epub,epriv:u.epriv};if(l)try{l(n)}catch(f){console.log(f)}return n}catch(f){if(console.log(f),s.err=f,s.throw)throw f;l&&l();return}}),o.exports=s.pair})(t,"./pair"),t(function(o){var s=t("./root"),r=t("./shim"),l=t("./settings"),h=t("./sha256"),a;s.sign=s.sign||(async(d,u,n,f)=>{try{if(f=f||{},!(u||f).priv){if(!s.I)throw"No signing key.";u=await s.I(null,{what:d,how:"sign",why:f.why})}if(a===d)throw"`undefined` not allowed.";var v=await l.parse(d),m=f.check=f.check||v;if(s.verify&&(s.opt.check(m)||m&&m.s&&m.m)&&a!==await s.verify(m,u)){var y=await l.parse(m);if(f.raw||(y="SEA"+await r.stringify(y)),n)try{n(y)}catch(N){console.log(N)}return y}var w=u.pub,g=u.priv,j=l.jwk(w,g),x=await h(v),k=await(r.ossl||r.subtle).importKey("jwk",j,{name:"ECDSA",namedCurve:"P-256"},!1,["sign"]).then(b=>(r.ossl||r.subtle).sign({name:"ECDSA",hash:{name:"SHA-256"}},b,new Uint8Array(x))),y={m:v,s:r.Buffer.from(k,"binary").toString(f.encode||"base64")};if(f.raw||(y="SEA"+await r.stringify(y)),n)try{n(y)}catch(b){console.log(b)}return y}catch(b){if(console.log(b),s.err=b,s.throw)throw b;n&&n();return}}),o.exports=s.sign})(t,"./sign"),t(function(o){var s=t("./root"),r=t("./shim"),l=t("./settings"),h=t("./sha256"),a;s.verify=s.verify||(async(n,f,v,m)=>{try{var w=await l.parse(n);if(f===!1){var g=await l.parse(w.m);if(v)try{v(g)}catch(S){console.log(S)}return g}m=m||{};var j=f.pub||f,x=s.opt.slow_leak?await s.opt.slow_leak(j):await(r.ossl||r.subtle).importKey("jwk",l.jwk(j),{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),k=await h(w.m),y,b,N,p;try{if(y=r.Buffer.from(w.s,m.encode||"base64"),b=new Uint8Array(y),N=await(r.ossl||r.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},x,b,new Uint8Array(k)),!N)throw"Signature did not match."}catch{if(s.opt.fallback)return await s.opt.fall_verify(n,f,v,m)}var A=N?await l.parse(w.m):a;if(v)try{v(A)}catch(S){console.log(S)}return A}catch(S){if(console.log(S),s.err=S,s.throw)throw S;v&&v();return}}),o.exports=s.verify;var d={};s.opt.slow_leak=n=>{if(d[n])return d[n];var f=l.jwk(n);return d[n]=(r.ossl||r.subtle).importKey("jwk",f,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),d[n]};var u=s.opt;s.opt.fall_verify=async function(n,f,v,m,w){if(w===s.opt.fallback)throw"Signature did not match";w=w||1;var g=n||"";n=s.opt.unpack(n)||n;var j=await l.parse(n),x=f.pub||f,k=await s.opt.slow_leak(x),y=w<=s.opt.fallback?r.Buffer.from(await r.subtle.digest({name:"SHA-256"},new r.TextEncoder().encode(await l.parse(j.m)))):await h(j.m),b,N,p;try{if(b=r.Buffer.from(j.s,m.encode||"base64"),N=new Uint8Array(b),p=await(r.ossl||r.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},k,N,new Uint8Array(y)),!p)throw"Signature did not match."}catch{try{b=r.Buffer.from(j.s,"utf8"),N=new Uint8Array(b),p=await(r.ossl||r.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},k,N,new Uint8Array(y))}catch{if(!p)throw"Signature did not match."}}var A=p?await l.parse(j.m):a;if(u.fall_soul=g["#"],u.fall_key=g["."],u.fall_val=n,u.fall_state=g[">"],v)try{v(A)}catch(S){console.log(S)}return A},s.opt.fallback=2})(t,"./verify"),t(function(o){var s=t("./shim"),r=t("./settings"),l=t("./sha256");const h=async(a,d,u)=>{const n=a+(d||s.random(8)).toString("utf8"),f=s.Buffer.from(await l(n),"binary"),v=r.keyToJwk(f);return await s.subtle.importKey("jwk",v,{name:"AES-GCM"},!1,["encrypt","decrypt"])};o.exports=h})(t,"./aeskey"),t(function(o){var s=t("./root"),r=t("./shim");t("./settings");var l=t("./aeskey"),h;s.encrypt=s.encrypt||(async(a,d,u,n)=>{try{n=n||{};var f=(d||n).epriv||d;if(h===a)throw"`undefined` not allowed.";if(!f){if(!s.I)throw"No encryption key.";d=await s.I(null,{what:a,how:"encrypt",why:n.why}),f=d.epriv||d}var v=typeof a=="string"?a:await r.stringify(a),m={s:r.random(9),iv:r.random(15)},w=await l(f,m.s,n).then(j=>r.subtle.encrypt({name:n.name||"AES-GCM",iv:new Uint8Array(m.iv)},j,new r.TextEncoder().encode(v))),g={ct:r.Buffer.from(w,"binary").toString(n.encode||"base64"),iv:m.iv.toString(n.encode||"base64"),s:m.s.toString(n.encode||"base64")};if(n.raw||(g="SEA"+await r.stringify(g)),u)try{u(g)}catch(j){console.log(j)}return g}catch(j){if(console.log(j),s.err=j,s.throw)throw j;u&&u();return}}),o.exports=s.encrypt})(t,"./encrypt"),t(function(o){var s=t("./root"),r=t("./shim"),l=t("./settings"),h=t("./aeskey");s.decrypt=s.decrypt||(async(a,d,u,n)=>{try{n=n||{};var f=(d||n).epriv||d;if(!f){if(!s.I)throw"No decryption key.";d=await s.I(null,{what:a,how:"decrypt",why:n.why}),f=d.epriv||d}var v=await l.parse(a),m,w,g;try{m=r.Buffer.from(v.s,n.encode||"base64"),w=r.Buffer.from(v.iv,n.encode||"base64"),g=r.Buffer.from(v.ct,n.encode||"base64");var j=await h(f,m,n).then(k=>r.subtle.decrypt({name:n.name||"AES-GCM",iv:new Uint8Array(w),tagLength:128},k,new Uint8Array(g)))}catch{if(n.encode==="utf8")throw"Could not decrypt";if(s.opt.fallback)return n.encode="utf8",await s.decrypt(a,d,u,n)}var x=await l.parse(new r.TextDecoder("utf8").decode(j));if(u)try{u(x)}catch(k){console.log(k)}return x}catch(k){if(console.log(k),s.err=k,s.throw)throw k;u&&u();return}}),o.exports=s.decrypt})(t,"./decrypt"),t(function(o){var s=t("./root"),r=t("./shim");t("./settings"),s.secret=s.secret||(async(h,a,d,u)=>{try{if(u=u||{},!a||!a.epriv||!a.epub){if(!s.I)throw"No secret mix.";a=await s.I(null,{what:h,how:"secret",why:u.why})}var n=h.epub||h,f=a.epub,v=a.epriv,m=r.ossl||r.subtle,w=l(n),g=Object.assign({public:await m.importKey(...w,!0,[])},{name:"ECDH",namedCurve:"P-256"}),j=l(f,v),x=await m.importKey(...j,!1,["deriveBits"]).then(async y=>{var b=await m.deriveBits(g,y,256),N=new Uint8Array(b),p=await m.importKey("raw",N,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);return m.exportKey("jwk",p).then(({k:A})=>A)}),k=x;if(d)try{d(k)}catch(y){console.log(y)}return k}catch(y){if(console.log(y),s.err=y,s.throw)throw y;d&&d();return}});var l=(h,a)=>{var[d,u]=h.split("."),n=a?{d:a}:{};return["jwk",Object.assign(n,{x:d,y:u,kty:"EC",crv:"P-256",ext:!0}),{name:"ECDH",namedCurve:"P-256"}]};o.exports=s.secret})(t,"./secret"),t(function(o){var s=t("./root");s.certify=s.certify||(async(r,l={},h,a,d={})=>{try{if(console.log("SEA.certify() is an early experimental community supported method that may change API behavior without warning in any future version."),r=(()=>{var k=[];if(r){if((typeof r=="string"||Array.isArray(r))&&r.indexOf("*")>-1)return"*";if(typeof r=="string")return r;if(Array.isArray(r)){if(r.length===1&&r[0])return typeof r[0]=="object"&&r[0].pub?r[0].pub:typeof r[0]=="string"?r[0]:null;r.map(y=>{typeof y=="string"?k.push(y):typeof y=="object"&&y.pub&&k.push(y.pub)})}return typeof r=="object"&&r.pub?r.pub:k.length>0?k:null}})(),!r)return console.log("No certificant found.");const n=d.expiry&&(typeof d.expiry=="number"||typeof d.expiry=="string")?parseFloat(d.expiry):null,f=(l||{}).read?l.read:null,v=(l||{}).write?l.write:typeof l=="string"||Array.isArray(l)||l["+"]||l["#"]||l["."]||l["="]||l["*"]||l[">"]||l["<"]?l:null,m=(d||{}).block||(d||{}).blacklist||(d||{}).ban||{},w=m.read&&(typeof m.read=="string"||(m.read||{})["#"])?m.read:null,g=typeof m=="string"?m:m.write&&(typeof m.write=="string"||m.write["#"])?m.write:null;if(!f&&!v)return console.log("No policy found.");const j=JSON.stringify({c:r,...n?{e:n}:{},...f?{r:f}:{},...v?{w:v}:{},...w?{rb:w}:{},...g?{wb:g}:{}});var u=await s.sign(j,h,null,{raw:1});if(d.raw||(u="SEA"+JSON.stringify(u)),a)try{a(u)}catch(k){console.log(k)}return u}catch(n){if(s.err=n,s.throw)throw n;a&&a();return}}),o.exports=s.certify})(t,"./certify"),t(function(o){var s=t("./shim"),r=t("./root");r.work=t("./work"),r.sign=t("./sign"),r.verify=t("./verify"),r.encrypt=t("./encrypt"),r.decrypt=t("./decrypt"),r.certify=t("./certify"),r.random=r.random||s.random,r.Buffer=r.Buffer||t("./buffer"),r.keyid=r.keyid||(async l=>{try{const h=s.Buffer.concat(l.replace(/-/g,"+").replace(/_/g,"/").split(".").map(n=>s.Buffer.from(n,"base64"))),a=s.Buffer.concat([s.Buffer.from([153,h.length/256,h.length%256]),h]),d=await sha1hash(a),u=s.Buffer.from(d,"binary");return u.toString("hex",u.length-8)}catch(h){throw console.log(h),h}}),((r.window||{}).GUN||{}).SEA=r,o.exports=r})(t,"./sea"),t(function(o){var s=t("./sea"),r,l;s.window?r=s.window.GUN||{chain:{}}:r=t((l+""==typeof c?".":"")+"./gun",1),s.GUN=r;function h(d){this._={$:this}}h.prototype=function(){function d(){}return d.prototype=r.chain,new d}(),h.prototype.constructor=h,r.chain.user=function(d){var u=this,f=u.back(-1),n;if(d)return d=s.opt.pub((d._||"")["#"])||d,f.get("~"+d);if(n=f.back("user"))return n;var f=f._,v=f,m=v.opt.uuid||a;return(v=(n=v.user=u.chain(new h))._).opt={},v.opt.uuid=function(w){var g=m(),j=f.user;return!j||!(j=j.is)||!(j=j.pub)||(g="~"+j+"/"+g,w&&w.call&&w(null,g)),g},n};function a(){return r.state().toString(36).replace(".","")}r.User=h,h.GUN=r,h.SEA=r.SEA=s,o.exports=h})(t,"./user"),t(function(o){var s,r=""+s!=typeof GUN?GUN||{chain:{}}:t((""+s==typeof c?".":"")+"./gun",1);r.chain.then=function(l,h){var a=this,d=new Promise(function(u,n){a.once(u,h)});return l?d.then(l):d}})(t,"./then"),t(function(o){var s=t("./user"),r=s.SEA,l=s.GUN,h=function(){};s.prototype.create=function(...a){var d=typeof a[0]=="object"&&(a[0].pub||a[0].epub)?a[0]:typeof a[1]=="object"&&(a[1].pub||a[1].epub)?a[1]:null,u=d&&(d.pub||d.epub)?d.pub:typeof a[0]=="string"?a[0]:null,n=d&&(d.pub||d.epub)?d:u&&typeof a[1]=="string"?a[1]:null,f=a.filter(k=>typeof k=="function")[0]||null,v=a&&a.length>1&&typeof a[a.length-1]=="object"?a[a.length-1]:{},m=this,w=m._,g=m.back(-1);if(f=f||h,v=v||{},v.check!==!1){var j;if(u||(j="No user."),(n||"").length<8&&(j="Password too short!"),j)return f({err:l.log(j)}),m}if(w.ing)return(f||h)({err:l.log("User is already being created or authenticated!"),wait:!0}),m;w.ing=!0;var x={};return x.a=function(k){if(x.pubs=k,k&&!v.already){var y={err:l.log("User already created!")};w.ing=!1,(f||h)(y),m.leave();return}x.salt=String.random(64),r.work(n,x.salt,x.b)},x.b=function(k){x.proof=k,d?x.c(d):r.pair(x.c)},x.c=function(k){var y;x.pair=k||{},(y=w.root.user)&&(y._.sea=k,y.is={pub:k.pub,epub:k.epub,alias:u}),x.data={pub:k.pub},x.d()},x.d=function(){x.data.alias=u,x.e()},x.e=function(){x.data.epub=x.pair.epub,r.encrypt({priv:x.pair.priv,epriv:x.pair.epriv},x.proof,x.f,{raw:1})},x.f=function(k){x.data.auth=JSON.stringify({ek:k,s:x.salt}),x.g(x.data.auth)},x.g=function(k){var y;x.data.auth=x.data.auth||k,g.get(y="~"+x.pair.pub).put(x.data).on(x.h);var b={};b[y]={"#":y},g.get("~@"+u).put(b).get(y).on(x.i)},x.h=function(k,y,b,N){N.off(),x.h.ok=1,x.i()},x.i=function(k,y,b,N){N&&(x.i.ok=1,N.off()),!(!x.h.ok||!x.i.ok)&&(w.ing=!1,f({ok:0,pub:x.pair.pub}),h===f&&(d?m.auth(d):m.auth(u,n)))},g.get("~@"+u).once(x.a),m},s.prototype.leave=function(a,d){var u=this,n=u.back(-1)._.user;if(n&&(delete n.is,delete n._.is,delete n._.sea),r.window)try{var f={};f=r.window.sessionStorage,delete f.recall,delete f.pair}catch{}return u}})(t,"./create"),t(function(o){var s=t("./user"),r=s.SEA,l=s.GUN,h=function(){};s.prototype.auth=function(...d){var u=typeof d[0]=="object"&&(d[0].pub||d[0].epub)?d[0]:typeof d[1]=="object"&&(d[1].pub||d[1].epub)?d[1]:null,n=!u&&typeof d[0]=="string"?d[0]:null,f=(n||u&&!(u.priv&&u.epriv))&&typeof d[1]=="string"?d[1]:null,v=d.filter(b=>typeof b=="function")[0]||null,m=d&&d.length>1&&typeof d[d.length-1]=="object"?d[d.length-1]:{},w=this,g=w._,j=w.back(-1);if(g.ing)return(v||h)({err:l.log("User is already being created or authenticated!"),wait:!0}),w;g.ing=!0;var x={},k,y=9;return x.a=function(b){if(!b)return x.b();if(!b.pub){var N=[];return Object.keys(b).forEach(function(p){p!="_"&&N.push(b[p])}),x.b(N)}if(x.name)return x.f(b);x.c((x.data=b).auth)},x.b=function(b){var N=(x.list=(x.list||[]).concat(b||[])).shift();if(k===N){if(x.name)return x.err("Your user account is not published for dApps to access, please consider syncing it online, or allowing local access by adding your device as a peer.");if(n&&y--){j.get("~@"+n).once(x.a);return}return x.err("Wrong user or password.")}j.get(N).once(x.a)},x.c=function(b){if(k===b)return x.b();if(typeof b=="string")return x.c(a(b));r.work(f,(x.auth=b).s,x.d,x.enc)},x.d=function(b){r.decrypt(x.auth.ek,b,x.e,x.enc)},x.e=function(b){if(k===b)return x.enc?(x.enc=null,x.b()):(x.enc={encode:"utf8"},x.c(x.auth));x.half=b,x.f(x.data)},x.f=function(b){var N=x.half||{},p=x.data||{};x.g(x.lol={pub:b.pub||p.pub,epub:b.epub||p.epub,priv:b.priv||N.priv,epriv:b.epriv||N.epriv})},x.g=function(b){if(!b||!b.pub||!b.epub)return x.b();x.pair=b;var N=j._.user,p=N._;p.tag;var A=p.opt;p=N._=j.get("~"+b.pub)._,p.opt=A,N.is={pub:b.pub,epub:b.epub,alias:n||b.pub},p.sea=x.pair,g.ing=!1;try{f&&k==(a(g.root.graph["~"+b.pub].auth)||"")[":"]&&(m.shuffle=m.change=f)}catch{}if(m.change?x.z():(v||h)(p),r.window&&(w.back("user")._.opt||m).remember)try{var S={};S=r.window.sessionStorage,S.recall=!0,S.pair=JSON.stringify(b)}catch{}try{j._.tag.auth?j._.on("auth",p):setTimeout(function(){j._.on("auth",p)},1)}catch(T){l.log("Your 'auth' callback crashed with:",T)}},x.h=function(b){if(!b)return x.b();if(n=b.alias,n||(n=b.alias="~"+u.pub),!b.auth)return x.g(u);u=null,x.c((x.data=b).auth)},x.z=function(){x.salt=String.random(64),r.work(m.change,x.salt,x.y)},x.y=function(b){r.encrypt({priv:x.pair.priv,epriv:x.pair.epriv},b,x.x,{raw:1})},x.x=function(b){x.w(JSON.stringify({ek:b,s:x.salt}))},x.w=function(b){if(m.shuffle){console.log("migrate core account from UTF8 & shuffle");var N={};Object.keys(x.data).forEach(function(p){N[p]=x.data[p]}),delete N._,N.auth=b,j.get("~"+x.pair.pub).put(N)}j.get("~"+x.pair.pub).get("auth").put(b,v||h)},x.err=function(b){var N={err:l.log(b||"User cannot be found!")};g.ing=!1,(v||h)(N)},x.plugin=function(b){if(!(x.name=b))return x.err();var N=[b];b[0]!=="~"&&(N[1]="~"+b,N[2]="~@"+b),x.b(N)},u?u.priv&&u.epriv?x.g(u):j.get("~"+u.pub).once(x.h):n?j.get("~@"+n).once(x.a):!n&&!f&&r.name(x.plugin),w};function a(d){if(typeof d!="string")return d;try{d=JSON.parse(d)}catch{d={}}return d}})(t,"./auth"),t(function(o){var s=t("./user"),r=s.SEA;s.GUN,s.prototype.recall=function(l,h){var a=this,d=a.back(-1);if(l=l||{},l&&l.sessionStorage){if(r.window)try{var u={};u=r.window.sessionStorage,u&&(d._.opt.remember=!0,(a.back("user")._.opt||l).remember=!0,(u.recall||u.pair)&&d.user().auth(JSON.parse(u.pair),h))}catch{}return a}return a}})(t,"./recall"),t(function(o){var s=t("./user"),r=s.SEA,l=s.GUN,h=function(){};s.prototype.pair=function(){var a=this,d;try{d=new Proxy({DANGER:"☠"},{get:function(u,n,f){if(!(!a.is||!(a._||"").sea))return a._.sea[n]}})}catch{}return d},s.prototype.delete=async function(a,d,u){console.log("user.delete() IS DEPRECATED AND WILL BE MOVED TO A MODULE!!!");var n=this;n.back(-1);var f=n.back("user");try{f.auth(a,d,function(v){var m=(f.is||{}).pub;f.map().once(function(){this.put(null)}),f.leave(),(u||h)({ok:0})})}catch(v){l.log("User.delete failed! Error:",v)}return n},s.prototype.alive=async function(){console.log("user.alive() IS DEPRECATED!!!");const a=this.back(-1);try{return await authRecall(a),a._.user._}catch{const u="No session!";throw l.log(u),{err:u}}},s.prototype.trust=async function(a){console.log("`.trust` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!"),l.is(a)&&a.get("pub").get((d,u)=>{console.log(d,u)}),a.get("trust").get(path).put(theirPubkey)},s.prototype.grant=function(a,d){console.log("`.grant` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var u=this,n=u.back(-1).user(),f=n._.sea,v="";return u.back(function(m){m.is||(v+=m.get||"")}),async function(){var m,w=await n.get("grant").get(f.pub).get(v).then();w=await r.decrypt(w,f),w||(w=r.random(16).toString(),m=await r.encrypt(w,f),n.get("grant").get(f.pub).get(v).put(m));var g=a.get("pub").then(),j=a.get("epub").then();g=await g,j=await j;var x=await r.secret(j,f);m=await r.encrypt(w,x),n.get("grant").get(g).get(v).put(m,d)}(),u},s.prototype.secret=function(a,d){console.log("`.secret` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var u=this,n=u.back(-1).user(),f=n.pair(),v="";return u.back(function(m){m.is||(v+=m.get||"")}),async function(){var m,w=await n.get("trust").get(f.pub).get(v).then();w=await r.decrypt(w,f),w||(w=r.random(16).toString(),m=await r.encrypt(w,f),n.get("trust").get(f.pub).get(v).put(m)),m=await r.encrypt(a,w),u.put(m,d)}(),u},o.exports=s})(t,"./share"),t(function(o){var s=t("./sea"),r=t("./settings"),l,h=(s.window||"").GUN||t((""+l==typeof c?".":"")+"./gun",1);h.on("opt",function(m){m.sea||(m.sea={own:{}},m.on("put",a,m)),this.to.next(m)});function a(m){var w=this,g=w.as,j=m.put,x=j["#"],k=j["."],y=j[":"],b=j[">"],N=m["#"],p;if(!(!x||!k)){if((m._||"").faith&&(g.opt||"").faith&&typeof m._=="function"){s.opt.pack(j,function(S){s.verify(S,!1,function(T){j["="]=s.opt.unpack(T),w.to.next(m)})});return}var A=function(S){g.on("in",{"@":N,err:m.err=S})};if((m._||"").DBG&&((m._||"").DBG.c=+new Date),0<=x.indexOf("<?")&&(p=parseFloat(x.split("<?")[1]||""),p&&b<h.state()-p*1e3)){(p=m._)&&p.stun&&p.stun--;return}if(x==="~@"){a.alias(w,m,y,k,x,g,A);return}if(x.slice(0,2)==="~@"){a.pubs(w,m,y,k,x,g,A);return}if(p=s.opt.pub(x)){a.pub(w,m,y,k,x,g,A,g.user||"",p);return}if(0<=x.indexOf("#")){a.hash(w,m,y,k,x,g,A);return}a.any(w,m,y,k,x,g,A,g.user||"")}}a.hash=function(m,w,g,j,x,k,y){s.work(g,null,function(b){function N(p){let A="";for(let S=0;S<p.length;S++)A+=S-1&1?"":String.fromCharCode(parseInt(p.substring(S-1,S+1),16));return btoa(A)}if(b&&b===j.split("#").slice(-1)[0])return m.to.next(w);if(b&&b===N(j.split("#").slice(-1)[0]))return m.to.next(w);y("Data hash not same as hash!")},{name:"SHA-256"})},a.alias=function(m,w,g,j,x,k,y){if(!g)return y("Data must exist!");if("~@"+j===u(g))return m.to.next(w);y("Alias not same!")},a.pubs=function(m,w,g,j,x,k,y){if(!g)return y("Alias must exist!");if(j===u(g))return m.to.next(w);y("Alias not same!")},a.pub=async function(m,w,g,j,x,k,y,b,N){var p;const A=await r.parse(g)||{},S=(T,B,C)=>{if(T.m&&T.s&&B&&N)return s.verify(T,N,_=>{if(l!==_&&l!==_.e&&w.put[">"]&&w.put[">"]>parseFloat(_.e))return y("Certificate expired.");if(l!==_&&_.c&&_.w&&(_.c===B||_.c.indexOf("*")>-1)){let L=x.indexOf("/")>-1?x.replace(x.substring(0,x.indexOf("/")+1),""):"";String.match=String.match||h.text.match;const M=Array.isArray(_.w)?_.w:typeof _.w=="object"||typeof _.w=="string"?[_.w]:[];for(const G of M)if(String.match(L,G["#"])&&String.match(j,G["."])||!G["."]&&String.match(L,G["#"])||!G["#"]&&String.match(j,G["."])||String.match(L?L+"/"+j:j,G["#"]||G)){if(G["+"]&&G["+"].indexOf("*")>-1&&L&&L.indexOf(B)==-1&&j.indexOf(B)==-1)return y(`Path "${L}" or key "${j}" must contain string "${B}".`);if(_.wb&&(typeof _.wb=="string"||(_.wb||{})["#"])){var I=m.as.root.$.back(-1);return typeof _.wb=="string"&&_.wb.slice(0,1)!=="~"&&(I=I.get("~"+N)),I.get(_.wb).get(B).once(P=>P&&(P===1||P===!0)?y(`Certificant ${B} blocked.`):C(_))}return C(_)}return y("Certificate verification fail.")}})};if(j==="pub"&&"~"+N===x)return g===N?m.to.next(w):y("Account not same!");if((p=b.is)&&p.pub&&!A["*"]&&!A["+"]&&(N===p.pub||N!==p.pub&&((w._.msg||{}).opt||{}).cert)){s.opt.pack(w.put,T=>{s.sign(T,b._.sea,async function(B){if(l===B)return y(s.err||"Signature fail.");if(w.put[":"]={":":p=s.opt.unpack(B.m),"~":B.s},w.put["="]=p,N===b.is.pub){(p=u(g))&&((k.sea.own[p]=k.sea.own[p]||{})[N]=1),JSON.stringifyAsync(w.put[":"],function(C,_){return C?y(C||"Stringify error."):(w.put[":"]=_,m.to.next(w))});return}if(N!==b.is.pub&&((w._.msg||{}).opt||{}).cert){const C=await r.parse(w._.msg.opt.cert);C&&C.m&&C.s&&S(C,b.is.pub,_=>{w.put[":"]["+"]=C,w.put[":"]["*"]=b.is.pub,JSON.stringifyAsync(w.put[":"],function(I,L){return I?y(I||"Stringify error."):(w.put[":"]=L,m.to.next(w))})})}},{raw:1})});return}s.opt.pack(w.put,T=>{s.verify(T,A["*"]||N,function(B){var C;if(B=s.opt.unpack(B),l===B)return y("Unverified data.");if((C=u(B))&&N===s.opt.pub(C)&&((k.sea.own[C]=k.sea.own[C]||{})[N]=1),A["+"]&&A["+"].m&&A["+"].s&&A["*"])S(A["+"],A["*"],_=>(w.put["="]=B,m.to.next(w)));else return w.put["="]=B,m.to.next(w)})})},a.any=function(m,w,g,j,x,k,y,b){if(k.opt.secure)return y("Soul missing public key at '"+j+"'.");k.on("secure",function(N){if(this.off(),!k.opt.secure)return m.to.next(N);y("Data cannot be changed.")}).on.on("secure",w)};var d=h.valid,u=function(m,w){return typeof(w=d(m))=="string"&&w};(h.state||"").ify;var n=/[^\w_-]/;s.opt.pub=function(m){if(m&&(m=m.split("~"),!(!m||!(m=m[1]))&&(m=m.split(n).slice(0,2),!(!m||m.length!=2)&&(m[0]||"")[0]!=="@")))return m=m.slice(0,2).join("."),m},s.opt.stringy=function(m){},s.opt.pack=function(m,w,g,j,x){var k,y;if(s.opt.check(m))return w(m);m&&m["#"]&&m["."]&&m[">"]&&(k=m[":"],y=1),JSON.parseAsync(y?k:m,function(b,N){var p=l!==(N||"")[":"]&&(N||"")["~"];if(!p){w(m);return}w({m:{"#":x||m["#"],".":g||m["."],":":(N||"")[":"],">":m[">"]||h.state.is(j,g)},s:p})})};var f=s.opt;s.opt.unpack=function(m,w,g){var j;if(l!==m){if(m&&l!==(j=m[":"]))return j;if(w=w||f.fall_key,!g&&f.fall_val&&(g={},g[w]=f.fall_val),!(!w||!g)){if(m===g[w]||!s.opt.check(g[w]))return m;var x=g&&g._&&g._["#"]||f.fall_soul,k=h.state.is(g,w)||f.fall_state;if(m&&m.length===4&&x===m[0]&&w===m[1]&&v(k)===v(m[3]))return m[2];if(k<s.opt.shuffle_attack)return m}}},s.opt.shuffle_attack=15463296e5;var v=Math.floor})(t,"./index")})()}(je)),je.exports}ss();var qe={},ze;function rs(){if(ze)return qe;ze=1;var i=typeof window<"u"?window.Gun:Et();return i.chain.promise=function(o){var c=this,o=o||function(s){return s};return new Promise(function(s,r){c.once(function(l,h){s({put:l,get:h,gun:this})})}).then(o)},i.chain.then=function(t){var c=this,o=new Promise((s,r)=>{c.once(function(l,h){s(l,h)})});return t?o.then(t):o},qe}rs();console.log("🔫 GunJS service file loading...");console.log("🔫 Imported Gun:",typeof V);console.log("🔫 After importing gun/sea and gun/lib/then");console.log("🔫 Gun.SEA is available:",!!V.SEA);V.SEA?(console.log("🔫 ✅ Gun.SEA is properly initialized"),console.log("🔫 Gun.SEA methods:",V.SEA?Object.keys(V.SEA):"undefined")):(console.error("🔫 CRITICAL ERROR: Gun.SEA is NOT DEFINED after import. Trying alternative method..."),console.log("🔫 Will check SEA availability after Gun instance creation..."));console.log("🔫 About to initialize Gun instance...");const K=V({peers:["https://gun-ad4i.onrender.com/gun"]});console.log("🔫 GunJS initialized with Manhattan peer");console.log("🔫 Gun instance created:",typeof K);console.log("🔫 Gun instance properties:",Object.keys(K));console.log("🔫 Checking Gun.SEA after instance creation:",!!V.SEA);K.SEA&&(console.log("🔫 Found SEA on gun instance:",!!K.SEA),V.SEA=K.SEA);console.log("🔫 Testing gun.user() method availability...");typeof K.user=="function"?console.log("🔫 ✅ gun.user() method is available"):(console.error("🔫 ❌ gun.user() method is NOT available"),console.error("🔫 Available gun methods:",Object.getOwnPropertyNames(Object.getPrototypeOf(K))));K.on("hi",i=>{console.log("🔫 GunJS: Connected to peer",i)});K.on("bye",i=>{console.log("🔫 GunJS: Disconnected from peer",i)});K.on("out",i=>{i&&i.err&&console.warn("🔫 GunJS: Connection error:",i.err)});setTimeout(()=>{console.log("🔫 GunJS connection test - gun object:",K),console.log("🔫 GunJS internal state:",K._),K.get("test").put({hello:"world",timestamp:Date.now()}),console.log("🔫 GunJS: Test data written")},2e3);console.log("🔫 Creating user instance...");let te;try{te=K.user(),console.log("🔫 ✅ User instance created successfully:",typeof te),console.log("🔫 User instance properties:",Object.keys(te)),typeof te.create=="function"?console.log("🔫 ✅ user.create() method is available"):console.error("🔫 ❌ user.create() method is NOT available"),typeof te.auth=="function"?console.log("🔫 ✅ user.auth() method is available"):console.error("🔫 ❌ user.auth() method is NOT available")}catch(i){console.error("🔫 ❌ FAILED to create user instance:",i),console.error("🔫 This confirms that SEA is not properly loaded"),te={create:()=>console.error("SEA not loaded - user.create() unavailable"),auth:()=>console.error("SEA not loaded - user.auth() unavailable"),is:null}}const Ne=V.SEA;console.log("🔫 SEA reference:",typeof Ne);Ne&&typeof Ne.encrypt=="function"?console.log("🔫 ✅ SEA.encrypt() method is available"):(console.error("🔫 ❌ SEA.encrypt() method is NOT available"),console.error("🔫 Final Gun.SEA status:",V.SEA));class os{constructor(){ce(this,"gun");ce(this,"user");ce(this,"SEA");console.log("GunJS: GunService constructor called"),this.gun=K,this.user=te,this.SEA=Ne,console.log("GunJS: GunService initialized")}async signUp(t,c){return console.log("🔫 GunJS: Attempting to sign up user:",t),new Promise(o=>{if(c.length<8){console.log("🔫 GunJS: Password too short"),o({success:!1,error:"Password must be at least 8 characters"});return}const s=setTimeout(()=>{console.log("🔫 GunJS: Sign up timed out"),o({success:!1,error:"Sign up request timed out. Please check your connection."})},1e4);this.user.create(t,c,r=>{if(clearTimeout(s),console.log("🔫 GunJS: Sign up response:",r),r.err){console.log("🔫 GunJS: Sign up error:",r.err),o({success:!1,error:r.err});return}this.user.auth(t,c,l=>{if(!l.err){const h={originalUsername:t,displayName:t,bio:"",favoriteGenres:JSON.stringify([]),readingGoal:12,joinedDate:new Date().toISOString(),lastUpdated:new Date().toISOString()};this.user.get("profile").put(h,()=>{console.log("🔫 GunJS: Initial profile created with original username"),this.user.leave()})}}),console.log("🔫 GunJS: Sign up successful"),o({success:!0})})})}async signIn(t,c){return console.log("🔫 GunJS: Attempting to sign in user:",t),new Promise(o=>{const s=setTimeout(()=>{console.log("🔫 GunJS: Sign in timed out"),o({success:!1,error:"Sign in request timed out. Please check your connection."})},1e4);this.user.auth(t,c,r=>{if(clearTimeout(s),console.log("🔫 GunJS: Sign in response:",r),r.err){console.log("🔫 GunJS: Sign in error:",r.err),o({success:!1,error:r.err});return}console.log("🔫 GunJS: Sign in successful, user:",this.user.is),this.user.get("profile").once(l=>{if(!(l!=null&&l.originalUsername)){console.log("🔫 GunJS: Storing original username in profile");const h={...l,originalUsername:t,favoriteGenres:(l==null?void 0:l.favoriteGenres)||JSON.stringify([]),lastUpdated:new Date().toISOString()};this.user.get("profile").put(h)}}),o({success:!0,user:{id:this.user.is.pub,username:t,email:"",createdAt:new Date().toISOString()}})})})}signOut(){this.user.leave()}isAuthenticated(){return!!this.user.is}getCurrentUser(){return this.user.is?{id:this.user.is.pub,username:this.user.is.alias||"Unknown User"}:null}async recallUser(){return new Promise(t=>{const c=setTimeout(()=>{console.log("🔫 GunJS: recallUser timed out"),t({success:!1})},3e3);this.user.recall({sessionStorage:!0},()=>{clearTimeout(c),this.user.is?(console.log("🔫 GunJS: User recalled successfully:",this.user.is.alias),this.user.get("profile").once(o=>{const s=(o==null?void 0:o.originalUsername)||this.user.is.alias||"Unknown User";t({success:!0,user:{id:this.user.is.pub,username:s,email:"",createdAt:new Date().toISOString()}})})):(console.log("🔫 GunJS: No user to recall"),t({success:!1}))})})}async updateProfile(t){return new Promise(c=>{if(!this.user.is){c({success:!1,error:"User not authenticated"});return}const o=setTimeout(()=>{console.log("🔫 GunJS: updateProfile timed out"),c({success:!1,error:"Profile update request timed out"})},5e3);this.user.get("profile").once(s=>{console.log("🔫 GunJS: Existing profile:",s);const r=(s==null?void 0:s.originalUsername)||this.user.is.alias,l={displayName:t.displayName||"",bio:t.bio||"",favoriteGenres:JSON.stringify(t.favoriteGenres||[]),readingGoal:t.readingGoal||12,joinedDate:t.joinedDate||new Date().toISOString(),lastUpdated:new Date().toISOString(),originalUsername:r};console.log("🔫 GunJS: Updating profile with Gun-compatible data:",l),this.user.get("profile").put(l,h=>{if(clearTimeout(o),console.log("🔫 GunJS: Profile update response:",h),h.err){console.log("🔫 GunJS: Profile update error:",h.err),c({success:!1,error:h.err});return}console.log("🔫 GunJS: Profile updated successfully"),this.user.get("profile").once(a=>{console.log("🔫 GunJS: Profile after update:",a),c({success:!0})})})})})}async getProfile(){return new Promise(t=>{if(!this.user.is){t({success:!1,error:"User not authenticated"});return}const c=setTimeout(()=>{console.log("🔫 GunJS: getProfile timed out"),t({success:!1,error:"Profile request timed out"})},3e3);this.user.get("profile").once(o=>{if(clearTimeout(c),console.log("🔫 GunJS: Raw profile loaded:",o),o){const s={displayName:o.displayName||"",bio:o.bio||"",favoriteGenres:o.favoriteGenres?JSON.parse(o.favoriteGenres):[],readingGoal:o.readingGoal||12,joinedDate:o.joinedDate,lastUpdated:o.lastUpdated,originalUsername:o.originalUsername};console.log("🔫 GunJS: Cleaned profile:",s),t({success:!0,profile:s})}else t({success:!0,profile:{}})})})}async syncUserBooks(t){return new Promise(c=>{if(!this.user.is){c({success:!1,error:"User not authenticated"});return}this.user.get("books").put(t,o=>{if(o.err){c({success:!1,error:o.err});return}c({success:!0})})})}async getUserBooks(){return new Promise(t=>{if(!this.user.is){t({success:!1,error:"User not authenticated"});return}this.user.get("books").once(c=>{t({success:!0,books:c||[]})})})}async syncUserNotes(t){return new Promise(c=>{if(!this.user.is){c({success:!1,error:"User not authenticated"});return}this.user.get("notes").put(t,o=>{if(o.err){c({success:!1,error:o.err});return}c({success:!0})})})}async getUserNotes(){return new Promise(t=>{if(!this.user.is){t({success:!1,error:"User not authenticated"});return}this.user.get("notes").once(c=>{t({success:!0,notes:c||[]})})})}async syncUserSessions(t){return new Promise(c=>{if(!this.user.is){c({success:!1,error:"User not authenticated"});return}this.user.get("sessions").put(t,o=>{if(o.err){c({success:!1,error:o.err});return}c({success:!0})})})}async getUserSessions(){return new Promise(t=>{if(!this.user.is){t({success:!1,error:"User not authenticated"});return}this.user.get("sessions").once(c=>{t({success:!0,sessions:c||[]})})})}async syncPetData(t){return new Promise(c=>{if(!this.user.is){c({success:!1,error:"User not authenticated"});return}this.user.get("pet").put(t,o=>{if(o.err){c({success:!1,error:o.err});return}c({success:!0})})})}async getUserPetData(){return new Promise(t=>{if(!this.user.is){t({success:!1,error:"User not authenticated"});return}this.user.get("pet").once(c=>{t({success:!0,petData:c||null})})})}async syncUserData(t,c){return new Promise(o=>{if(!this.user.is){o({success:!1,error:"User not authenticated"});return}this.user.get(t).put(c,s=>{if(s.err){o({success:!1,error:s.err});return}o({success:!0})})})}async getUserData(t){return new Promise(c=>{if(!this.user.is){c({success:!1,error:"User not authenticated"});return}this.user.get(t).once(o=>{c({success:!0,data:o||{}})})})}subscribeToUserData(t,c){this.user.is&&this.user.get(t).on(c)}unsubscribeFromUserData(t){this.user.is&&this.user.get(t).off()}}const Y=new os;class ns{constructor(){ce(this,"isOnline",!0);window.addEventListener("online",()=>{this.isOnline=!0,this.syncPendingChanges()}),window.addEventListener("offline",()=>{this.isOnline=!1})}async syncData(t,c){if(Y.isAuthenticated()&&this.isOnline)try{await Y.syncUserData(t,c)}catch(o){console.warn("Failed to sync data to server:",o)}}async getData(t,c){if(Y.isAuthenticated()&&this.isOnline)try{const s=await Y.getUserData(t);if(s.success&&s.data&&Object.keys(s.data).length>0)return s.data}catch(s){console.warn("Failed to get data from server:",s)}const o=localStorage.getItem(`bookish_${t}`);return o?JSON.parse(o):c}setLocalStorage(t,c){localStorage.setItem(`bookish_${t}`,JSON.stringify(c))}async syncPendingChanges(){if(!Y.isAuthenticated())return;const t=["books","current_book","reading_sessions","notes","pet","stats","settings","streak"];for(const c of t)try{const o=localStorage.getItem(`bookish_${c}`);o&&await Y.syncUserData(c,JSON.parse(o))}catch(o){console.warn(`Failed to sync ${c}:`,o)}}async getBooks(){return this.getData("books",[])}async saveBooks(t){this.setLocalStorage("books",t),await this.syncData("books",t)}async getCurrentBook(){return this.getData("current_book",null)}async setCurrentBook(t){this.setLocalStorage("current_book",t),await this.syncData("current_book",t)}async getReadingSessions(){return this.getData("reading_sessions",[])}async saveReadingSessions(t){this.setLocalStorage("reading_sessions",t),await this.syncData("reading_sessions",t)}async getNotes(){return this.getData("notes",[])}async saveNotes(t){this.setLocalStorage("notes",t),await this.syncData("notes",t)}async getPet(){const t={name:"Bookworm",level:1,experience:0,experienceToNextLevel:100,happiness:80,lastFed:new Date().toISOString()};return this.getData("pet",t)}async savePet(t){this.setLocalStorage("pet",t),await this.syncData("pet",t)}async getStats(){const t={totalBooksRead:0,totalPagesRead:0,totalReadingTime:0,readingTimeToday:0,readingTimeThisWeek:0,booksFinishedThisYear:0};return this.getData("stats",t)}async saveStats(t){this.setLocalStorage("stats",t),await this.syncData("stats",t)}async getSettings(){const t={reminders:[],theme:"light",petName:"Bookworm"};return this.getData("settings",t)}async saveSettings(t){this.setLocalStorage("settings",t),await this.syncData("settings",t)}async getStreak(){const t={currentStreak:0,longestStreak:0,lastReadDate:null};return this.getData("streak",t)}async saveStreak(t){this.setLocalStorage("streak",t),await this.syncData("streak",t)}async migrateLocalDataToServer(){if(!Y.isAuthenticated())return;const t=[{key:"books",getter:()=>JSON.parse(localStorage.getItem("bookish_books")||"[]")},{key:"current_book",getter:()=>JSON.parse(localStorage.getItem("bookish_current_book")||"null")},{key:"reading_sessions",getter:()=>JSON.parse(localStorage.getItem("bookish_reading_sessions")||"[]")},{key:"notes",getter:()=>JSON.parse(localStorage.getItem("bookish_notes")||"[]")},{key:"pet",getter:()=>JSON.parse(localStorage.getItem("bookish_pet")||"null")},{key:"stats",getter:()=>JSON.parse(localStorage.getItem("bookish_stats")||"null")},{key:"settings",getter:()=>JSON.parse(localStorage.getItem("bookish_settings")||"null")},{key:"streak",getter:()=>JSON.parse(localStorage.getItem("bookish_streak")||"null")}];for(const c of t)try{const o=c.getter();o!==null&&(Array.isArray(o)?o.length>0:Object.keys(o).length>0)&&await Y.syncUserData(c.key,o)}catch(o){console.warn(`Failed to migrate ${c.key}:`,o)}}}const J=new ns,re="https://openlibrary.org",as=async i=>{try{return(await(await fetch(`${re}/search.json?q=${encodeURIComponent(i)}&limit=10`)).json()).docs.map(o=>({key:o.key,title:o.title,author_name:o.author_name,cover_i:o.cover_i,first_publish_year:o.first_publish_year,number_of_pages_median:o.number_of_pages_median}))}catch(t){return console.error("Error searching books:",t),[]}},ls=async i=>{var t,c;try{const o=i.replace("/works/",""),r=await(await fetch(`${re}/works/${o}.json`)).json();let l=r.number_of_pages_median;!l&&r.editions&&(l=await is(r.editions)),l||(l=await cs(o));let h=[];if(r.authors&&r.authors.length>0){const a=r.authors.slice(0,3).map(async u=>{try{return(await(await fetch(`${re}${u.author.key}.json`)).json()).name}catch{return null}});h=(await Promise.all(a)).filter(u=>u!==null)}return{key:r.key,title:r.title,author_name:h,cover_i:(t=r.covers)==null?void 0:t[0],first_publish_year:r.first_publish_year,description:((c=r.description)==null?void 0:c.value)||r.description||"",number_of_pages_median:l}}catch(o){return console.error("Error fetching book details:",o),null}},is=async i=>{try{if(!i||!i.entries||i.entries.length===0)return;for(const t of i.entries.slice(0,3))try{const o=await(await fetch(`${re}${t.key}.json`)).json();if(o.number_of_pages)return o.number_of_pages}catch(c){console.error("Error fetching edition:",c);continue}return}catch(t){console.error("Error getting page count from editions:",t);return}},cs=async i=>{try{const c=await(await fetch(`${re}/works/${i}/editions.json?limit=5`)).json();if(c.entries&&c.entries.length>0){for(const o of c.entries)if(o.number_of_pages)return o.number_of_pages}return}catch(t){console.error("Error fetching editions for page count:",t);return}},ds=(i,t="M")=>i?`https://covers.openlibrary.org/b/id/${i}-${{S:"small",M:"medium",L:"large"}[t]}.jpg`:"/placeholder-cover.jpg",us=async i=>{var t;try{return((t=(await(await fetch(`${re}/subjects/${encodeURIComponent(i.toLowerCase())}.json?limit=10`)).json()).works)==null?void 0:t.map(s=>{var r;return{key:s.key,title:s.title,author_name:((r=s.authors)==null?void 0:r.map(l=>l.name))||[],cover_i:s.cover_id,first_publish_year:s.first_publish_year,number_of_pages_median:s.number_of_pages_median}}))||[]}catch(c){return console.error("Error searching books by subject:",c),[]}},ms=async i=>{var t,c;try{const o=i.replace(/[-\s]/g,""),s=await fetch(`${re}/isbn/${o}.json`);if(!s.ok)return null;const r=await s.json();return{key:r.key,title:r.title,author_name:((t=r.authors)==null?void 0:t.map(l=>l.name))||[],cover_i:(c=r.covers)==null?void 0:c[0],first_publish_year:r.publish_date?new Date(r.publish_date).getFullYear():void 0,number_of_pages_median:r.number_of_pages}}catch(o){return console.error("Error searching book by ISBN:",o),null}},hs="bookish_reading_sessions",fs="bookish_stats",xs="bookish_streak",_e="bookish_cached_books",fe=(i,t)=>{const c=localStorage.getItem(i);return c?JSON.parse(c):t},gs=(i,t)=>{localStorage.setItem(i,JSON.stringify(t))},it=i=>fe(_e,{})[i]||null,We=i=>{const t=fe(_e,{});t[i.key]={...i,cached_at:new Date().toISOString()},gs(_e,t)},Ie=()=>fe(hs,[]),Ve=i=>Ie().filter(t=>t.bookId===i),ys=()=>({totalBooksRead:0,totalPagesRead:0,totalReadingTime:0,readingTimeToday:0,readingTimeThisWeek:0,booksFinishedThisYear:0}),ct=()=>fe(fs,ys()),ps=()=>({currentStreak:0,longestStreak:0,lastReadDate:null}),dt=()=>fe(xs,ps()),ut=E.createContext(void 0),oe=()=>{const i=E.useContext(ut);if(!i)throw new Error("useBooks must be used within a BookProvider");return i},bs=({children:i})=>{const[t,c]=E.useState([]),[o,s]=E.useState(null),[r,l]=E.useState([]),[h,a]=E.useState([]);E.useEffect(()=>{(async()=>{const x=(await J.getBooks()).map(y=>{const b=it(y.key);return b?{...y,...b}:y});c(x);const k=await J.getCurrentBook();s(k)})()},[]),E.useEffect(()=>{(async()=>{if(o){const j=await J.getReadingSessions(),x=await J.getNotes();l(j.filter(k=>k.bookId===o.key)),a(x.filter(k=>k.bookId===o.key))}else l([]),a([])})()},[o]);const d=async g=>{const j=[...t],x=j.findIndex(k=>k.key===g.key);x>=0?j[x]=g:j.push(g),c(j),await J.saveBooks(j)},u=async g=>{const j=t.filter(N=>N.key!==g);c(j),await J.saveBooks(j);const x=await J.getReadingSessions(),k=await J.getNotes(),y=x.filter(N=>N.bookId!==g),b=k.filter(N=>N.bookId!==g);await J.saveReadingSessions(y),await J.saveNotes(b),o&&o.key===g&&(s(null),await J.setCurrentBook(null))},n=async g=>{s(g),await J.setCurrentBook(g)},f=async g=>{const j=await J.getReadingSessions(),x=j.findIndex(k=>k.id===g.id);x>=0?j[x]=g:j.push(g),await J.saveReadingSessions(j),o&&g.bookId===o.key&&l(j.filter(k=>k.bookId===o.key))},v=async g=>{const x=[...await J.getNotes(),g];await J.saveNotes(x),o&&g.bookId===o.key&&a(x.filter(k=>k.bookId===o.key))},m=async g=>{const x=(await J.getNotes()).map(k=>k.id===g.id?g:k);await J.saveNotes(x),o&&g.bookId===o.key&&a(x.filter(k=>k.bookId===o.key))},w=async g=>{const x=(await J.getNotes()).filter(k=>k.id!==g);await J.saveNotes(x),o&&a(x.filter(k=>k.bookId===o.key))};return e.jsx(ut.Provider,{value:{books:t,currentBook:o,sessions:r,notes:h,addBook:d,removeBook:u,setActiveBook:n,addSession:f,addNote:v,updateNote:m,deleteNote:w},children:i})},mt=E.createContext(void 0),ie=()=>{const i=E.useContext(mt);if(!i)throw new Error("usePet must be used within a PetProvider");return i},Be=()=>({name:"Bookworm",level:1,experience:0,experienceToNext:100,happiness:100,hunger:50,energy:100,health:100,points:10,lastFed:new Date().toISOString(),lastPlayed:new Date().toISOString(),lastSlept:new Date().toISOString(),createdAt:new Date().toISOString(),totalBooksRead:0,totalReadingTime:0,evolutionStage:"egg",badges:[],mood:"content"}),ht=()=>({booksReadToday:0,readingTimeToday:0,streakDays:0,lastActiveDate:new Date().toISOString()}),vs=()=>{try{const i=localStorage.getItem("bookish_pet");if(i){const t=JSON.parse(i);return{...Be(),...t}}}catch(i){console.error("Error loading pet from storage:",i)}return Be()},ws=()=>{try{const i=localStorage.getItem("bookish_pet_stats");if(i)return JSON.parse(i)}catch(i){console.error("Error loading pet stats from storage:",i)}return ht()},js=i=>{localStorage.setItem("bookish_pet",JSON.stringify(i))},Ns=i=>{localStorage.setItem("bookish_pet_stats",JSON.stringify(i))},Ss=({children:i})=>{const[t,c]=E.useState(vs),[o,s]=E.useState(ws);E.useEffect(()=>{js(t)},[t]),E.useEffect(()=>{Ns(o)},[o]),E.useEffect(()=>{const p=setInterval(()=>{const A=new Date,S=new Date(t.lastFed),T=(A.getTime()-S.getTime())/(1e3*60*60);T>1&&c(_=>{const I=Math.floor(T);return{..._,hunger:Math.max(0,_.hunger-I*2),energy:Math.max(0,_.energy-I),happiness:Math.max(0,_.happiness-I),mood:r(Math.max(0,_.happiness-I),Math.max(0,_.hunger-I*2),Math.max(0,_.energy-I))}});const B=A.toDateString(),C=new Date(o.lastActiveDate).toDateString();B!==C&&s(_=>({..._,booksReadToday:0,readingTimeToday:0,lastActiveDate:A.toISOString()}))},3e4);return()=>clearInterval(p)},[t.lastFed,o.lastActiveDate]);const r=(p,A,S)=>A<20?"hungry":S<20?"sleepy":p>80?"happy":p>60?"excited":p<30?"sad":"content",l=p=>100+p*50,h=(p,A)=>{let S=A,T=l(S);for(;p>=T;)S++,T=l(S);return{newLevel:S,newExpToNext:T}},a=p=>p<3?"egg":p<8?"baby":p<15?"child":p<25?"teen":p<40?"adult":"elder",d=()=>{const p=t.evolutionStage,A=t.mood,S={egg:{happy:"🥚",content:"🥚",sad:"💔",excited:"✨",sleepy:"😴",hungry:"🥚"},baby:{happy:"😊",content:"🐛",sad:"😢",excited:"🤩",sleepy:"😴",hungry:"😋"},child:{happy:"😄",content:"🐯",sad:"😭",excited:"🤗",sleepy:"💤",hungry:"🍎"},teen:{happy:"😎",content:"🦊",sad:"😔",excited:"🚀",sleepy:"😪",hungry:"🍕"},adult:{happy:"🌟",content:"🦉",sad:"😞",excited:"🎉",sleepy:"😌",hungry:"🍽️"},elder:{happy:"👑",content:"🐉",sad:"😟",excited:"🎊",sleepy:"🧘",hungry:"🍱"}};return S[p][A]||S[p].content},u=()=>{c(p=>{if(p.points<3)return p;const A=Math.min(100,p.hunger+30),S=Math.min(100,p.happiness+10),T=p.experience+5,{newLevel:B,newExpToNext:C}=h(T,p.level);return{...p,hunger:A,happiness:S,experience:T,level:B,experienceToNext:C,points:p.points-3,lastFed:new Date().toISOString(),evolutionStage:a(B),mood:r(S,A,p.energy)}})},n=()=>{c(p=>{if(p.points<5)return p;const A=Math.min(100,p.happiness+20),S=Math.max(0,p.energy-15),T=p.experience+10,{newLevel:B,newExpToNext:C}=h(T,p.level);return{...p,happiness:A,energy:S,experience:T,level:B,experienceToNext:C,points:p.points-5,lastPlayed:new Date().toISOString(),evolutionStage:a(B),mood:r(A,p.hunger,S)}})},f=()=>{c(p=>{const A=Math.min(100,p.energy+40),S=Math.min(100,p.health+10);return{...p,energy:A,health:S,lastSlept:new Date().toISOString(),mood:r(p.happiness,p.hunger,A)}})},v=(p,A=!1)=>{const B=Math.floor(p/5)+(A?50:0);B>0&&(c(C=>{const _=C.experience+B,I=Math.min(100,C.happiness+Math.floor(p/10)),L=C.totalReadingTime+p,{newLevel:M,newExpToNext:G}=h(_,C.level);return{...C,experience:_,level:M,experienceToNext:G,happiness:I,totalReadingTime:L,evolutionStage:a(M),mood:r(I,C.hunger,C.energy)}}),s(C=>({...C,readingTimeToday:C.readingTimeToday+p,lastActiveDate:new Date().toISOString()})))},m=()=>{c(p=>{const A=p.experience+50,S=Math.min(100,p.happiness+25),T=p.totalBooksRead+1,B=20,{newLevel:C,newExpToNext:_}=h(A,p.level),I=[...p.badges];return T===1&&!I.includes("first-book")&&I.push("first-book"),T===10&&!I.includes("book-lover")&&I.push("book-lover"),T===50&&!I.includes("bookworm")&&I.push("bookworm"),{...p,experience:A,level:C,experienceToNext:_,happiness:S,points:p.points+B,totalBooksRead:T,badges:I,evolutionStage:a(C),mood:r(S,p.hunger,p.energy)}}),s(p=>({...p,booksReadToday:p.booksReadToday+1,lastActiveDate:new Date().toISOString()}))},w=()=>({happy:"Your pet is very happy! Keep up the great reading!",excited:"Your pet is excited about your reading progress!",content:"Your pet is content and enjoying your company.",sad:"Your pet seems sad. Try feeding or playing with them!",sleepy:"Your pet is tired. Maybe they need some rest?",hungry:"Your pet is hungry! Don't forget to feed them."})[t.mood],g=()=>{const p=a(t.level+1),A=t.level<3?3:t.level<8?8:t.level<15?15:t.level<25?25:40;return{current:t.level,required:A,stage:p}},j=()=>{const p=t.level<3?3:t.level<8?8:t.level<15?15:t.level<25?25:40;return t.level>=p&&t.evolutionStage!==a(t.level)},x=()=>{c(p=>({...p,evolutionStage:a(p.level),happiness:100,health:100}))},k=()=>{const p=Be();c(p),s(ht())},y=p=>{c(A=>({...A,name:p}))},b=()=>t.happiness<30?"sad":t.happiness<70?"neutral":"happy",N=()=>t.experience/t.experienceToNext*100;return e.jsx(mt.Provider,{value:{pet:t,petStats:o,feedPet:u,playWithPet:n,petSleep:f,updatePetFromReading:v,updatePetFromBookCompletion:m,getPetMood:w,getPetEvolutionRequirement:g,resetPet:k,updatePetName:y,getPetEmoji:d,canEvolve:j,evolvePet:x,getPetHappinessLevel:b,getLevelProgress:N},children:i})},X={GUEST_PROFILE:"bookish-guest-profile",GUEST_BOOKS:"bookish-guest-books",GUEST_READING_SESSIONS:"bookish-guest-reading-sessions",GUEST_NOTES:"bookish-guest-notes",GUEST_PET:"bookish-guest-pet",USER_SETTINGS:"bookish-user-settings"};class se{static get(t){try{const c=localStorage.getItem(t);return c?JSON.parse(c):null}catch(c){return console.error("Error reading from localStorage:",c),null}}static set(t,c){try{return localStorage.setItem(t,JSON.stringify(c)),!0}catch(o){return console.error("Error writing to localStorage:",o),!1}}static remove(t){try{return localStorage.removeItem(t),!0}catch(c){return console.error("Error removing from localStorage:",c),!1}}static clear(){try{return Object.values(X).forEach(t=>{localStorage.removeItem(t)}),!0}catch(t){return console.error("Error clearing localStorage:",t),!1}}static getGuestProfile(){return this.get(X.GUEST_PROFILE)}static setGuestProfile(t){return this.set(X.GUEST_PROFILE,{...t,lastUpdated:new Date().toISOString()})}static getGuestBooks(){return this.get(X.GUEST_BOOKS)||[]}static setGuestBooks(t){return this.set(X.GUEST_BOOKS,{books:t,lastUpdated:new Date().toISOString()})}static getGuestPet(){return this.get(X.GUEST_PET)}static setGuestPet(t){return this.set(X.GUEST_PET,{...t,lastUpdated:new Date().toISOString()})}static getUserSettings(){return this.get(X.USER_SETTINGS)}static saveUserSettings(t){return this.set(X.USER_SETTINGS,{...t,lastUpdated:new Date().toISOString()})}}const ft=E.createContext(void 0),ks={isAuthenticated:!1,user:null,isLoading:!0,error:null},Cs=(i,t)=>{switch(t.type){case"AUTH_START":return{...i,isLoading:!0,error:null};case"AUTH_SUCCESS":return{...i,isAuthenticated:!0,user:t.payload,isLoading:!1,error:null};case"AUTH_FAILURE":return{...i,isAuthenticated:!1,user:null,isLoading:!1,error:t.payload};case"SIGN_OUT":return{...i,isAuthenticated:!1,user:null,isLoading:!1,error:null};case"CLEAR_ERROR":return{...i,error:null};case"UPDATE_USER":return{...i,user:i.user?{...i.user,...t.payload}:null};default:return i}},Es=({children:i})=>{const[t,c]=E.useReducer(Cs,ks);E.useEffect(()=>{(async()=>{var n;try{const f=new Promise((w,g)=>setTimeout(()=>g(new Error("Authentication check timeout")),5e3)),v=Y.recallUser(),m=await Promise.race([v,f]);if(m&&m.success&&m.user){const w=new Promise((g,j)=>setTimeout(()=>j(new Error("Profile load timeout")),3e3));try{const g=await Promise.race([Y.getProfile(),w]),j={...m.user,username:g!=null&&g.success&&((n=g==null?void 0:g.profile)!=null&&n.originalUsername)?g.profile.originalUsername:m.user.username||"Unknown User",profile:g&&g.success?g.profile:void 0};c({type:"AUTH_SUCCESS",payload:j})}catch{const j={...m.user,username:m.user.username||"Unknown User",profile:void 0};c({type:"AUTH_SUCCESS",payload:j})}}else c({type:"AUTH_FAILURE",payload:""})}catch(f){console.log("GunJS auth check failed (servers may be down):",f),c({type:"AUTH_FAILURE",payload:""})}})()},[]);const d={...t,signIn:async(u,n)=>{c({type:"AUTH_START"});try{const f=await Y.signIn(u,n);if(f.success&&f.user){const v=await Y.getProfile(),m={...f.user,username:u,profile:v.success?v.profile:void 0};return c({type:"AUTH_SUCCESS",payload:m}),{success:!0}}else return c({type:"AUTH_FAILURE",payload:f.error||"Sign in failed"}),{success:!1,error:f.error}}catch{const v="An unexpected error occurred";return c({type:"AUTH_FAILURE",payload:v}),{success:!1,error:v}}},signUp:async(u,n)=>{c({type:"AUTH_START"});try{const f=await Y.signUp(u,n);return f.success?(c({type:"AUTH_FAILURE",payload:""}),{success:!0}):(c({type:"AUTH_FAILURE",payload:f.error||"Sign up failed"}),{success:!1,error:f.error})}catch{const v="An unexpected error occurred";return c({type:"AUTH_FAILURE",payload:v}),{success:!1,error:v}}},signOut:()=>{Y.signOut(),c({type:"SIGN_OUT"})},updateProfile:async u=>{console.log("AuthContext: updateProfile called with:",u);try{const n=await Y.updateProfile(u);return console.log("AuthContext: gunService.updateProfile result:",n),n.success?(console.log("AuthContext: Updating user state with profile:",u),c({type:"UPDATE_USER",payload:{profile:u}}),{success:!0}):(console.log("AuthContext: Profile update failed:",n.error),{success:!1,error:n.error})}catch(n){return console.error("AuthContext: Profile update error:",n),{success:!1,error:"Failed to update profile"}}},clearError:()=>{c({type:"CLEAR_ERROR"})},continueAsGuest:()=>{let u={displayName:"Guest User",bio:"Browsing as a guest",favoriteGenres:[],readingGoal:0};const n=se.getGuestProfile();n&&(u={displayName:n.displayName||"Guest User",bio:n.bio||"Browsing as a guest",favoriteGenres:n.favoriteGenres||[],readingGoal:n.readingGoal||0});const f={id:"guest-"+Date.now(),username:"Guest User",email:"",createdAt:new Date().toISOString(),profile:u};c({type:"AUTH_SUCCESS",payload:f})}};return e.jsx(ft.Provider,{value:d,children:i})},xe=()=>{const i=E.useContext(ft);if(i===void 0)throw new Error("useAuth must be used within an AuthProvider");return i},Ts={colors:{primary:"#D2691E",primaryLight:"#E89556",primaryDark:"#B8571A",secondary:"#8B7355",secondaryLight:"#A68B6B",secondaryDark:"#6B5A47",background:"#F7F5F3",surface:"#FFFFFF",surfaceElevated:"#FEFEFE",surfaceSecondary:"#F5F5F5",textPrimary:"#3A3A3A",textSecondary:"#8B7355",textTertiary:"#A0A0A0",textInverse:"#FFFFFF",border:"#E8E3DD",borderLight:"#F0EDE8",borderDark:"#D4C4B0",success:"#10B981",warning:"#F59E0B",error:"#EF4444",info:"#3B82F6",wantToRead:"#FEF3C7",wantToReadText:"#D97706",currentlyReading:"#DBEAFE",currentlyReadingText:"#2563EB",completed:"#D1FAE5",completedText:"#059669",overlay:"rgba(0, 0, 0, 0.5)",overlayLight:"rgba(0, 0, 0, 0.3)"}},As={colors:{primary:"#E89556",primaryLight:"#F4A971",primaryDark:"#D2691E",secondary:"#A68B6B",secondaryLight:"#B89980",secondaryDark:"#8B7355",background:"#0F0F0F",surface:"#1A1A1A",surfaceElevated:"#252525",surfaceSecondary:"#1F1F1F",textPrimary:"#F5F5F5",textSecondary:"#C0C0C0",textTertiary:"#909090",textInverse:"#0F0F0F",border:"#333333",borderLight:"#2A2A2A",borderDark:"#444444",success:"#4ADE80",warning:"#FBBF24",error:"#FB7185",info:"#60A5FA",wantToRead:"#2D1B00",wantToReadText:"#FBBF24",currentlyReading:"#1E293B",currentlyReadingText:"#7DD3FC",completed:"#1B2E1B",completedText:"#4ADE80",overlay:"rgba(0, 0, 0, 0.8)",overlayLight:"rgba(0, 0, 0, 0.6)"}},xt=E.createContext(void 0),$=()=>{const i=E.useContext(xt);if(!i)throw new Error("useTheme must be used within a ThemeProvider");return i},Ps=({children:i})=>{const{user:t,isLoading:c}=xe(),o=()=>{try{const u=localStorage.getItem("bookish-theme");if(u)return u==="dark";if(window.matchMedia)return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(u){console.error("Error getting initial theme:",u)}return!1},[s,r]=E.useState(o);E.useEffect(()=>{if(c)return;(()=>{var n;if(t){const f=(n=se.getUserSettings())==null?void 0:n.theme;if(f){r(f==="dark");return}}r(o())})()},[t,c]),E.useEffect(()=>{if(!window.matchMedia)return;const u=window.matchMedia("(prefers-color-scheme: dark)"),n=f=>{var m;(t?!!((m=se.getUserSettings())!=null&&m.theme):!!localStorage.getItem("bookish-theme"))||r(f.matches)};return u.addEventListener("change",n),()=>u.removeEventListener("change",n)},[t]),E.useEffect(()=>{const u=document.documentElement;s?(u.classList.add("dark"),u.setAttribute("data-theme","dark")):(u.classList.remove("dark"),u.setAttribute("data-theme","light"));const n=document.querySelector('meta[name="theme-color"]');n&&n.setAttribute("content",s?"#0F0F0F":"#F7F5F3")},[s]);const l=()=>{const u=!s;r(u),a(u)},h=u=>{r(u),a(u)},a=u=>{const n=u?"dark":"light";if(t){const f=se.getUserSettings()||{reminders:[],theme:"light",petName:"Buddy"};se.saveUserSettings({...f,theme:n})}else localStorage.setItem("bookish-theme",n)},d={colors:s?As.colors:Ts.colors,isDark:s};return e.jsx(xt.Provider,{value:{theme:d,toggleTheme:l,setTheme:h},children:i})},_s=({onClose:i})=>{const[t,c]=E.useState(!1),[o,s]=E.useState(""),[r,l]=E.useState(""),[h,a]=E.useState(!1),[d,u]=E.useState(!1),{signIn:n,signUp:f,error:v,clearError:m,continueAsGuest:w}=xe(),g={colors:{background:"#F7F5F3",surface:"#FFFFFF",borderLight:"#F0EDE8",border:"#E8E3DD",primary:"#8B7355",textPrimary:"#3A3A3A",textSecondary:"#8B7355"}},j=async y=>{if(y.preventDefault(),!(!o.trim()||!r.trim())){u(!0),m();try{let b;t?(b=await f(o.trim(),r),b.success&&(c(!1),l(""),alert("Account created successfully! Please sign in."))):(b=await n(o.trim(),r),b.success&&i&&i())}finally{u(!1)}}},x=()=>{c(!t),l(""),m()},k=()=>{w(),i&&i()};return e.jsxs("div",{className:"rounded-2xl shadow-2xl p-8 w-full max-w-md mx-auto border",style:{backgroundColor:g.colors.surface,borderColor:g.colors.border},children:[e.jsxs("div",{className:"text-center mb-8",children:["        ",e.jsx("div",{className:"rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",style:{backgroundColor:g.colors.borderLight},children:e.jsx(q,{className:"w-8 h-8",style:{color:g.colors.primary}})}),e.jsx("h2",{className:"font-serif text-2xl font-medium mb-2",style:{color:g.colors.textPrimary},children:t?"Join Bookish":"Welcome Back"}),e.jsx("p",{style:{color:g.colors.textSecondary},children:t?"Start your reading journey with your virtual pet companion":"Continue your reading adventure with your book buddy"})]}),"      ",e.jsxs("form",{onSubmit:j,className:"space-y-6",children:["        ",e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium mb-2",style:{color:g.colors.textPrimary},children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx(st,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5",style:{color:g.colors.textSecondary}}),e.jsx("input",{id:"username",type:"text",value:o,onChange:y=>s(y.target.value),className:"pl-10 pr-4 py-3 w-full border-2 rounded-xl focus:ring-2 focus:ring-[#8B7355] focus:border-[#8B7355] transition-colors",style:{backgroundColor:g.colors.background,borderColor:g.colors.border,color:g.colors.textPrimary},placeholder:"Enter your username",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium mb-2",style:{color:g.colors.textPrimary},children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5",style:{color:g.colors.textSecondary}}),"            ",e.jsx("input",{id:"password",type:h?"text":"password",value:r,onChange:y=>l(y.target.value),className:"pl-10 pr-12 py-3 w-full border-2 rounded-xl focus:ring-2 focus:ring-[#8B7355] focus:border-[#8B7355] transition-colors",style:{backgroundColor:g.colors.background,borderColor:g.colors.border,color:g.colors.textPrimary},placeholder:t?"Create a strong password":"Enter your password",minLength:t?8:void 0,required:!0}),e.jsx("button",{type:"button",onClick:()=>a(!h),className:"absolute right-3 top-1/2 transform -translate-y-1/2 hover:opacity-70 transition-colors",style:{color:g.colors.textSecondary},children:h?e.jsx(At,{className:"w-5 h-5"}):e.jsx(Pt,{className:"w-5 h-5"})})]}),t&&e.jsx("p",{className:"text-sm mt-1",style:{color:g.colors.textSecondary},children:"Password must be at least 8 characters long"})]}),"        ",v&&e.jsx("div",{className:"border px-4 py-3 rounded-xl text-sm",style:{backgroundColor:"#FEF2F2",borderColor:"#FCA5A5",color:"#DC2626"},children:v}),e.jsx("button",{type:"submit",disabled:d,className:"w-full text-white py-3 px-4 rounded-xl font-medium hover:opacity-90 focus:ring-2 focus:ring-offset-2 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:g.colors.primary},children:d?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),t?"Creating Account...":"Signing In..."]}):t?"Create Account":"Sign In"}),"        ",e.jsx("button",{type:"button",onClick:k,className:"w-full py-3 px-4 rounded-xl font-medium focus:ring-2 focus:ring-offset-2 transition-all duration-200 border",style:{backgroundColor:g.colors.surface,color:g.colors.primary,borderColor:g.colors.border},children:"Continue as Guest"}),e.jsx("p",{className:"text-sm text-center mt-2",style:{color:g.colors.textSecondary},children:"Guest mode: Explore the app with local storage (data saved on this device only)"})]}),"      ",e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{style:{color:g.colors.textSecondary},children:[t?"Already have an account?":"Don't have an account?"," ",e.jsx("button",{type:"button",onClick:x,className:"font-medium transition-colors underline hover:opacity-70",style:{color:g.colors.textPrimary},children:t?"Sign In":"Sign Up"})]})}),i&&e.jsx("button",{onClick:i,className:"absolute top-4 right-4 text-[#8B7355] hover:text-[#3A3A3A] transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},Bs=({children:i,fallback:t})=>{const{isAuthenticated:c,isLoading:o}=xe(),s={colors:{background:"#F7F5F3",surface:"#FFFFFF",border:"#E8E3DD",primary:"#8B7355",textSecondary:"#8B7355"}};return o?e.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:s.colors.background},children:e.jsxs("div",{className:"rounded-2xl shadow-xl p-8 text-center border",style:{backgroundColor:s.colors.surface,borderColor:s.colors.border},children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 mx-auto mb-4",style:{borderColor:s.colors.primary}}),e.jsx("p",{className:"font-medium",style:{color:s.colors.textSecondary},children:"Loading your reading world..."})]})}):c?e.jsx(e.Fragment,{children:i}):t||e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",style:{backgroundColor:s.colors.background},children:e.jsx("div",{className:"w-full max-w-md",children:e.jsx(_s,{})})})},Ds=()=>{const i=z(),t=[{icon:q,title:"Track Your Reading",description:"Organize your books into 'Want to Read', 'Currently Reading', and 'Completed' categories with beautiful progress tracking."},{icon:rt,title:"Reading Sessions",description:"Time your reading sessions and watch your progress grow. See exactly how much time you've invested in each book."},{icon:ae,title:"Take Notes",description:"Capture your thoughts, favorite quotes, and insights as you read. Never lose track of those brilliant moments."},{icon:Te,title:"Virtual Pet Companion",description:"Care for your adorable reading companion that grows and evolves as you complete books and reading sessions."},{icon:we,title:"Achievement System",description:"Unlock achievements and watch your reading streaks grow. Gamify your reading journey and stay motivated."},{icon:_t,title:"Beautiful Interface",description:"Enjoy a warm, book-inspired design that makes reading tracking a delightful experience every day."}],c=[{icon:Ae,title:"Build Better Habits",description:"Turn reading into a consistent, rewarding habit with gentle gamification and progress tracking."},{icon:Bt,title:"Stay Motivated",description:"Your virtual pet and achievement system keep you engaged and excited about your reading journey."},{icon:Dt,title:"Mindful Reading",description:"Take notes and track your thoughts to engage more deeply with every book you read."}];return e.jsxs("div",{className:"min-h-screen style={{backgroundColor: lightTheme.colors.background}} max-w-full overflow-x-hidden",children:[e.jsx("div",{className:"relative overflow-hidden",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-12 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-[#8B7355] rounded-2xl flex items-center justify-center",children:e.jsx(q,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"font-serif text-4xl lg:text-6xl font-bold text-[#3A3A3A] mb-2",children:"Bookish"}),e.jsx("p",{className:"text-lg lg:text-xl text-[#8B7355] font-medium",children:"Your Reading Companion"})]}),e.jsxs("div",{className:"text-center mb-8 max-w-2xl mx-auto",children:[e.jsx("h2",{className:"font-serif text-2xl lg:text-3xl font-medium text-[#3A3A3A] mb-4 leading-tight",children:"Transform Your Reading Journey with a Delightful Digital Companion"}),e.jsx("p",{className:"text-[#8B7355] leading-relaxed mb-6 text-base lg:text-lg",children:"Track your books, time your sessions, take meaningful notes, and care for your virtual pet as you build the reading habit you've always wanted."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsxs("button",{onClick:()=>i("/"),className:"bg-[#8B7355] text-white px-8 py-4 rounded-xl font-medium text-lg flex items-center gap-2 justify-center hover:bg-[#7A6349] transition-colors shadow-lg",children:["Start Reading Today",e.jsx(Re,{className:"w-5 h-5"})]}),e.jsx("button",{onClick:()=>i("/search"),className:"bg-transparent border-2 border-[#8B7355] text-[#8B7355] px-8 py-4 rounded-xl font-medium text-lg hover:bg-[#8B7355] hover:text-white transition-colors",children:"Browse Books"})]})]}),e.jsx("div",{className:"relative mb-12 max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 border-4 border-[#F0EDE8]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-3 h-3 bg-red-400 rounded-full"}),e.jsx("div",{className:"w-3 h-3 bg-yellow-400 rounded-full"}),e.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-[#F0EDE8] rounded w-3/4"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-12 h-16 bg-[#8B7355] rounded"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-3 bg-[#F0EDE8] rounded w-full"}),e.jsx("div",{className:"h-2 bg-[#F0EDE8] rounded w-2/3"}),e.jsx("div",{className:"h-2 bg-[#E59554] rounded w-1/2"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-12 h-16 bg-[#D2691E] rounded"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-3 bg-[#F0EDE8] rounded w-full"}),e.jsx("div",{className:"h-2 bg-[#F0EDE8] rounded w-2/3"}),e.jsx("div",{className:"h-2 bg-[#E59554] rounded w-3/4"})]})]})]})]})})]})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-12 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h3",{className:"font-serif text-2xl lg:text-3xl font-medium text-[#3A3A3A] mb-3",children:"Everything You Need"}),e.jsx("p",{className:"text-[#8B7355] text-base lg:text-lg",children:"Powerful features designed to enhance your reading experience"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((o,s)=>e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-[#F0EDE8] rounded-xl flex items-center justify-center mb-4",children:e.jsx(o.icon,{className:"w-8 h-8 text-[#8B7355]"})}),e.jsx("h4",{className:"font-serif font-medium text-[#3A3A3A] mb-3 text-lg",children:o.title}),e.jsx("p",{className:"text-sm text-[#8B7355] leading-relaxed",children:o.description})]})},s))})]}),e.jsx("div",{className:"bg-[#F0EDE8] py-16",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h3",{className:"font-serif text-2xl lg:text-3xl font-medium text-[#3A3A3A] mb-3",children:"Why Choose Bookish?"}),e.jsx("p",{className:"text-[#8B7355] text-base lg:text-lg",children:"Join thousands of readers who've transformed their reading habits"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:c.map((o,s)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-[#8B7355] rounded-2xl flex items-center justify-center mx-auto mb-6",children:e.jsx(o.icon,{className:"w-10 h-10 text-white"})}),e.jsx("h4",{className:"font-serif font-medium text-[#3A3A3A] mb-3 text-lg",children:o.title}),e.jsx("p",{className:"text-sm text-[#8B7355] leading-relaxed",children:o.description})]},s))})]})}),e.jsx("div",{className:"max-w-4xl mx-auto px-6 py-16 lg:px-8",children:e.jsxs("div",{className:"bg-gradient-to-r from-[#8B7355] to-[#D2691E] rounded-2xl p-8 lg:p-12 text-white text-center",children:[e.jsx("h3",{className:"font-serif text-xl lg:text-2xl font-medium mb-8",children:"Join the Reading Revolution"}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl lg:text-4xl font-bold mb-1",children:"10K+"}),e.jsx("div",{className:"text-sm opacity-90",children:"Books Tracked"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl lg:text-4xl font-bold mb-1",children:"5K+"}),e.jsx("div",{className:"text-sm opacity-90",children:"Happy Readers"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl lg:text-4xl font-bold mb-1",children:"50K+"}),e.jsx("div",{className:"text-sm opacity-90",children:"Reading Hours"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl lg:text-4xl font-bold mb-1",children:"25K+"}),e.jsx("div",{className:"text-sm opacity-90",children:"Notes Written"})]})]}),e.jsxs("button",{onClick:()=>i("/"),className:"bg-white text-[#8B7355] px-8 py-4 rounded-xl font-medium flex items-center gap-2 mx-auto hover:bg-gray-50 transition-colors text-lg",children:["Get Started Free",e.jsx(Re,{className:"w-5 h-5"})]})]})}),e.jsx("div",{className:"bg-[#3A3A3A] py-16",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-6 text-center lg:px-8",children:[e.jsx("h3",{className:"font-serif text-2xl lg:text-3xl font-medium text-white mb-4",children:"Ready to Begin?"}),e.jsx("p",{className:"text-gray-300 mb-8 leading-relaxed text-base lg:text-lg max-w-2xl mx-auto",children:"Start your reading journey today. Search for your first book, meet your virtual companion, and begin building the reading habit that will last a lifetime."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center max-w-md mx-auto",children:[e.jsx("button",{onClick:()=>i("/"),className:"flex-1 bg-[#D2691E] text-white px-6 py-4 rounded-xl font-medium hover:bg-[#B8541A] transition-colors",children:"Start Your Journey"}),e.jsx("button",{onClick:()=>i("/library"),className:"flex-1 bg-transparent border-2 border-gray-500 text-gray-300 px-6 py-4 rounded-xl font-medium hover:border-gray-400 hover:text-gray-200 transition-colors",children:"View Library"})]})]})})]})},Is=({className:i=""})=>{const{theme:t,toggleTheme:c}=$();return e.jsx("button",{onClick:c,className:`w-8 h-8 rounded-full flex items-center justify-center transition-all duration-200 hover:scale-110 ${i}`,style:{backgroundColor:t.colors.surfaceSecondary},onMouseEnter:o=>{o.currentTarget.style.backgroundColor=t.colors.border},onMouseLeave:o=>{o.currentTarget.style.backgroundColor=t.colors.surfaceSecondary},title:`Switch to ${t.isDark?"light":"dark"} mode`,"aria-label":`Switch to ${t.isDark?"light":"dark"} mode`,children:t.isDark?e.jsx(ot,{size:16,style:{color:t.colors.warning}}):e.jsx(nt,{size:16,style:{color:t.colors.textSecondary}})})},Rs=({greeting:i})=>{var h;const t=z(),{pet:c}=ie(),{user:o}=xe(),{theme:s}=$(),r=(h=o==null?void 0:o.id)==null?void 0:h.startsWith("guest-"),l=()=>{const a=c.mood;return{happy:"😊",excited:"🤩",content:"😌",sad:"😢",sleepy:"😴",hungry:"🍎"}[a]||"😌"};return e.jsx("header",{className:"p-4 transition-colors duration-200",style:{backgroundColor:s.colors.background},children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"font-serif text-xl font-medium",style:{color:s.colors.textPrimary},children:i}),e.jsx("p",{className:"text-sm",style:{color:s.colors.textSecondary},children:"Ready to dive into a story?"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Is,{}),e.jsxs("div",{className:"flex items-center gap-2 rounded-lg px-3 py-2 cursor-pointer transition-colors duration-200",style:{backgroundColor:s.colors.surfaceSecondary},onMouseEnter:a=>{a.currentTarget.style.backgroundColor=s.colors.border},onMouseLeave:a=>{a.currentTarget.style.backgroundColor=s.colors.surfaceSecondary},onClick:()=>t("/pet"),children:[e.jsx("span",{className:"text-lg",children:l()}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs font-medium",style:{color:s.colors.textPrimary},children:c.name}),e.jsxs("p",{className:"text-xs",style:{color:s.colors.textSecondary},children:["Lv.",c.level]})]})]}),e.jsx("button",{className:"w-8 h-8 rounded-full flex items-center justify-center transition-colors duration-200",style:{backgroundColor:r?s.colors.wantToRead:s.colors.surfaceSecondary},onMouseEnter:a=>{a.currentTarget.style.backgroundColor=s.colors.border},onMouseLeave:a=>{a.currentTarget.style.backgroundColor=r?s.colors.wantToRead:s.colors.surfaceSecondary},onClick:()=>t("/profile"),title:r?"Guest User":"Profile",children:e.jsx(st,{className:"w-5 h-5",style:{color:r?s.colors.wantToReadText:s.colors.textSecondary}})})]})]})})},Os=({onContinueReading:i})=>{const{currentBook:t,sessions:c,setActiveBook:o}=oe(),{theme:s}=$(),[r,l]=E.useState(!0);if(E.useEffect(()=>{if(t){const m=JSON.parse(localStorage.getItem("bookish_books")||"[]").some(w=>w.key===t.key);l(m),m||o(null)}},[t,o]),!t||!r)return e.jsx("div",{className:"p-4 rounded-xl shadow-sm",style:{backgroundColor:s.colors.surfaceSecondary},children:e.jsx("div",{className:"flex items-center justify-center p-6 border-2 border-dashed rounded-lg",style:{borderColor:s.colors.textSecondary},children:e.jsxs("div",{className:"text-center",children:[e.jsx(q,{className:"w-8 h-8 mx-auto mb-2",style:{color:s.colors.textSecondary}}),e.jsx("h3",{className:"font-serif text-lg font-medium mb-1",style:{color:s.colors.textPrimary},children:"No book selected"}),e.jsx("p",{className:"text-sm",style:{color:s.colors.textSecondary},children:"Search for a book to start reading"})]})})});const h=[...c].sort((v,m)=>new Date(m.startTime).getTime()-new Date(v.startTime).getTime())[0],a=(h==null?void 0:h.endPage)||(h==null?void 0:h.startPage)||1,d=t.number_of_pages_median||0,u=d>0?Math.min(Math.round(a/d*100),100):0,n=d>0,f=n&&u>0;return e.jsxs("div",{className:"p-4 rounded-xl shadow-sm",style:{backgroundColor:s.colors.surfaceSecondary},children:[e.jsx("h2",{className:"font-serif text-lg font-medium mb-3",style:{color:s.colors.textPrimary},children:"Currently Reading"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-24 h-36 rounded-md overflow-hidden shadow-md flex-shrink-0",children:t.cover_i?e.jsx("img",{src:`https://covers.openlibrary.org/b/id/${t.cover_i}-M.jpg`,alt:t.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-white p-2",style:{backgroundColor:s.colors.secondary},children:e.jsx("span",{className:"text-xs text-center font-serif",children:t.title})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-serif text-base font-medium line-clamp-2 mb-1",style:{color:s.colors.textPrimary},children:t.title}),t.author_name&&t.author_name.length>0&&e.jsxs("p",{className:"text-sm mb-2",style:{color:s.colors.textSecondary},children:["by ",t.author_name[0]]}),f?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs mb-2",style:{color:s.colors.textSecondary},children:[e.jsxs("span",{children:[u,"%"]}),e.jsx("div",{className:"flex-1 h-1.5 rounded-full overflow-hidden",style:{backgroundColor:s.colors.border},children:e.jsx("div",{className:"h-full rounded-full transition-all duration-300 ease-out",style:{width:`${u}%`,backgroundColor:s.colors.primary}})})]}),e.jsxs("div",{className:"text-xs mb-4",style:{color:s.colors.textSecondary},children:["Page ",a," of ",d]})]}):n?e.jsxs("div",{className:"text-xs mb-4",style:{color:s.colors.textSecondary},children:["Page ",a," of ",d]}):e.jsxs("div",{className:"text-xs mb-4",style:{color:s.colors.textSecondary},children:["Currently on page ",a,e.jsx("div",{className:"text-xs opacity-75 mt-1",children:"Page count unavailable"})]}),e.jsxs("button",{onClick:i,className:"w-full py-2 px-4 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",style:{backgroundColor:s.colors.primary,color:s.colors.textInverse},onMouseEnter:v=>{v.currentTarget.style.backgroundColor=s.colors.primaryLight},onMouseLeave:v=>{v.currentTarget.style.backgroundColor=s.colors.primary},children:[e.jsx(q,{className:"w-4 h-4"}),"Continue Reading"]})]})]})]})},be=({icon:i,value:t,label:c,color:o})=>{const{theme:s}=$();return e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-xl shadow-sm",style:{backgroundColor:s.colors.surface},children:[e.jsx("div",{className:"w-8 h-8 flex items-center justify-center rounded-full mb-1",style:{backgroundColor:o},children:i}),e.jsx("span",{className:"font-serif text-lg font-medium",style:{color:s.colors.textPrimary},children:t}),e.jsx("span",{className:"text-xs",style:{color:s.colors.textSecondary},children:c})]})},Us=()=>{const{theme:i}=$(),t=ct(),c=dt(),o=s=>{if(s<60)return`${s} min`;const r=Math.floor(s/60),l=s%60;return l===0?`${r} hrs`:`${r}.${Math.floor(l/6)}`};return e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(be,{icon:e.jsx(le,{className:"w-5 h-5 text-white"}),value:o(t.readingTimeToday),label:"Today",color:i.colors.primary}),e.jsx(be,{icon:e.jsx(le,{className:"w-5 h-5 text-white"}),value:o(t.readingTimeThisWeek),label:"This Week",color:i.colors.primaryDark}),e.jsx(be,{icon:e.jsx(It,{className:"w-5 h-5 text-white"}),value:t.totalBooksRead,label:"Books Read",color:i.colors.secondary}),e.jsx(be,{icon:e.jsx(Rt,{className:"w-5 h-5 text-white"}),value:c.currentStreak,label:"Streak",color:i.colors.primaryLight})]})},ve=({icon:i,label:t,onClick:c})=>{const{theme:o}=$();return e.jsxs("button",{onClick:c,className:"flex flex-col items-center justify-center p-4 rounded-xl shadow-sm transition-colors duration-200",style:{backgroundColor:o.colors.surface},onMouseEnter:s=>{s.currentTarget.style.backgroundColor=o.colors.surfaceSecondary},onMouseLeave:s=>{s.currentTarget.style.backgroundColor=o.colors.surface},children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center rounded-full mb-2",style:{backgroundColor:o.colors.background},children:e.jsx(i,{className:"w-5 h-5",style:{color:o.colors.textSecondary}})}),e.jsx("span",{className:"text-sm",style:{color:o.colors.textPrimary},children:t})]})},Fs=({type:i,title:t,timestamp:c,duration:o})=>{const{theme:s}=$(),r=()=>{switch(i){case"reading":return e.jsx(le,{className:"w-4 h-4",style:{color:s.colors.primary}});case"note":return e.jsx(Oe,{className:"w-4 h-4",style:{color:s.colors.secondary}});case"completed":return e.jsx(Oe,{className:"w-4 h-4",style:{color:s.colors.success}})}},l=h=>{const a=new Date,d=new Date(h),u=Math.floor((a.getTime()-d.getTime())/(1e3*60));if(u<1)return"just now";if(u<60)return`${u} minute${u===1?"":"s"} ago`;const n=Math.floor(u/60);if(n<24)return`${n} hour${n===1?"":"s"} ago`;const f=Math.floor(n/24);return`${f} day${f===1?"":"s"} ago`};return e.jsxs("div",{className:"flex items-center gap-3 p-3 border-b",style:{borderColor:s.colors.border},children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:s.colors.surfaceSecondary},children:r()}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium",style:{color:s.colors.textPrimary},children:t}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",style:{color:s.colors.textSecondary},children:[e.jsx("span",{children:l(c)}),o&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{children:[o," min"]})]})]})]})]})},Gs=()=>{const i=z(),{theme:t}=$(),o=[...Ie()].sort((r,l)=>new Date(l.startTime).getTime()-new Date(r.startTime).getTime()).slice(0,5),s=()=>{const r=new Date().getHours();return r<12?"Good morning":r<18?"Good afternoon":"Good evening"};return e.jsxs("div",{className:"max-w-md mx-auto min-h-screen pb-6",style:{backgroundColor:t.colors.background},children:[e.jsx(Rs,{greeting:s()}),e.jsxs("main",{className:"px-4 py-2 space-y-6",children:[e.jsx(Os,{onContinueReading:()=>i("/reading")}),e.jsxs("section",{children:[e.jsx("h2",{className:"font-serif text-lg font-medium mb-3",style:{color:t.colors.textPrimary},children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(ve,{icon:ue,label:"Find Books",onClick:()=>i("/search")}),e.jsx(ve,{icon:ae,label:"My Notes",onClick:()=>i("/notes")}),e.jsx(ve,{icon:Ot,label:"My Library",onClick:()=>i("/library")}),e.jsx(ve,{icon:Ut,label:"Statistics",onClick:()=>i("/stats")})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"font-serif text-lg font-medium mb-3",style:{color:t.colors.textPrimary},children:"Your Progress"}),e.jsx(Us,{})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"font-serif text-lg font-medium mb-1",style:{color:t.colors.textPrimary},children:"Recent Activity"}),o.length>0?e.jsx("div",{className:"rounded-xl shadow-sm overflow-hidden",style:{backgroundColor:t.colors.surface},children:o.map(r=>e.jsx(Fs,{type:"reading",title:"Reading session completed",timestamp:r.endTime||r.startTime,duration:r.duration||0},r.id))}):e.jsx("p",{className:"text-sm p-4 rounded-xl shadow-sm",style:{color:t.colors.textSecondary,backgroundColor:t.colors.surface},children:"No recent activity. Start reading to track your progress!"})]}),e.jsx("section",{className:"text-center py-4",children:e.jsx("button",{onClick:()=>i("/welcome"),className:"text-sm hover:underline transition-colors underline",style:{color:t.colors.textSecondary},onMouseEnter:r=>{r.currentTarget.style.color=t.colors.textPrimary},onMouseLeave:r=>{r.currentTarget.style.color=t.colors.textSecondary},children:"Learn more about Bookish features"})})]})]})},Ls="modulepreload",Ms=function(i){return"/Bookish/"+i},Qe={},Xe=function(t,c,o){let s=Promise.resolve();if(c&&c.length>0){let l=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(n=>({status:"fulfilled",value:n}),n=>({status:"rejected",reason:n}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),a=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));s=l(c.map(d=>{if(d=Ms(d),d in Qe)return;Qe[d]=!0;const u=d.endsWith(".css"),n=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${n}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Ls,u||(f.as="script"),f.crossOrigin="",f.href=d,a&&f.setAttribute("nonce",a),document.head.appendChild(f),u)return new Promise((v,m)=>{f.addEventListener("load",v),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${d}`)))})}))}function r(l){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=l,window.dispatchEvent(h),!h.defaultPrevented)throw l}return s.then(l=>{for(const h of l||[])h.status==="rejected"&&r(h.reason);return t().catch(r)})},Se=({children:i,className:t=""})=>{const{theme:c}=$();return e.jsx("div",{className:`min-h-screen transition-colors duration-200 ${t}`,style:{backgroundColor:c.colors.background},children:i})},Js=()=>{const i=z(),{theme:t}=$(),[c,o]=E.useState(""),[s,r]=E.useState([]),[l,h]=E.useState(!1),[a,d]=E.useState("general"),[u,n]=E.useState(!1);E.useEffect(()=>()=>{if(typeof window<"u"&&window.Quagga)try{window.Quagga.stop()}catch{}},[]);const f=async y=>{if(y.preventDefault(),!!c.trim()){h(!0);try{let b;a==="subject"?b=await us(c):b=await as(c),r(b)}catch(b){console.error("Error searching books:",b)}finally{h(!1)}}},v=async()=>{try{n(!0),setTimeout(()=>{w()},300)}catch(y){console.error("Error starting camera:",y),alert("Unable to access camera. Please check permissions."),n(!1)}},m=()=>{try{Xe(()=>import("./quagga.min-CA_kn7cW.js").then(y=>y.q),__vite__mapDeps([0,1])).then(y=>{const b=y.default;b.stop(),b.offDetected(),b.offProcessed(),console.log("Quagga stopped successfully")}).catch(y=>{console.log("Error stopping Quagga:",y)})}catch(y){console.log("Quagga cleanup error:",y)}n(!1)},w=async()=>{try{const y=document.querySelector("#barcode-scanner");if(!y){console.error("Scanner element not found");return}const N=(await Xe(()=>import("./quagga.min-CA_kn7cW.js").then(S=>S.q),__vite__mapDeps([0,1]))).default,p={inputStream:{name:"Live",type:"LiveStream",target:y,constraints:{width:480,height:320,facingMode:"environment"}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:1,frequency:5,decoder:{readers:["ean_reader","ean_8_reader"]},locate:!0};console.log("Initializing Quagga with config:",p),N.init(p,S=>{if(S){console.error("QuaggaJS initialization failed:",S),alert("Camera access failed. Please ensure you have granted camera permissions and are using HTTPS."),m();return}console.log("QuaggaJS initialized successfully"),N.start(),console.log("QuaggaJS started")}),N.onDetected(S=>{const T=S.codeResult.code;console.log("Barcode detected:",T);const B=j(T);console.log("Cleaned barcode:",B),g(B)?(console.log("Valid ISBN detected, searching..."),x(B),m()):console.log("Invalid ISBN format, continuing scan...")});let A=0;N.onProcessed(S=>{A++,A%30===0&&console.log("Processing frames... Count:",A),S&&S.codeResult&&S.codeResult.code&&console.log("Potential code detected:",S.codeResult.code)})}catch(y){console.error("Error loading Quagga:",y),alert("Failed to load barcode scanner. Please try again."),m()}},g=y=>{const b=y.replace(/[^0-9X]/gi,"");return b.length===10||b.length===13},j=y=>y.replace(/[^0-9X]/gi,""),x=async y=>{h(!0);try{const b=await ms(y);b?(r([b]),o(y)):alert("No book found for this barcode")}catch(b){console.error("Error searching by ISBN:",b),alert("Error scanning barcode")}finally{h(!1)}},k=y=>{i(`/book?book=${encodeURIComponent(y.key)}`,{state:{bookData:y}})};return e.jsx(Se,{children:e.jsxs("div",{className:"max-w-md mx-auto min-h-screen pb-6",children:[e.jsxs("header",{className:"page-header p-4 shadow-sm",style:{backgroundColor:t.colors.surfaceSecondary},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("button",{onClick:()=>i(-1),className:"w-8 h-8 flex items-center justify-center rounded-full transition-colors",style:{backgroundColor:t.colors.surface},onMouseEnter:y=>{y.currentTarget.style.backgroundColor=t.colors.surfaceSecondary},onMouseLeave:y=>{y.currentTarget.style.backgroundColor=t.colors.surface},children:e.jsx(Z,{className:"w-5 h-5",style:{color:t.colors.textSecondary}})}),e.jsxs("form",{onSubmit:f,className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:c,onChange:y=>o(y.target.value),placeholder:a==="subject"?"Search by subject (e.g. science, fiction)...":"Search for books...",className:"w-full py-2 px-4 pr-10 border rounded-lg focus:outline-none focus:ring-2 input-field",style:{backgroundColor:t.colors.surface,borderColor:t.colors.border,color:t.colors.textPrimary}}),e.jsx("button",{type:"submit",className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-7 h-7 flex items-center justify-center rounded-full text-white",style:{backgroundColor:t.colors.primary},children:e.jsx(ue,{className:"w-4 h-4"})})]}),e.jsx("button",{onClick:v,className:"w-10 h-10 flex items-center justify-center rounded-full text-white transition-colors",style:{backgroundColor:t.colors.primary},onMouseEnter:y=>{y.currentTarget.style.backgroundColor=t.colors.primaryLight},onMouseLeave:y=>{y.currentTarget.style.backgroundColor=t.colors.primary},children:e.jsx(Ue,{className:"w-5 h-5"})})]}),"        ",e.jsxs("div",{className:"flex rounded-lg p-1",style:{backgroundColor:t.colors.surface},children:[e.jsxs("button",{onClick:()=>d("general"),className:"flex-1 flex items-center justify-center gap-2 py-2 px-3 rounded-md text-sm font-medium transition-colors",style:{backgroundColor:a==="general"?t.colors.primary:"transparent",color:a==="general"?"white":t.colors.textSecondary},children:[e.jsx(ue,{className:"w-4 h-4"}),"General"]}),e.jsxs("button",{onClick:()=>d("subject"),className:"flex-1 flex items-center justify-center gap-2 py-2 px-3 rounded-md text-sm font-medium transition-colors",style:{backgroundColor:a==="subject"?t.colors.primary:"transparent",color:a==="subject"?"white":t.colors.textSecondary},children:[e.jsx(Fe,{className:"w-4 h-4"}),"Subject"]})]})]}),u&&e.jsx("div",{className:"modal-overlay fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center",children:e.jsxs("div",{className:"rounded-lg p-4 m-4 max-w-sm w-full",style:{backgroundColor:t.colors.surface},children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-serif text-lg font-medium",style:{color:t.colors.textPrimary},children:"Scan ISBN Barcode"}),e.jsx("button",{onClick:m,className:"w-8 h-8 flex items-center justify-center rounded-full transition-colors hover:opacity-80",style:{backgroundColor:t.colors.borderLight,color:t.colors.textSecondary},children:e.jsx(De,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{id:"barcode-scanner",className:"w-full h-48 bg-black rounded-lg overflow-hidden relative",children:e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white text-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-2",children:"📷"}),e.jsx("div",{children:"Initializing camera..."}),e.jsx("div",{className:"text-xs mt-1",children:"Make sure to allow camera access"})]})})}),e.jsx("div",{className:"absolute inset-0 rounded-lg pointer-events-none",style:{border:`2px solid ${t.colors.primary}`},children:e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-32 h-16 border-2 border-white rounded",children:e.jsx("div",{className:"absolute inset-0 animate-pulse",style:{borderTop:`2px solid ${t.colors.primary}`}})})})]}),e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx("p",{className:"text-sm mb-2",style:{color:t.colors.textSecondary},children:"Point camera at book's barcode"}),e.jsx("p",{className:"text-xs mb-2",style:{color:t.colors.textSecondary},children:"Hold steady and ensure good lighting"}),e.jsx("p",{className:"text-xs italic",style:{color:t.colors.textSecondary},children:"Looking for ISBN-13 barcodes (978...)"}),e.jsx("div",{className:"mt-4 pt-4",style:{borderTop:`1px solid ${t.colors.border}`},children:e.jsx("button",{onClick:()=>{const y=prompt("Enter ISBN manually (if barcode scan fails):");y&&(x(y.trim()),m())},className:"text-xs underline",style:{color:t.colors.primary},children:"Enter ISBN manually"})})]})]})}),e.jsx("main",{className:"px-4 py-4",children:l?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2",style:{borderTopColor:t.colors.primary,borderBottomColor:t.colors.primary}})}):s.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"font-serif text-lg font-medium",style:{color:t.colors.textPrimary},children:a==="subject"?"Books in Subject":"Search Results"}),e.jsx("div",{className:"space-y-3",children:s.map(y=>e.jsxs("div",{onClick:()=>k(y),className:"flex gap-4 p-4 rounded-xl shadow-sm hover:shadow-md transition-shadow cursor-pointer",style:{backgroundColor:t.colors.surface},children:[e.jsxs("div",{className:"w-12 h-16 rounded flex-shrink-0 overflow-hidden",style:{backgroundColor:t.colors.borderLight},children:[y.cover_i?e.jsx("img",{src:`https://covers.openlibrary.org/b/id/${y.cover_i}-M.jpg`,alt:y.title,className:"w-full h-full object-cover",onError:b=>{var p;const N=b.target;N.style.display="none",(p=N.nextElementSibling)==null||p.classList.remove("hidden")}}):null,e.jsx("div",{className:`w-full h-full flex items-center justify-center ${y.cover_i?"hidden":""}`,children:e.jsx(q,{className:"w-6 h-6",style:{color:t.colors.textSecondary}})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-serif font-medium text-sm leading-tight mb-1 truncate",style:{color:t.colors.textPrimary},children:y.title}),y.author_name&&e.jsxs("p",{className:"text-xs mb-2 truncate",style:{color:t.colors.textSecondary},children:["by ",y.author_name[0]]}),y.first_publish_year&&e.jsx("p",{className:"text-xs",style:{color:t.colors.textSecondary},children:y.first_publish_year})]})]},y.key))})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-6 text-center",children:[e.jsx(ue,{className:"w-12 h-12 mb-4 opacity-70",style:{color:t.colors.textSecondary}}),e.jsx("h2",{className:"font-serif text-lg font-medium mb-2",style:{color:t.colors.textPrimary},children:"Find your next great read"}),e.jsx("p",{className:"text-sm max-w-xs mb-4",style:{color:t.colors.textSecondary},children:"Search for books by title, author, ISBN, or browse by subject. You can also scan a barcode!"}),e.jsxs("div",{className:"flex items-center justify-center gap-4 text-xs",style:{color:t.colors.textSecondary},children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ue,{className:"w-4 h-4"}),"Scan"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ue,{className:"w-4 h-4"}),"Search"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Fe,{className:"w-4 h-4"}),"Browse"]})]})]})})]})})},ge=({isOpen:i,onClose:t,onConfirm:c,title:o,message:s,type:r="confirm",confirmText:l="Confirm",cancelText:h="Cancel"})=>{const{theme:a}=$();if(!i)return null;const d=()=>{switch(r){case"alert":return e.jsx(Ge,{className:"w-8 h-8 text-red-500"});case"success":return e.jsx(Gt,{className:"w-8 h-8 text-green-500"});case"info":return e.jsx(Ft,{className:"w-8 h-8 text-blue-500"});default:return e.jsx(Ge,{className:"w-8 h-8",style:{color:a.colors.primary}})}},u=()=>{c&&c(),t()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"rounded-xl shadow-xl w-full max-w-sm mx-auto",style:{backgroundColor:a.colors.surface},children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[d(),e.jsx("div",{className:"flex-1",children:e.jsx("h3",{className:"font-serif text-lg font-medium",style:{color:a.colors.textPrimary},children:o})}),e.jsx("button",{onClick:t,className:"w-8 h-8 flex items-center justify-center rounded-full transition-colors hover:opacity-80",style:{backgroundColor:a.colors.borderLight,color:a.colors.textSecondary},children:e.jsx(De,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-sm leading-relaxed mb-6",style:{color:a.colors.textPrimary},children:s}),e.jsxs("div",{className:"flex gap-3",children:[r==="confirm"&&e.jsx("button",{onClick:t,className:"flex-1 py-3 px-4 rounded-lg font-medium text-sm transition-colors hover:opacity-80",style:{backgroundColor:a.colors.borderLight,color:a.colors.textSecondary},children:h}),e.jsx("button",{onClick:u,className:`flex-1 py-3 px-4 rounded-lg font-medium text-sm transition-colors ${r==="success"?"bg-green-600 text-white hover:bg-green-700":r==="alert"?"bg-red-600 text-white hover:bg-red-700":"text-white hover:opacity-80"}`,style:r==="confirm"?{backgroundColor:a.colors.primary}:{},children:r==="confirm"?l:"OK"})]})]})})})},ye=()=>{const[i,t]=E.useState(!1),[c,o]=E.useState({title:"",message:""}),[s,r]=E.useState(null);return{isOpen:i,config:c,onConfirm:s,close:()=>{t(!1),r(null)},showConfirm:(d,u,n,f)=>{o({title:d,message:u,type:"confirm",confirmText:f==null?void 0:f.confirmText,cancelText:f==null?void 0:f.cancelText}),r(()=>n),t(!0)},showAlert:(d,u,n="info")=>{o({title:d,message:u,type:n}),r(null),t(!0)}}},$s=()=>{const i=z(),[t]=tt(),c=wt(),{books:o,setActiveBook:s,sessions:r,notes:l}=oe(),{updatePetFromBookCompletion:h}=ie(),{theme:a}=$(),[d,u]=E.useState(!1),[n,f]=E.useState(null),[v,m]=E.useState(!1),[w,g]=E.useState(!1),[j,x]=E.useState(!1),k=ye(),y=t.get("book");if(E.useEffect(()=>{var D;if((D=c.state)!=null&&D.bookData)f(c.state.bookData);else{const R=o.find(F=>F.key===y);if(R)f(R);else{i("/");return}}},[y,o,c.state,i]),E.useEffect(()=>{if(n){const R=JSON.parse(localStorage.getItem("bookish_books")||"[]").some(U=>U.key===n.key);m(R);const F=it(n.key);if(F&&F.description&&!n.description){f(U=>({...U,description:F.description,number_of_pages_median:F.number_of_pages_median||U.number_of_pages_median}));return}n.description||(u(!0),ls(n.key).then(U=>{if(U){const Q={...n,description:U.description,number_of_pages_median:U.number_of_pages_median||n.number_of_pages_median};f(Q),We(Q)}}).catch(U=>{console.error("Error fetching book details:",U),F&&f(Q=>({...Q,...F}))}).finally(()=>{u(!1)}))}},[n]),!n)return e.jsx("div",{className:"max-w-md mx-auto min-h-screen bg-[#F7F5F3] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[#8B7355] mb-4",children:"Book not found"}),e.jsx("button",{onClick:()=>i("/search"),className:"bg-[#8B7355] text-white px-6 py-3 rounded-xl font-medium",children:"Back to Search"})]})});const b=D=>{const R=JSON.parse(localStorage.getItem("bookish_books")||"[]");if(!R.some(F=>F.key===n.key)){const F={...n,category:D,dateAdded:new Date().toISOString()};R.push(F),localStorage.setItem("bookish_books",JSON.stringify(R)),We(F);const U=JSON.parse(localStorage.getItem("myBooks")||"[]");U.some(Q=>Q.key===n.key)||(U.push(F),localStorage.setItem("myBooks",JSON.stringify(U))),m(!0),g(!1),D==="currently-reading"&&(s(n),i("/reading"))}},N=()=>{k.showConfirm("Mark as Completed","Mark this book as completed? This will give your pet a big experience boost!",()=>{var Q;const R=JSON.parse(localStorage.getItem("bookish_books")||"[]").map(ee=>ee.key===n.key?{...ee,category:"completed",completedAt:new Date().toISOString()}:ee);localStorage.setItem("bookish_books",JSON.stringify(R));const U=JSON.parse(localStorage.getItem("myBooks")||"[]").map(ee=>ee.key===n.key?{...ee,category:"completed",completedAt:new Date().toISOString()}:ee);localStorage.setItem("myBooks",JSON.stringify(U)),h(),n.key===((Q=JSON.parse(localStorage.getItem("bookish_current_book")||"null"))==null?void 0:Q.key)&&s(null),k.showAlert("Congratulations!","🎉 You've completed the book and your pet gained experience!","success"),setTimeout(()=>{i("/library")},1500)},{confirmText:"Mark Complete",cancelText:"Cancel"})},p=n.number_of_pages_median||0,A=[...r].filter(D=>D.bookId===n.key).sort((D,R)=>new Date(R.startTime).getTime()-new Date(D.startTime).getTime())[0],S=(A==null?void 0:A.endPage)||(A==null?void 0:A.startPage)||1,T=p>0?Math.min(Math.round(S/p*100),100):0,B=r.filter(D=>D.bookId===n.key).reduce((D,R)=>D+(R.duration||0),0),C=Math.floor(B/60),_=B%60,I=C>0?`${C} hr${C!==1?"s":""} ${_>0?`${_} min`:""}`:`${_} min`,L=l.filter(D=>D.bookId===n.key),G=JSON.parse(localStorage.getItem("bookish_books")||"[]").find(D=>D.key===n.key),P=(G==null?void 0:G.category)==="completed",O=()=>{i(-1)};return e.jsxs("div",{className:"max-w-md mx-auto min-h-screen",style:{backgroundColor:a.colors.background},children:[e.jsx("div",{className:"p-4",style:{backgroundColor:a.colors.background},children:e.jsx("button",{onClick:O,className:"w-8 h-8 flex items-center justify-center rounded-full hover:opacity-80 transition-colors",style:{backgroundColor:a.colors.surface},children:e.jsx(Z,{className:"w-5 h-5",style:{color:a.colors.primary}})})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("div",{className:"w-24 h-32 rounded-lg overflow-hidden shadow-lg flex-shrink-0",children:n.cover_i?e.jsx("img",{src:`https://covers.openlibrary.org/b/id/${n.cover_i}-M.jpg`,alt:n.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",style:{backgroundColor:a.colors.primary},children:e.jsx(q,{className:"w-8 h-8 text-white"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"font-serif text-xl font-medium mb-2 leading-tight",style:{color:a.colors.textPrimary},children:n.title}),n.author_name&&n.author_name.length>0&&e.jsxs("p",{className:"text-sm mb-3",style:{color:a.colors.textSecondary},children:["by ",n.author_name[0]]}),e.jsxs("div",{className:"space-y-1",children:[n.first_publish_year&&e.jsxs("p",{className:"text-xs",style:{color:a.colors.textSecondary},children:["First published: ",n.first_publish_year]}),p>0&&e.jsxs("p",{className:"text-xs",style:{color:a.colors.textSecondary},children:[p," pages"]})]})]})]}),"        ",v&&p>0&&e.jsxs("div",{className:"flex gap-3 mb-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs",style:{color:a.colors.textSecondary},children:"Progress"}),e.jsxs("span",{className:"text-xs font-medium",style:{color:a.colors.textPrimary},children:[T,"%"]})]}),e.jsx("div",{className:"w-full h-2 rounded-full overflow-hidden mb-2",style:{backgroundColor:a.colors.borderLight},children:e.jsx("div",{className:"h-full rounded-full transition-all duration-300 ease-out",style:{width:`${T}%`,backgroundColor:a.colors.secondary}})}),e.jsxs("span",{className:"text-xs",style:{color:a.colors.textSecondary},children:["Page ",S," of ",p]})]}),e.jsx("div",{className:"w-px",style:{backgroundColor:a.colors.border}}),e.jsxs("div",{className:"flex flex-col items-center justify-center w-24",children:[e.jsx(rt,{className:"w-5 h-5 mb-1",style:{color:a.colors.textSecondary}}),e.jsx("span",{className:"text-sm font-medium",style:{color:a.colors.textPrimary},children:I}),e.jsx("span",{className:"text-xs text-[#8B7355]",children:"Total Time"})]})]}),d?e.jsx("div",{className:"h-32 animate-pulse rounded-lg mb-6",style:{backgroundColor:a.colors.borderLight}}):n.description?e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"font-serif text-lg font-medium mb-2",style:{color:a.colors.textPrimary},children:"About this book"}),e.jsxs("div",{className:"relative",children:[e.jsx("p",{className:`text-sm leading-relaxed ${j?"":"line-clamp-4"}`,style:{color:a.colors.textPrimary},children:typeof n.description=="string"?n.description:"No description available."}),n.description&&n.description.length>200&&e.jsx("button",{onClick:()=>x(!j),className:"mt-2 flex items-center gap-1 text-sm font-medium hover:opacity-80 transition-colors",style:{color:a.colors.textSecondary},children:j?e.jsxs(e.Fragment,{children:["Show less",e.jsx(Lt,{className:"w-4 h-4"})]}):e.jsxs(e.Fragment,{children:["Read more",e.jsx(Mt,{className:"w-4 h-4"})]})})]})]}):null,v&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h2",{className:"font-serif text-lg font-medium text-[#3A3A3A]",children:"My Notes"}),e.jsx("button",{onClick:()=>i("/notes"),className:"text-xs font-medium text-[#D2691E]",children:"View All"})]}),L.length>0?e.jsx("div",{className:"space-y-2",children:L.slice(0,2).map(D=>e.jsxs("div",{className:"p-3 rounded-lg shadow-sm",style:{backgroundColor:a.colors.surface},children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("span",{className:"text-xs",style:{color:a.colors.textSecondary},children:[D.chapter?`Chapter: ${D.chapter}`:"",D.chapter&&D.page?" • ":"",D.page?`Page ${D.page}`:""]}),e.jsx("span",{className:"text-xs",style:{color:a.colors.textSecondary},children:new Date(D.createdAt).toLocaleDateString()})]}),e.jsx("p",{className:"text-sm line-clamp-2",style:{color:a.colors.textPrimary},children:D.content})]},D.id))}):e.jsx("div",{className:"p-4 rounded-lg shadow-sm flex items-center justify-center",style:{backgroundColor:a.colors.surface},children:e.jsxs("div",{className:"text-center",children:[e.jsx(ae,{className:"w-6 h-6 mx-auto mb-2",style:{color:a.colors.textSecondary}}),e.jsx("p",{className:"text-sm mb-1",style:{color:a.colors.textSecondary},children:"No notes yet"}),e.jsx("button",{onClick:()=>i("/notes/add"),className:"text-xs font-medium text-[#D2691E]",children:"Add Your First Note"})]})})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 border-t flex gap-4 max-w-md mx-auto",style:{backgroundColor:a.colors.surface,borderColor:a.colors.border},children:v?e.jsx(e.Fragment,{children:P?e.jsxs("div",{className:"flex-1 py-3 px-4 bg-green-100 text-green-700 rounded-lg font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx(me,{className:"w-5 h-5"}),"Completed"]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>i("/notes/add"),className:"flex-1 py-3 px-4 border border-[#D2691E] text-[#D2691E] rounded-lg font-medium text-sm flex items-center justify-center gap-2",style:{backgroundColor:a.colors.surface},children:[e.jsx(ae,{className:"w-5 h-5"}),"Add Note"]}),e.jsxs("button",{onClick:()=>{s(n),i("/reading")},className:"flex-1 py-3 px-4 bg-[#D2691E] text-white rounded-lg font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx(Jt,{className:"w-5 h-5"}),"Start Reading"]}),e.jsx("button",{onClick:N,className:"py-3 px-3 bg-green-600 text-white rounded-lg font-medium text-sm flex items-center justify-center",title:"Mark as Completed",children:e.jsx(me,{className:"w-5 h-5"})})]})}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>i("/library"),className:"flex-1 py-3 px-4 border border-[#8B7355] text-[#8B7355] rounded-lg font-medium text-sm",style:{backgroundColor:a.colors.surface},children:"View Library"}),e.jsxs("button",{onClick:()=>g(!0),className:"flex-1 py-3 px-4 bg-[#8B7355] text-white rounded-lg font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx(at,{className:"w-5 h-5"}),"Add to Library"]})]})})]}),"      ",w&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"rounded-xl p-6 w-full max-w-sm",style:{backgroundColor:a.colors.surface},children:[e.jsx("h3",{className:"font-serif text-lg font-medium mb-4",style:{color:a.colors.textPrimary},children:"Add to Library"}),e.jsx("p",{className:"text-sm mb-6",style:{color:a.colors.textSecondary},children:"Choose where to add this book:"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>b("want-to-read"),className:"w-full p-4 rounded-lg text-left hover:opacity-80 transition-colors",style:{backgroundColor:a.colors.borderLight},children:[e.jsx("div",{className:"font-medium mb-1",style:{color:a.colors.textPrimary},children:"Want to Read"}),e.jsx("div",{className:"text-xs",style:{color:a.colors.textSecondary},children:"Save for later reading"})]}),e.jsxs("button",{onClick:()=>b("currently-reading"),className:"w-full p-4 text-white rounded-lg text-left hover:opacity-90 transition-colors",style:{backgroundColor:a.colors.primary},children:[e.jsx("div",{className:"font-medium mb-1",children:"Start Reading Now"}),e.jsx("div",{className:"text-xs opacity-90",children:"Add to library and begin reading session"})]})]}),e.jsx("button",{onClick:()=>g(!1),className:"w-full mt-4 py-2 text-sm hover:opacity-80 transition-colors",style:{color:a.colors.textSecondary},children:"Cancel"})]})}),e.jsx(ge,{isOpen:k.isOpen,onClose:k.close,onConfirm:k.onConfirm||void 0,title:k.config.title,message:k.config.message,type:k.config.type,confirmText:k.config.confirmText,cancelText:k.config.cancelText})]})},H=[];for(let i=0;i<256;++i)H.push((i+256).toString(16).slice(1));function Hs(i,t=0){return(H[i[t+0]]+H[i[t+1]]+H[i[t+2]]+H[i[t+3]]+"-"+H[i[t+4]]+H[i[t+5]]+"-"+H[i[t+6]]+H[i[t+7]]+"-"+H[i[t+8]]+H[i[t+9]]+"-"+H[i[t+10]]+H[i[t+11]]+H[i[t+12]]+H[i[t+13]]+H[i[t+14]]+H[i[t+15]]).toLowerCase()}let Ee;const Ys=new Uint8Array(16);function Ks(){if(!Ee){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Ee=crypto.getRandomValues.bind(crypto)}return Ee(Ys)}const qs=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ze={randomUUID:qs};function he(i,t,c){var s;if(Ze.randomUUID&&!i)return Ze.randomUUID();i=i||{};const o=i.random??((s=i.rng)==null?void 0:s.call(i))??Ks();if(o.length<16)throw new Error("Random bytes length must be >= 16");return o[6]=o[6]&15|64,o[8]=o[8]&63|128,Hs(o)}const ne="bookish_active_timer",zs=({bookId:i,startPage:t})=>{const[c,o]=E.useState({sessionId:null,startTime:null,totalElapsed:0,lastPauseTime:null,isActive:!1}),s=E.useRef();E.useEffect(()=>{const n=localStorage.getItem(ne);if(n)try{const f=JSON.parse(n);f.bookId===i?o(f.timerState):localStorage.removeItem(ne)}catch(f){console.error("Error loading timer state:",f),localStorage.removeItem(ne)}},[i]),E.useEffect(()=>{c.sessionId&&localStorage.setItem(ne,JSON.stringify({bookId:i,startPage:t,timerState:c}))},[c,i,t]),E.useEffect(()=>(c.isActive?s.current=setInterval(()=>{o(n=>({...n}))},1e3):s.current&&clearInterval(s.current),()=>{s.current&&clearInterval(s.current)}),[c.isActive]);const r=()=>{if(!c.startTime)return 0;let n=c.totalElapsed;if(c.isActive&&c.lastPauseTime===null){const f=Date.now(),v=new Date(c.startTime).getTime();n+=Math.floor((f-v)/1e3)}return n},l=r(),h=()=>{const n=new Date().toISOString();c.sessionId?o(f=>({...f,startTime:n,lastPauseTime:null,isActive:!0})):o({sessionId:he(),startTime:n,totalElapsed:0,lastPauseTime:null,isActive:!0})},a=()=>{if(!c.isActive||!c.startTime)return;const n=Date.now(),f=new Date(c.startTime).getTime(),v=Math.floor((n-f)/1e3);o(m=>({...m,totalElapsed:m.totalElapsed+v,lastPauseTime:new Date().toISOString(),isActive:!1}))},d=n=>{const f=r(),v={id:c.sessionId||he(),bookId:i,startTime:c.startTime||new Date().toISOString(),endTime:new Date().toISOString(),startPage:t,endPage:n,duration:Math.floor(f/60)};return o({sessionId:null,startTime:null,totalElapsed:0,lastPauseTime:null,isActive:!1}),localStorage.removeItem(ne),v},u=()=>{o({sessionId:null,startTime:null,totalElapsed:0,lastPauseTime:null,isActive:!1}),localStorage.removeItem(ne)};return{isActive:c.isActive,elapsedTime:l,startTimer:h,pauseTimer:a,stopTimer:d,resetTimer:u}},Ws=()=>{const i=z(),{currentBook:t,addSession:c,addNote:o}=oe(),{updatePetFromReading:s}=ie(),{theme:r}=$(),l=ye(),[h,a]=E.useState(1),[d,u]=E.useState(1),[n,f]=E.useState(!1),[v,m]=E.useState(""),[w,g]=E.useState(""),[j,x]=E.useState(!1),[k,y]=E.useState(!1),{isActive:b,elapsedTime:N,startTimer:p,pauseTimer:A,stopTimer:S,resetTimer:T}=zs({bookId:(t==null?void 0:t.key)||"",startPage:1});if(E.useEffect(()=>{if(t&&!k){const P=localStorage.getItem("bookish_active_timer");if(P)try{const R=JSON.parse(P);if(R.bookId===t.key){a(R.startPage),u(R.startPage),y(!0);return}}catch(R){console.error("Error parsing active timer:",R)}const D=JSON.parse(localStorage.getItem("bookish_reading_sessions")||"[]").filter(R=>R.bookId===t.key);if(D.length>0){D.sort((F,U)=>new Date(U.startTime).getTime()-new Date(F.startTime).getTime());const R=D[0].endPage||D[0].startPage;a(R),u(R)}y(!0)}},[t,k]),E.useEffect(()=>{const P=O=>{b&&(O.preventDefault(),O.returnValue="You have an active reading session. Are you sure you want to leave?")};return window.addEventListener("beforeunload",P),()=>window.removeEventListener("beforeunload",P)},[b]),!t)return i("/"),null;const B=()=>{try{if(!t){l.showAlert("Error","No book selected","alert");return}if(d<h){l.showAlert("Invalid Page Range","End page cannot be less than start page","alert");return}if(N<=0){l.showAlert("No Time Recorded","Please start the timer to record reading time","alert");return}const P=S(d);if(!P)throw new Error("Failed to create session");if(c(P),P.duration&&s(P.duration),v.trim()){const O={id:he(),bookId:t.key,page:d,chapter:w.trim()||void 0,content:v.trim(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};o(O)}i("/")}catch(P){console.error("Error finishing session:",P),l.showAlert("Error","Failed to save reading session. Please try again.","alert")}},C=P=>{const O=Math.floor(P/3600),D=Math.floor(P%3600/60),R=P%60;return O>0?`${O}:${D.toString().padStart(2,"0")}:${R.toString().padStart(2,"0")}`:`${D.toString().padStart(2,"0")}:${R.toString().padStart(2,"0")}`},_=t.number_of_pages_median||9999,I=t.number_of_pages_median&&t.number_of_pages_median>0,L=()=>{const P=(t==null?void 0:t.number_of_pages_median)||0;return P>0&&d>=P},M=P=>{const O=Math.max(h,Math.min(P,_));u(O),t!=null&&t.number_of_pages_median&&O>=t.number_of_pages_median&&x(!0)},G=()=>{try{const P=S(d);if(P&&(c(P),P.duration&&s(P.duration)),v.trim()){const U={id:he(),bookId:t.key,page:d,chapter:w.trim()||void 0,content:v.trim(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};o(U)}const D=JSON.parse(localStorage.getItem("bookish_books")||"[]").map(U=>U.key===t.key?{...U,category:"completed",completedAt:new Date().toISOString()}:U);localStorage.setItem("bookish_books",JSON.stringify(D));const F=JSON.parse(localStorage.getItem("myBooks")||"[]").map(U=>U.key===t.key?{...U,category:"completed",completedAt:new Date().toISOString()}:U);localStorage.setItem("myBooks",JSON.stringify(F)),localStorage.removeItem("bookish_current_book"),s((P==null?void 0:P.duration)||0,!0),l.showAlert("Congratulations!","🎉 You've completed the book and your pet gained bonus experience!","success"),setTimeout(()=>{i("/library")},2e3)}catch(P){console.error("Error marking book as finished:",P),l.showAlert("Error","Failed to mark book as completed. Please try again.","alert")}};return e.jsxs("div",{className:"max-w-md mx-auto min-h-screen pb-20",style:{backgroundColor:r.colors.background},children:[e.jsxs("header",{className:"p-4 flex items-center gap-3 shadow-sm",style:{backgroundColor:r.colors.surface},children:[e.jsx("button",{onClick:()=>{b||N>0?l.showConfirm("Leave Reading Session",b?"Your timer is still running. The session will continue in the background if you leave.":"You have an unsaved reading session. Do you want to save it or discard it?",()=>{!b&&N>0?B():i(-1)},{confirmText:b?"Leave (Keep Timer)":"Save & Leave",cancelText:"Stay"}):i(-1)},className:"w-8 h-8 flex items-center justify-center rounded-full transition-colors hover:opacity-80",style:{backgroundColor:r.colors.borderLight,color:r.colors.textSecondary},children:e.jsx(Z,{className:"w-5 h-5"})}),e.jsx("h1",{className:"font-serif text-lg font-medium",style:{color:r.colors.textPrimary},children:"Reading Session"}),b&&e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"})})]}),e.jsx("main",{className:"p-4",children:e.jsxs("div",{className:"rounded-xl shadow-sm overflow-hidden mb-6",style:{backgroundColor:r.colors.surface},children:[e.jsxs("div",{className:"flex items-center p-4",style:{borderBottom:`1px solid ${r.colors.border}`},children:[e.jsx("div",{className:"w-12 h-16 rounded overflow-hidden mr-3",children:t.cover_i?e.jsx("img",{src:ds(t.cover_i,"S"),alt:t.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full",style:{backgroundColor:r.colors.secondary}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-serif text-base font-medium line-clamp-1",style:{color:r.colors.textPrimary},children:t.title}),t.author_name&&t.author_name.length>0&&e.jsxs("p",{className:"text-sm",style:{color:r.colors.textSecondary},children:["by ",t.author_name[0]]})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex justify-center mb-8",children:e.jsx("div",{className:"w-24 h-24 rounded-full flex items-center justify-center shadow-inner",style:{backgroundColor:r.colors.borderLight},children:e.jsx("span",{className:"font-serif text-2xl font-medium",style:{color:r.colors.textPrimary},children:C(N)})})}),e.jsx("div",{className:"flex justify-center mb-8",children:e.jsx("button",{onClick:b?A:p,className:"w-16 h-16 rounded-full text-white flex items-center justify-center shadow-md transition-colors hover:opacity-90",style:{backgroundColor:r.colors.primary},children:b?e.jsx($t,{className:"w-8 h-8"}):e.jsx(Ht,{className:"w-8 h-8"})})}),e.jsxs("div",{className:"flex gap-6 mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm mb-2",style:{color:r.colors.textSecondary},children:"Start Page"}),e.jsx("input",{type:"number",value:h,onChange:P=>{const O=Math.max(1,Math.min(parseInt(P.target.value)||1,_));a(O),d<O&&u(O)},min:"1",max:_,className:"w-full p-2 rounded-md",style:{border:`1px solid ${r.colors.border}`,backgroundColor:r.colors.surface,color:r.colors.textPrimary},disabled:b||N>0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm mb-2",style:{color:r.colors.textSecondary},children:"End Page"}),e.jsx("input",{type:"number",value:d,onChange:P=>M(parseInt(P.target.value)||h),min:h,max:_,className:"w-full p-2 rounded-md",style:{border:`1px solid ${r.colors.border}`,backgroundColor:r.colors.surface,color:r.colors.textPrimary}})]})]}),L()&&e.jsxs("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(we,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-medium text-green-800",children:"Congratulations!"})]}),e.jsx("p",{className:"text-sm text-green-700 mb-3",children:"You've reached the last page! Would you like to mark this book as completed?"}),e.jsx("button",{onClick:G,className:"w-full py-2 px-4 bg-green-600 text-white rounded-lg font-medium text-sm hover:bg-green-700 transition-colors",children:"Mark as Finished"})]}),!I&&e.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-blue-700",children:"📘 Page count unavailable for this book. You can still track your reading progress by entering the pages you read."})}),e.jsx("button",{onClick:()=>f(!n),className:"w-full py-2 text-sm mb-2",style:{color:r.colors.primary},children:n?"Hide Note Form":"+ Add a note about this session"}),n&&e.jsxs("div",{className:"space-y-4 mb-4 p-4 rounded-lg",style:{backgroundColor:r.colors.borderLight},children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-2",style:{color:r.colors.textSecondary},children:"Chapter (optional)"}),e.jsx("input",{type:"text",value:w,onChange:P=>g(P.target.value),placeholder:"e.g. Chapter 5",className:"w-full p-2 rounded-md",style:{border:`1px solid ${r.colors.border}`,backgroundColor:r.colors.surface,color:r.colors.textPrimary}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-2",style:{color:r.colors.textSecondary},children:"Note"}),e.jsx("textarea",{value:v,onChange:P=>m(P.target.value),placeholder:"Write your thoughts about this reading session...",rows:4,className:"w-full p-2 rounded-md resize-none",style:{border:`1px solid ${r.colors.border}`,backgroundColor:r.colors.surface,color:r.colors.textPrimary}})]})]})]})]})}),e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 p-4 flex gap-4 max-w-md mx-auto",style:{backgroundColor:r.colors.surface,borderTop:`1px solid ${r.colors.border}`},children:[e.jsxs("button",{onClick:()=>{l.showConfirm("Cancel Session",b?"This will stop your timer and discard the session. Are you sure?":"Are you sure you want to cancel this session? All progress will be lost.",()=>{T(),i(-1)},{confirmText:"Yes, Cancel",cancelText:"Keep Reading"})},className:"flex-1 py-3 px-4 rounded-lg font-medium text-sm flex items-center justify-center gap-2 transition-colors hover:opacity-80",style:{backgroundColor:r.colors.surface,border:`1px solid ${r.colors.border}`,color:r.colors.textSecondary},children:[e.jsx(De,{className:"w-5 h-5"}),"Cancel"]}),L()?e.jsxs("button",{onClick:G,className:"flex-1 py-3 px-4 bg-green-600 text-white rounded-lg font-medium text-sm flex items-center justify-center gap-2 hover:bg-green-700 transition-colors",children:[e.jsx(we,{className:"w-5 h-5"}),"Mark as Finished"]}):e.jsxs("button",{onClick:B,className:"flex-1 py-3 px-4 text-white rounded-lg font-medium text-sm flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors hover:opacity-90",style:{backgroundColor:r.colors.primary},disabled:N<=0||d<h,children:[e.jsx(me,{className:"w-5 h-5"}),"Finish Session"]})]}),"      ",j&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"rounded-xl p-6 w-full max-w-sm",style:{backgroundColor:r.colors.surface},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(we,{className:"w-8 h-8 text-green-600"})}),e.jsx("h3",{className:"font-serif text-lg font-medium mb-2",style:{color:r.colors.textPrimary},children:"Congratulations!"}),e.jsxs("p",{className:"text-sm mb-6",style:{color:r.colors.textSecondary},children:[`You've reached the last page of "`,t.title,'". Would you like to mark it as completed?']}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:G,className:"w-full py-3 px-4 bg-green-600 text-white rounded-lg font-medium text-sm hover:bg-green-700 transition-colors",children:"Yes, Mark as Completed"}),e.jsx("button",{onClick:()=>x(!1),className:"w-full py-2 px-4 rounded-lg font-medium text-sm transition-colors hover:opacity-80",style:{backgroundColor:r.colors.surface,border:`1px solid ${r.colors.border}`,color:r.colors.textSecondary},children:"Continue Reading"})]})]})})}),e.jsx(ge,{isOpen:l.isOpen,onClose:l.close,onConfirm:l.onConfirm||void 0,title:l.config.title,message:l.config.message,type:l.config.type,confirmText:l.config.confirmText,cancelText:l.config.cancelText})]})},Vs=()=>{const i=z(),{books:t}=oe(),{updatePetFromBookCompletion:c}=ie(),{theme:o}=$(),s=ye(),[r,l]=E.useState(null),[h,a]=E.useState(null),[d,u]=E.useState({}),[n,f]=E.useState([]);E.useEffect(()=>{(()=>{const T=JSON.parse(localStorage.getItem("bookish_books")||"[]");f(T)})()},[]),E.useEffect(()=>{const S=()=>{l(null)};if(r)return document.addEventListener("click",S),()=>document.removeEventListener("click",S)},[r]);const v=n.length>0?n:t,m=S=>{i(`/book?book=${S.key}`,{state:{bookData:S}})},w=(S,T)=>{T.stopPropagation(),s.showConfirm("Remove Book","Are you sure you want to remove this book from your library?",()=>{const C=JSON.parse(localStorage.getItem("bookish_books")||"[]").filter(G=>G.key!==S);localStorage.setItem("bookish_books",JSON.stringify(C));const I=JSON.parse(localStorage.getItem("myBooks")||"[]").filter(G=>G.key!==S);localStorage.setItem("myBooks",JSON.stringify(I));const L=JSON.parse(localStorage.getItem("bookish_cached_books")||"{}");delete L[S],localStorage.setItem("bookish_cached_books",JSON.stringify(L));const M=JSON.parse(localStorage.getItem("bookish_current_book")||"null");M&&M.key===S&&localStorage.removeItem("bookish_current_book"),f(C)},{confirmText:"Remove",cancelText:"Keep Book"}),l(null)},g=(S,T,B)=>{const _=JSON.parse(localStorage.getItem("bookish_books")||"[]").map(M=>M.key===S?{...M,category:T}:M);localStorage.setItem("bookish_books",JSON.stringify(_));const L=JSON.parse(localStorage.getItem("myBooks")||"[]").map(M=>M.key===S?{...M,category:T}:M);localStorage.setItem("myBooks",JSON.stringify(L)),f(_),a(null),l(null)},j=(S,T)=>{T.stopPropagation(),s.showConfirm("Mark as Completed","Mark this book as completed? This will give your pet a big experience boost!",()=>{g(S,"completed"),c(),setTimeout(()=>{s.showAlert("Book Completed!","🎉 Book marked as completed! Check your pet for an experience boost!","success")},100)},{confirmText:"Mark Complete",cancelText:"Cancel"}),l(null)},x=(S,T)=>{T.stopPropagation(),l(r===S?null:S)},k=S=>{const T=Ve(S);if(T.length===0)return 0;const B=T[T.length-1],C=t.find(_=>_.key===S);return!(C!=null&&C.number_of_pages_median)||!B.endPage?0:Math.min(100,Math.round(B.endPage/C.number_of_pages_median*100))},y=S=>Ve(S).reduce((B,C)=>B+(C.duration||0),0),b=S=>{const T=Math.floor(S/60),B=S%60;return T>0?`${T}h ${B}m`:`${B}m`},N=()=>{const S=[],T=[],B=[];return v.forEach(C=>{const _=k(C.key),I=y(C.key);C.category==="want-to-read"?B.push(C):C.category==="completed"||_>=100?T.push(C):C.category==="currently-reading"||_>0||I>0?S.push(C):B.push(C)}),{currentlyReading:S,completed:T,wantToRead:B}},p=S=>{const T=k(S.key),B=y(S.key),C=d[S.key]||{translateX:0,isDeleting:!1},_=P=>{const O=P.touches[0];u(D=>({...D,[S.key]:{...C,startX:O.clientX,startY:O.clientY}}))},I=P=>{const O=P.touches[0],D=d[S.key];if(!(D!=null&&D.startX)||!(D!=null&&D.startY))return;const R=O.clientX-D.startX,F=O.clientY-D.startY;Math.abs(F)>Math.abs(R)||R<-20&&u(U=>({...U,[S.key]:{...D,translateX:Math.max(R,-120)}}))},L=()=>{const P=d[S.key];P&&(P.translateX<-60?u(O=>({...O,[S.key]:{...P,translateX:-120,isDeleting:!0}})):u(O=>({...O,[S.key]:{...P,translateX:0,isDeleting:!1}})))},M=()=>{s.showConfirm("Remove Book","Are you sure you want to remove this book from your library?",()=>{const O=JSON.parse(localStorage.getItem("bookish_books")||"[]").filter(F=>F.key!==S.key);localStorage.setItem("bookish_books",JSON.stringify(O));const R=JSON.parse(localStorage.getItem("myBooks")||"[]").filter(F=>F.key!==S.key);localStorage.setItem("myBooks",JSON.stringify(R)),f(O),u(F=>{const U={...F};return delete U[S.key],U})},{confirmText:"Remove",cancelText:"Keep Book"})},G=()=>{u(P=>({...P,[S.key]:{translateX:0,isDeleting:!1}}))};return e.jsxs("div",{className:"rounded-xl shadow-sm cursor-pointer hover:shadow-md transition-shadow relative",style:{backgroundColor:o.colors.surface,transform:`translateX(${C.translateX}px)`,transition:C.isDeleting||C.translateX===0?"transform 0.3s ease":"none",overflow:C.isDeleting?"hidden":"visible"},onTouchStart:_,onTouchMove:I,onTouchEnd:L,children:[e.jsxs("div",{className:"flex gap-3 p-4",onClick:()=>!C.isDeleting&&m(S),children:["          ",e.jsxs("div",{className:"w-12 h-16 rounded flex-shrink-0 flex items-center justify-center",style:{backgroundColor:o.colors.borderLight},children:[S.cover_i?e.jsx("img",{src:`https://covers.openlibrary.org/b/id/${S.cover_i}-M.jpg`,alt:S.title,className:"w-full h-full object-cover rounded",onError:P=>{var D;const O=P.target;O.style.display="none",(D=O.nextElementSibling)==null||D.classList.remove("hidden")}}):null,e.jsx(q,{className:`w-6 h-6 ${S.cover_i?"hidden":""}`,style:{color:o.colors.textSecondary}})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-serif font-medium text-sm leading-tight mb-1 truncate",style:{color:o.colors.textPrimary},children:S.title}),S.author_name&&e.jsxs("p",{className:"text-xs mb-2 truncate",style:{color:o.colors.textSecondary},children:["by ",S.author_name[0]]}),T>0&&T<100&&e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs",style:{color:o.colors.textSecondary},children:"Progress"}),e.jsxs("span",{className:"text-xs",style:{color:o.colors.textSecondary},children:[T,"%"]})]}),e.jsx("div",{className:"w-full rounded-full h-1.5",style:{backgroundColor:o.colors.borderLight},children:e.jsx("div",{className:"h-1.5 rounded-full transition-all duration-300",style:{width:`${T}%`,backgroundColor:o.colors.secondary}})})]}),T>=100&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600 mb-2",children:[e.jsx(me,{className:"w-3 h-3"}),e.jsx("span",{children:"Completed"})]}),B>0&&e.jsxs("div",{className:"flex items-center gap-1 text-xs",style:{color:o.colors.textSecondary},children:[e.jsx(le,{className:"w-3 h-3"}),e.jsxs("span",{children:[b(B)," read"]})]})]})]}),!C.isDeleting&&e.jsx("button",{onClick:P=>x(S.key,P),className:"absolute top-3 right-3 w-6 h-6 rounded-full flex items-center justify-center transition-colors hover:opacity-80",style:{backgroundColor:o.colors.borderLight},children:e.jsx(Yt,{className:"w-4 h-4",style:{color:o.colors.textSecondary}})}),"        ",r===S.key&&!C.isDeleting&&e.jsxs("div",{className:"absolute top-10 right-3 rounded-lg shadow-lg py-1 z-50 min-w-[180px]",style:{backgroundColor:o.colors.surface,border:`1px solid ${o.colors.border}`},children:[e.jsxs("button",{onClick:P=>{P.stopPropagation(),a(S.key),l(null)},className:"flex items-center gap-2 px-3 py-2 text-sm w-full text-left transition-colors hover:opacity-80",style:{color:o.colors.textSecondary,backgroundColor:"transparent"},onMouseEnter:P=>P.currentTarget.style.backgroundColor=o.colors.borderLight,onMouseLeave:P=>P.currentTarget.style.backgroundColor="transparent",children:[e.jsx(Kt,{className:"w-4 h-4"}),"Move to category"]}),S.category!=="completed"&&e.jsxs("button",{onClick:P=>j(S.key,P),className:"flex items-center gap-2 px-3 py-2 text-sm text-green-600 hover:bg-green-50 w-full text-left",children:[e.jsx(me,{className:"w-4 h-4"}),"Mark as completed"]}),e.jsxs("button",{onClick:P=>w(S.key,P),className:"flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50 w-full text-left",children:[e.jsx(lt,{className:"w-4 h-4"}),"Remove from library"]})]}),C.isDeleting&&e.jsx("div",{className:"absolute inset-0 bg-red-500 flex items-center justify-end pr-4",children:e.jsxs("div",{className:"flex gap-2",children:["              ",e.jsx("button",{onClick:G,className:"px-3 py-1 text-xs text-red-500 rounded",style:{backgroundColor:o.colors.surface},children:"Cancel"}),e.jsx("button",{onClick:M,className:"px-3 py-1 text-xs bg-red-700 text-white rounded",children:"Delete"})]})})]},S.key)},A=(S,T)=>T.length===0?null:e.jsxs("div",{className:"mb-8",children:["        ",e.jsxs("h2",{className:"font-serif text-lg font-medium mb-4 flex items-center gap-2",style:{color:o.colors.textPrimary},children:[S,e.jsxs("span",{className:"text-sm font-normal",style:{color:o.colors.textSecondary},children:["(",T.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:T.map(p)})]});return e.jsx(Se,{children:e.jsxs("div",{className:"max-w-md mx-auto min-h-screen",children:[e.jsx("header",{className:"p-4 border-b",style:{backgroundColor:o.colors.background,borderColor:o.colors.border},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>i("/"),className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:o.colors.surfaceSecondary},children:e.jsx(Z,{className:"w-5 h-5",style:{color:o.colors.textSecondary}})}),e.jsx("h1",{className:"font-serif text-xl font-medium",style:{color:o.colors.textPrimary},children:"My Library"})]})}),e.jsx("main",{className:"p-4",children:v.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(q,{className:"w-16 h-16 mx-auto mb-4",style:{color:o.colors.textSecondary}}),"            ",e.jsx("h2",{className:"font-serif text-lg font-medium mb-2",style:{color:o.colors.textPrimary},children:"No books yet"}),e.jsx("p",{className:"text-sm mb-6",style:{color:o.colors.textSecondary},children:"Start building your library by searching for books to read"}),e.jsx("button",{onClick:()=>i("/search"),className:"px-6 py-3 rounded-xl font-medium text-white",style:{backgroundColor:o.colors.secondary},children:"Find Books"})]}):e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("p",{className:"text-sm",style:{color:o.colors.textSecondary},children:[v.length," book",v.length!==1?"s":""," in your library"]})}),(()=>{const{currentlyReading:S,completed:T,wantToRead:B}=N();return e.jsxs(e.Fragment,{children:[A("Currently Reading",S),A("Want to Read",B),A("Completed",T)]})})()]})}),h&&e.jsxs("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:["          ",e.jsxs("div",{className:"rounded-xl p-6 w-full max-w-sm",style:{backgroundColor:o.colors.surface},children:[e.jsx("h3",{className:"font-serif text-lg font-medium mb-4",style:{color:o.colors.textPrimary},children:"Move Book"}),e.jsx("p",{className:"text-sm mb-6",style:{color:o.colors.textSecondary},children:"Choose a new category:"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>g(h,"want-to-read"),className:"w-full p-3 rounded-lg text-left transition-colors hover:opacity-80",style:{backgroundColor:o.colors.borderLight},children:[e.jsx("div",{className:"font-medium",style:{color:o.colors.textPrimary},children:"Want to Read"}),e.jsx("div",{className:"text-xs",style:{color:o.colors.textSecondary},children:"Books you plan to read"})]}),e.jsxs("button",{onClick:()=>g(h,"currently-reading"),className:"w-full p-3 rounded-lg text-left transition-colors hover:opacity-80",style:{backgroundColor:o.colors.borderLight},children:[e.jsx("div",{className:"font-medium",style:{color:o.colors.textPrimary},children:"Currently Reading"}),e.jsx("div",{className:"text-xs",style:{color:o.colors.textSecondary},children:"Books you're actively reading"})]}),e.jsxs("button",{onClick:()=>g(h,"completed"),className:"w-full p-3 bg-green-50 rounded-lg text-left hover:bg-green-100 transition-colors",children:[e.jsx("div",{className:"font-medium",style:{color:o.colors.textPrimary},children:"Completed"}),e.jsx("div",{className:"text-xs text-green-600",children:"Books you've finished"})]})]}),e.jsx("button",{onClick:()=>a(null),className:"w-full mt-4 py-2 text-sm transition-colors hover:opacity-80",style:{color:o.colors.textSecondary},children:"Cancel"}),"          "]})]}),"      ",e.jsx(ge,{isOpen:s.isOpen,onClose:s.close,onConfirm:s.onConfirm||void 0,title:s.config.title,message:s.config.message,type:s.config.type,confirmText:s.config.confirmText,cancelText:s.config.cancelText})]})})},Qs=()=>{const i=z(),{books:t}=oe(),{pet:c}=ie(),{theme:o}=$(),s=ct(),r=dt(),l=Ie(),h=f=>{const v=Math.floor(f/60),m=f%60;return v>0?`${v}h ${m}m`:`${m}m`},a=()=>{if(l.length===0)return 0;const f=l.reduce((v,m)=>v+(m.duration||0),0);return Math.round(f/l.length)},u=(()=>{const f=new Date,v=new Date(f.getFullYear(),f.getMonth(),1),m=l.filter(j=>new Date(j.startTime)>=v),w=m.reduce((j,x)=>j+(x.duration||0),0),g=m.reduce((j,x)=>j+((x.endPage||0)-(x.startPage||0)),0);return{time:w,pages:g,sessions:m.length}})(),n=({icon:f,title:v,value:m,subtitle:w})=>e.jsxs("div",{className:"rounded-xl shadow-sm p-4",style:{backgroundColor:o.colors.surface},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:o.colors.borderLight},children:e.jsx(f,{className:"w-4 h-4",style:{color:o.colors.textSecondary}})}),e.jsx("span",{className:"text-sm font-medium",style:{color:o.colors.textSecondary},children:v})]}),e.jsx("p",{className:"text-2xl font-serif font-medium mb-1",style:{color:o.colors.textPrimary},children:m}),w&&e.jsx("p",{className:"text-xs",style:{color:o.colors.textSecondary},children:w})]});return e.jsxs("div",{className:"max-w-md mx-auto min-h-screen",style:{backgroundColor:o.colors.background},children:[e.jsx("header",{className:"p-4",style:{backgroundColor:o.colors.background,borderBottom:`1px solid ${o.colors.border}`},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>i("/"),className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:o.colors.borderLight},children:e.jsx(Z,{className:"w-5 h-5",style:{color:o.colors.textSecondary}})}),e.jsx("h1",{className:"font-serif text-xl font-medium",style:{color:o.colors.textPrimary},children:"Reading Statistics"})]})}),"      ",e.jsxs("main",{className:"p-4 space-y-6",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"font-serif text-lg font-medium mb-3",style:{color:o.colors.textPrimary},children:"Overview"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(n,{icon:q,title:"Books Read",value:s.totalBooksRead.toString(),subtitle:"this year"}),e.jsx(n,{icon:le,title:"Total Time",value:h(s.totalReadingTime),subtitle:"all time"}),e.jsx(n,{icon:Ae,title:"Pages Read",value:s.totalPagesRead.toString(),subtitle:"all time"}),e.jsx(n,{icon:Le,title:"Current Streak",value:`${r.currentStreak} days`,subtitle:`longest: ${r.longestStreak} days`})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"font-serif text-lg font-medium mb-3",style:{color:o.colors.textPrimary},children:"This Month"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:e.jsxs("div",{className:"rounded-xl shadow-sm p-4",style:{backgroundColor:o.colors.surface},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Pe,{className:"w-5 h-5",style:{color:o.colors.textSecondary}}),e.jsx("span",{className:"font-medium",style:{color:o.colors.textPrimary},children:"Monthly Progress"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-serif font-medium",style:{color:o.colors.textPrimary},children:u.sessions}),e.jsx("p",{className:"text-xs",style:{color:o.colors.textSecondary},children:"sessions"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-serif font-medium",style:{color:o.colors.textPrimary},children:h(u.time)}),e.jsx("p",{className:"text-xs",style:{color:o.colors.textSecondary},children:"reading time"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-serif font-medium",style:{color:o.colors.textPrimary},children:u.pages}),e.jsx("p",{className:"text-xs",style:{color:o.colors.textSecondary},children:"pages"})]})]})]})})]}),"        ",e.jsxs("section",{children:[e.jsx("h2",{className:"font-serif text-lg font-medium mb-3",style:{color:o.colors.textPrimary},children:"Recent Activity"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(n,{icon:le,title:"Today",value:h(s.readingTimeToday)}),e.jsx(n,{icon:Pe,title:"This Week",value:h(s.readingTimeThisWeek)}),e.jsx(n,{icon:Ae,title:"Average Session",value:h(a())}),e.jsx(n,{icon:q,title:"Books in Library",value:t.length.toString()})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"font-serif text-lg font-medium mb-3",style:{color:o.colors.textPrimary},children:"Reading Companion"}),e.jsxs("div",{className:"rounded-xl shadow-sm p-4",style:{backgroundColor:o.colors.surface},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(qt,{className:"w-5 h-5",style:{color:o.colors.textSecondary}}),e.jsxs("span",{className:"font-medium",style:{color:o.colors.textPrimary},children:[c.name,"'s Progress"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-serif font-medium",style:{color:o.colors.textPrimary},children:c.level}),e.jsx("p",{className:"text-xs",style:{color:o.colors.textSecondary},children:"level"})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-lg font-serif font-medium",style:{color:o.colors.textPrimary},children:[c.happiness,"%"]}),e.jsx("p",{className:"text-xs",style:{color:o.colors.textSecondary},children:"happiness"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-serif font-medium",style:{color:o.colors.textPrimary},children:c.experience}),e.jsx("p",{className:"text-xs",style:{color:o.colors.textSecondary},children:"experience"})]})]})]})]}),l.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Le,{className:"w-16 h-16 mx-auto mb-4",style:{color:o.colors.textSecondary}}),e.jsx("h3",{className:"font-serif text-lg font-medium mb-2",style:{color:o.colors.textPrimary},children:"Start tracking your reading"}),e.jsx("p",{className:"text-sm mb-6",style:{color:o.colors.textSecondary},children:"Begin a reading session to see your statistics here"}),e.jsx("button",{onClick:()=>i("/search"),className:"px-6 py-3 rounded-xl font-medium text-white",style:{backgroundColor:o.colors.secondary},children:"Find a Book to Read"})]})]})]})},Xs=()=>{const i=z(),{notes:t,books:c,deleteNote:o}=oe(),{theme:s}=$(),r=ye(),l=d=>{r.showConfirm("Delete Note","Are you sure you want to delete this note? This action cannot be undone.",()=>{o(d)},{confirmText:"Delete",cancelText:"Cancel"})},h=d=>{const u=c.find(n=>n.key===d);return u?u.title:"Unknown Book"},a=d=>new Date(d).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return e.jsxs("div",{className:"max-w-md mx-auto min-h-screen",style:{backgroundColor:s.colors.background},children:[e.jsx("header",{className:"p-4",style:{backgroundColor:s.colors.background,borderBottom:`1px solid ${s.colors.border}`},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>i(-1),className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:s.colors.borderLight},children:e.jsx(Z,{className:"w-5 h-5",style:{color:s.colors.textSecondary}})}),e.jsx("h1",{className:"font-serif text-xl font-medium",style:{color:s.colors.textPrimary},children:"My Notes"})]}),e.jsx("button",{onClick:()=>i("/notes/add"),className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:s.colors.secondary},children:e.jsx(at,{className:"w-5 h-5 text-white"})})]})}),"      ",e.jsx("main",{className:"p-4",children:t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ae,{className:"w-16 h-16 mx-auto mb-4",style:{color:s.colors.textSecondary}}),e.jsx("h2",{className:"font-serif text-lg font-medium mb-2",style:{color:s.colors.textPrimary},children:"No notes yet"}),e.jsx("p",{className:"text-sm mb-6",style:{color:s.colors.textSecondary},children:"Start taking notes while reading to remember important thoughts and insights"}),e.jsx("button",{onClick:()=>i("/notes/add"),className:"px-6 py-3 rounded-xl font-medium text-white",style:{backgroundColor:s.colors.secondary},children:"Add Your First Note"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("p",{className:"text-sm",style:{color:s.colors.textSecondary},children:[t.length," note",t.length!==1?"s":""]})}),"            ",t.map(d=>e.jsxs("div",{className:"rounded-xl shadow-sm p-4",style:{backgroundColor:s.colors.surface},children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(q,{className:"w-4 h-4",style:{color:s.colors.textSecondary}}),e.jsx("span",{className:"text-sm font-medium truncate",style:{color:s.colors.textPrimary},children:h(d.bookId)})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs",style:{color:s.colors.textSecondary},children:[d.chapter&&e.jsxs("span",{children:["Chapter: ",d.chapter]}),d.page&&e.jsxs("span",{children:["Page ",d.page]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Pe,{className:"w-3 h-3"}),e.jsx("span",{children:a(d.createdAt)})]})]})]}),e.jsx("button",{onClick:()=>l(d.id),className:"p-1 text-red-500 hover:bg-red-50 rounded",children:e.jsx(lt,{className:"w-4 h-4"})})]}),"                ",e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"leading-relaxed whitespace-pre-wrap",style:{color:s.colors.textPrimary},children:d.content})})]},d.id))]})}),e.jsx(ge,{isOpen:r.isOpen,onClose:r.close,onConfirm:r.onConfirm||void 0,title:r.config.title,message:r.config.message,type:r.config.type,confirmText:r.config.confirmText,cancelText:r.config.cancelText})]})},Zs=()=>{const i=z(),[t]=tt(),{books:c,currentBook:o,addNote:s,notes:r,updateNote:l}=oe(),{theme:h}=$(),a=ye(),d=t.get("edit"),[u,n]=E.useState((o==null?void 0:o.key)||""),[f,v]=E.useState(""),[m,w]=E.useState(""),[g,j]=E.useState("");E.useEffect(()=>{var y;if(d){const b=r.find(N=>N.id===d);b&&(n(b.bookId),v(b.content),w(((y=b.page)==null?void 0:y.toString())||""),j(b.chapter||""))}},[d,r]);const x=()=>{var b;if(!f.trim()){a.showAlert("Content Required","Please add some content to your note before saving.","alert");return}const y={id:d||he(),bookId:u,content:f.trim(),page:m?parseInt(m):void 0,chapter:g.trim()||void 0,createdAt:d?((b=r.find(N=>N.id===d))==null?void 0:b.createdAt)||new Date().toISOString():new Date().toISOString(),updatedAt:new Date().toISOString()};d&&l?l(y):s(y),a.showAlert("Note Saved","Your note has been saved successfully!","success"),setTimeout(()=>{i("/notes")},1500)},k=()=>{f.trim()||g.trim()||m.trim()?a.showConfirm("Discard Note","You have unsaved changes. Are you sure you want to go back?",()=>{i(-1)},{confirmText:"Discard",cancelText:"Keep Editing"}):i(-1)};return e.jsxs("div",{className:"max-w-md mx-auto min-h-screen",style:{backgroundColor:h.colors.background},children:[e.jsx("header",{className:"p-4 border-b",style:{backgroundColor:h.colors.background,borderColor:h.colors.border},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:k,className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:h.colors.surface},children:e.jsx(Z,{className:"w-5 h-5",style:{color:h.colors.textSecondary}})}),e.jsx("h1",{className:"font-serif text-xl font-medium",style:{color:h.colors.textPrimary},children:d?"Edit Note":"Add Note"})]}),e.jsxs("button",{onClick:x,className:"flex items-center gap-2 bg-[#8B7355] text-white px-4 py-2 rounded-lg text-sm font-medium",children:[e.jsx(zt,{className:"w-4 h-4"}),"Save"]})]})}),e.jsxs("main",{className:"p-4 space-y-6",children:["        ",e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:h.colors.textPrimary},children:"Select Book"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:u,onChange:y=>n(y.target.value),className:"w-full p-3 pr-10 border rounded-xl focus:outline-none focus:ring-2 focus:ring-[#8B7355] appearance-none",style:{backgroundColor:h.colors.surface,borderColor:h.colors.border,color:h.colors.textPrimary},children:[e.jsx("option",{value:"",children:"Choose a book..."}),c.map(y=>e.jsx("option",{value:y.key,children:y.title},y.key))]}),e.jsx(q,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 pointer-events-none",style:{color:h.colors.textSecondary}})]})]}),"        ",e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:h.colors.textPrimary},children:"Chapter (optional)"}),e.jsx("input",{type:"text",value:g,onChange:y=>j(y.target.value),placeholder:"e.g., Chapter 5",className:"w-full p-3 border rounded-xl focus:outline-none focus:ring-2 focus:ring-[#8B7355]",style:{backgroundColor:h.colors.surface,borderColor:h.colors.border,color:h.colors.textPrimary}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:h.colors.textPrimary},children:"Page (optional)"}),e.jsx("input",{type:"number",value:m,onChange:y=>w(y.target.value),placeholder:"Page number",className:"w-full p-3 border rounded-xl focus:outline-none focus:ring-2 focus:ring-[#8B7355]",style:{backgroundColor:h.colors.surface,borderColor:h.colors.border,color:h.colors.textPrimary}})]})]}),"        ",e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:h.colors.textPrimary},children:"Your Note"}),e.jsx("textarea",{value:f,onChange:y=>v(y.target.value),placeholder:"Write your thoughts, insights, or reflections about this part of the book...",rows:8,className:"w-full p-3 border rounded-xl focus:outline-none focus:ring-2 focus:ring-[#8B7355] resize-none",style:{backgroundColor:h.colors.surface,borderColor:h.colors.border,color:h.colors.textPrimary}}),e.jsxs("p",{className:"text-xs mt-2",style:{color:h.colors.textSecondary},children:[f.length,"/500 characters"]})]}),e.jsxs("div",{className:"rounded-xl p-4",style:{backgroundColor:h.colors.surface},children:[e.jsx("h3",{className:"font-medium mb-2",style:{color:h.colors.textPrimary},children:"💡 Note-taking tips:"}),e.jsxs("ul",{className:"text-sm space-y-1",style:{color:h.colors.textSecondary},children:[e.jsx("li",{children:"• Write down key insights or quotes that resonate with you"}),e.jsx("li",{children:"• Note questions or thoughts the reading sparked"}),e.jsx("li",{children:"• Record connections to other books or personal experiences"}),e.jsx("li",{children:"• Include your emotional reactions or reflections"})]})]})]}),e.jsx(ge,{isOpen:a.isOpen,onClose:a.close,onConfirm:a.onConfirm||void 0,title:a.config.title,message:a.config.message,type:a.config.type,confirmText:a.config.confirmText,cancelText:a.config.cancelText})]})},er=()=>{const i=z(),{theme:t}=$(),{pet:c,petStats:o,feedPet:s,playWithPet:r,petSleep:l,getPetMood:h,getPetEvolutionRequirement:a,resetPet:d,updatePetName:u,getPetEmoji:n,canEvolve:f,evolvePet:v}=ie(),[m,w]=E.useState(!1),[g,j]=E.useState(c.name),[x,k]=E.useState(!1),y=C=>C>70?"bg-green-500":C>40?"bg-yellow-500":"bg-red-500",b=C=>`${Math.max(0,Math.min(100,C))}%`,N=()=>{g.trim()&&(u(g.trim()),w(!1))},p=()=>{d(),k(!1)},A=C=>({"first-book":"📖","book-lover":"📚",bookworm:"🐛","speed-reader":"⚡","night-owl":"🦉","early-bird":"🐦"})[C]||"🏆",S=C=>({"first-book":"Read your first book","book-lover":"Read 10 books",bookworm:"Read 50 books","speed-reader":"Read for 100+ minutes in a day","night-owl":"Read after midnight","early-bird":"Read before 6 AM"})[C]||"Special achievement",T=C=>{const _=Math.floor(C/60),I=C%60;return _>0?`${_}h ${I}m`:`${I}m`},B=a();return e.jsxs("div",{className:"max-w-md mx-auto min-h-screen",style:{backgroundColor:t.colors.background},children:[e.jsx("header",{className:"p-4",style:{backgroundColor:t.colors.background,borderBottom:`1px solid ${t.colors.border}`},children:e.jsxs("div",{className:"flex items-center gap-3",children:["          ",e.jsx("button",{onClick:()=>i(-1),className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:t.colors.borderLight},children:e.jsx(Z,{className:"w-5 h-5",style:{color:t.colors.textSecondary}})}),e.jsx("h1",{className:"font-serif text-xl font-medium",style:{color:t.colors.textPrimary},children:"My Reading Pet"})]})}),e.jsxs("main",{className:"p-4 space-y-6",children:["        ",e.jsxs("div",{className:"rounded-xl shadow-sm p-6 text-center",style:{backgroundColor:t.colors.surface},children:[e.jsx("div",{className:"text-8xl mb-4",children:n()}),e.jsxs("div",{className:"mb-4",children:[m?e.jsx("div",{className:"flex items-center justify-center gap-2",children:e.jsx("input",{type:"text",value:g,onChange:C=>j(C.target.value),className:"text-2xl font-serif font-medium rounded px-3 py-1 border text-center",style:{backgroundColor:t.colors.borderLight,color:t.colors.textPrimary,borderColor:t.colors.border},onBlur:N,onKeyPress:C=>C.key==="Enter"&&N(),autoFocus:!0})}):e.jsxs("div",{className:"flex items-center justify-center gap-2",children:["                ",e.jsx("h2",{className:"text-2xl font-serif font-medium",style:{color:t.colors.textPrimary},children:c.name}),e.jsx("button",{onClick:()=>w(!0),className:"p-1 rounded transition-colors hover:opacity-80",style:{color:t.colors.textSecondary,backgroundColor:t.colors.borderLight},children:e.jsx(ae,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-lg mb-2",style:{color:t.colors.textSecondary},children:[e.jsxs("span",{children:["Level ",c.level]}),e.jsx("span",{children:"•"}),e.jsx("span",{className:"capitalize",children:c.evolutionStage})]}),f()&&e.jsxs("button",{onClick:v,className:"bg-gradient-to-r from-[#D2691E] to-[#FF8C00] text-white px-6 py-2 rounded-full font-medium mb-2",children:["✨ Evolve to ",B.stage,"!"]})]}),"          ",e.jsx("p",{className:"mb-4",style:{color:t.colors.textPrimary},children:h()}),e.jsx("div",{className:"mb-4 p-3 rounded-lg",style:{backgroundColor:t.colors.borderLight},children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold mb-1",style:{color:t.colors.primary},children:["💰 ",c.points]}),e.jsx("p",{className:"text-sm",style:{color:t.colors.textSecondary},children:"Care Points (Earned from reading)"})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",style:{color:t.colors.textSecondary},children:[e.jsx("span",{children:"Experience"}),e.jsxs("span",{children:[c.experience,"/",c.experienceToNext]})]}),e.jsx("div",{className:"h-3 rounded-full overflow-hidden",style:{backgroundColor:t.colors.borderLight},children:e.jsx("div",{className:"h-full bg-gradient-to-r from-[#D2691E] to-[#FF8C00] rounded-full transition-all duration-300",style:{width:`${c.experience/c.experienceToNext*100}%`}})})]}),"          ",e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("button",{onClick:s,disabled:c.points<3,className:`py-3 px-4 rounded-xl font-medium transition-colors flex flex-col items-center gap-1 ${c.points>=3?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[e.jsx(Me,{className:"w-6 h-6"}),e.jsx("span",{className:"text-sm",children:"Feed"}),e.jsx("span",{className:"text-xs",children:"💰 3 pts"})]}),e.jsxs("button",{onClick:r,disabled:c.points<5,className:`py-3 px-4 rounded-xl font-medium transition-colors flex flex-col items-center gap-1 ${c.points>=5?"bg-blue-100 text-blue-700 hover:bg-blue-200":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[e.jsx(Te,{className:"w-6 h-6"}),e.jsx("span",{className:"text-sm",children:"Play"}),e.jsx("span",{className:"text-xs",children:"💰 5 pts"})]}),e.jsxs("button",{onClick:l,className:"py-3 px-4 bg-purple-100 text-purple-700 rounded-xl font-medium hover:bg-purple-200 transition-colors flex flex-col items-center gap-1",children:[e.jsx(Je,{className:"w-6 h-6"}),e.jsx("span",{className:"text-sm",children:"Sleep"}),e.jsx("span",{className:"text-xs",children:"Free"})]})]})]}),"        ",e.jsxs("div",{className:"rounded-xl shadow-sm p-4",style:{backgroundColor:t.colors.surface},children:[e.jsx("h3",{className:"font-serif text-lg font-medium mb-4",style:{color:t.colors.textPrimary},children:"Pet Stats"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{children:"Happiness"})]}),"                ",e.jsxs("span",{children:[c.happiness,"/100"]})]}),e.jsx("div",{className:"h-3 rounded-full overflow-hidden",style:{backgroundColor:t.colors.borderLight},children:e.jsx("div",{className:`h-full ${y(c.happiness)} rounded-full transition-all duration-300`,style:{width:b(c.happiness)}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Hunger"})]}),"                ",e.jsxs("span",{children:[c.hunger,"/100"]})]}),e.jsx("div",{className:"h-3 rounded-full overflow-hidden",style:{backgroundColor:t.colors.borderLight},children:e.jsx("div",{className:`h-full ${y(c.hunger)} rounded-full transition-all duration-300`,style:{width:b(c.hunger)}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wt,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{children:"Energy"})]}),"                ",e.jsxs("span",{children:[c.energy,"/100"]})]}),e.jsx("div",{className:"h-3 rounded-full overflow-hidden",style:{backgroundColor:t.colors.borderLight},children:e.jsx("div",{className:`h-full ${y(c.energy)} rounded-full transition-all duration-300`,style:{width:b(c.energy)}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{children:"Health"})]}),e.jsxs("span",{children:[c.health,"/100"]})]}),e.jsx("div",{className:"h-3 bg-[#F0EDE8] rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${y(c.health)} rounded-full transition-all duration-300`,style:{width:b(c.health)}})})]})]})]}),"        ",e.jsxs("div",{className:"rounded-xl shadow-sm p-4",style:{backgroundColor:t.colors.surface},children:[e.jsx("h3",{className:"font-serif text-lg font-medium mb-4",style:{color:t.colors.textPrimary},children:"Reading Progress"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:["            ",e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",style:{color:t.colors.primary},children:c.totalBooksRead}),e.jsx("div",{className:"text-sm",style:{color:t.colors.textSecondary},children:"Books Read"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",style:{color:t.colors.primary},children:T(c.totalReadingTime)}),e.jsx("div",{className:"text-sm",style:{color:t.colors.textSecondary},children:"Total Time"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",style:{color:t.colors.primary},children:o.booksReadToday}),e.jsx("div",{className:"text-sm",style:{color:t.colors.textSecondary},children:"Today's Books"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",style:{color:t.colors.primary},children:T(o.readingTimeToday)}),e.jsx("div",{className:"text-sm",style:{color:t.colors.textSecondary},children:"Today's Time"})]})]})]}),"        ",c.badges.length>0&&e.jsxs("div",{className:"rounded-xl shadow-sm p-4",style:{backgroundColor:t.colors.surface},children:[e.jsx("h3",{className:"font-serif text-lg font-medium mb-4",style:{color:t.colors.textPrimary},children:"Achievements"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:c.badges.map((C,_)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg",style:{backgroundColor:t.colors.borderLight},children:[e.jsx("div",{className:"text-2xl",children:A(C)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium capitalize text-sm",style:{color:t.colors.textPrimary},children:C.replace("-"," ")}),e.jsx("div",{className:"text-xs",style:{color:t.colors.textSecondary},children:S(C)})]})]},_))})]}),e.jsxs("div",{className:"rounded-xl shadow-sm p-4",style:{backgroundColor:t.colors.surface},children:[e.jsx("h3",{className:"font-serif text-lg font-medium mb-2",style:{color:t.colors.textPrimary},children:"Pet Management"}),e.jsx("p",{className:"text-sm mb-4",style:{color:t.colors.textSecondary},children:"Reset your pet to start over with a new companion. This action cannot be undone."}),x?e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Are you sure you want to reset your pet?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:p,className:"px-4 py-2 bg-red-600 text-white rounded-lg text-sm font-medium",children:"Yes, Reset"}),e.jsx("button",{onClick:()=>k(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm font-medium",children:"Cancel"})]})]}):e.jsxs("button",{onClick:()=>k(!0),className:"flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[e.jsx(Vt,{className:"w-4 h-4"}),"Reset Pet"]})]})]})]})},tr=({message:i,type:t,onClose:c})=>{const o={success:"bg-green-500",error:"bg-red-500",info:"bg-blue-500"}[t],s={success:"✓",error:"✕",info:"ℹ"}[t];return jt.useEffect(()=>{const r=setTimeout(()=>{c()},3e3);return()=>clearTimeout(r)},[c]),e.jsxs("div",{className:`fixed top-4 right-4 ${o} text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-2 z-50 animate-slide-in`,children:[e.jsx("span",{className:"text-lg",children:s}),e.jsx("span",{children:i}),e.jsx("button",{onClick:c,className:"ml-2 text-white hover:text-gray-200",children:"✕"})]})},et=({className:i="",showLabel:t=!0})=>{const{theme:c,toggleTheme:o}=$();return e.jsxs("div",{className:`flex items-center gap-3 ${i}`,children:[t&&e.jsx("span",{className:"text-sm font-medium",style:{color:c.colors.textPrimary},children:"Theme"}),e.jsx("button",{onClick:o,className:"flex items-center gap-2 px-3 py-2 rounded-lg transition-all duration-200 hover:scale-105",style:{backgroundColor:c.colors.surface,border:`1px solid ${c.colors.border}`,color:c.colors.textPrimary},"aria-label":`Switch to ${c.isDark?"light":"dark"} mode`,children:e.jsx("div",{className:"flex items-center gap-2",children:c.isDark?e.jsxs(e.Fragment,{children:[e.jsx(ot,{size:16,style:{color:c.colors.warning}}),t&&e.jsx("span",{className:"text-sm",children:"Light"})]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{size:16,style:{color:c.colors.textSecondary}}),t&&e.jsx("span",{className:"text-sm",children:"Dark"})]})})})]})},sr=()=>{var b;const{user:i,signOut:t,updateProfile:c}=xe(),{theme:o}=$(),s=z(),[r,l]=E.useState({displayName:"",bio:"",favoriteGenres:[],readingGoal:12}),[h,a]=E.useState(!1),[d,u]=E.useState(!1),[n,f]=E.useState(""),[v,m]=E.useState(null),w=(b=i==null?void 0:i.id)==null?void 0:b.startsWith("guest-");E.useEffect(()=>{i&&g()},[i]),E.useEffect(()=>{i!=null&&i.profile&&!w&&l({displayName:i.profile.displayName||"",bio:i.profile.bio||"",favoriteGenres:i.profile.favoriteGenres||[],readingGoal:i.profile.readingGoal||12,joinedDate:i.profile.joinedDate||i.createdAt})},[i==null?void 0:i.profile,w]);const g=async()=>{console.log("ProfilePage: Loading profile for user:",i==null?void 0:i.id,"isGuest:",w);try{if(w){const p=se.getGuestProfile();if(console.log("ProfilePage: Loaded guest profile from localStorage:",p),p){l({displayName:p.displayName||"Guest User",bio:p.bio||"Browsing as a guest",favoriteGenres:p.favoriteGenres||[],readingGoal:p.readingGoal||12,joinedDate:p.joinedDate||(i==null?void 0:i.createdAt)});return}i!=null&&i.profile&&(console.log("ProfilePage: Using fallback guest profile from user object"),l({displayName:i.profile.displayName||"Guest User",bio:i.profile.bio||"Browsing as a guest",favoriteGenres:i.profile.favoriteGenres||[],readingGoal:i.profile.readingGoal||12,joinedDate:i.createdAt}));return}console.log("ProfilePage: Loading profile from Gun service");const N=await Y.getProfile();if(console.log("ProfilePage: Gun service profile result:",N),N.success&&N.profile){const p={displayName:N.profile.displayName||"",bio:N.profile.bio||"",favoriteGenres:N.profile.favoriteGenres||[],readingGoal:N.profile.readingGoal||12,joinedDate:N.profile.joinedDate||N.profile.lastUpdated};console.log("ProfilePage: Setting profile to:",p),l(p)}else console.log("ProfilePage: No profile found or error loading profile")}catch(N){console.error("Error loading profile:",N)}},j=async()=>{if(i){console.log("ProfilePage: Saving profile:",r),u(!0);try{if(w){se.setGuestProfile(r),a(!1),console.log("Guest profile saved to localStorage:",r),m({message:"Profile saved successfully!",type:"success"});return}console.log("ProfilePage: Calling updateProfile with:",r);const N=await c(r);console.log("ProfilePage: updateProfile result:",N),N.success?(a(!1),console.log("Profile saved successfully"),m({message:"Profile saved successfully!",type:"success"}),console.log("ProfilePage: Reloading profile after save"),await g()):(console.error("Error saving profile:",N.error),m({message:`Failed to save profile: ${N.error||"Unknown error"}`,type:"error"}))}catch(N){console.error("Error saving profile:",N),m({message:"Failed to save profile. Please try again.",type:"error"})}finally{u(!1)}}},x=()=>{n.trim()&&!r.favoriteGenres.includes(n.trim())&&(l(N=>({...N,favoriteGenres:[...N.favoriteGenres,n.trim()]})),f(""))},k=N=>{l(p=>({...p,favoriteGenres:p.favoriteGenres.filter(A=>A!==N)}))},y=()=>{t()};return i?e.jsxs(Se,{children:[e.jsxs("div",{className:"min-h-screen py-8 transition-colors duration-200",style:{backgroundColor:o.colors.background},children:[w&&e.jsx("div",{className:"max-w-4xl mx-auto px-4 mb-4",children:e.jsx("div",{className:"border px-4 py-3 rounded-lg",style:{backgroundColor:o.colors.wantToRead,borderColor:o.colors.border,color:o.colors.wantToReadText},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"                ",e.jsx("span",{className:"font-medium",children:"Guest Mode"}),e.jsx("span",{className:"ml-2",children:"- Profile changes saved locally. Create an account to sync across devices!"})]})})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4",children:e.jsxs("div",{className:"rounded-2xl shadow-xl overflow-hidden transition-colors duration-200",style:{backgroundColor:o.colors.surface},children:["            ",e.jsxs("div",{className:"px-8 py-12 text-white relative",style:{background:`linear-gradient(to right, ${o.colors.primary}, ${o.colors.primaryLight})`},children:[e.jsx("button",{onClick:()=>s(-1),className:"absolute top-4 left-4 p-2 rounded-full bg-white/20 hover:bg-white/30 transition-colors",title:"Go back",children:e.jsx(Z,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[e.jsx("div",{className:"w-24 h-24 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-12 h-12 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})}),"                ",e.jsxs("div",{className:"text-center md:text-left flex-1",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:r.displayName||(i==null?void 0:i.username)||"Book Lover"}),e.jsx("p",{className:"text-amber-100 text-lg",children:r.bio||"A passionate reader exploring new worlds through books"}),r.joinedDate&&e.jsxs("p",{className:"text-amber-200 text-sm mt-2",children:["Member since ",new Date(r.joinedDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>a(!h),className:"px-6 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors duration-200 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),h?"Cancel":"Edit Profile"]}),e.jsxs("button",{onClick:y,className:"px-6 py-2 bg-red-500/80 hover:bg-red-600/80 rounded-lg transition-colors duration-200 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})]})]})]}),e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-amber-800 mb-4",children:"Personal Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Display Name"}),h?e.jsx("input",{type:"text",value:r.displayName,onChange:N=>l(p=>({...p,displayName:N.target.value})),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:border-transparent input-field",style:{backgroundColor:o.colors.surface,borderColor:o.colors.border,color:o.colors.textPrimary},placeholder:"Your display name"}):e.jsx("p",{className:"text-gray-900 px-4 py-3 bg-amber-50 rounded-lg",children:r.displayName||"Not set"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Bio"}),h?e.jsx("textarea",{value:r.bio,onChange:N=>l(p=>({...p,bio:N.target.value})),rows:4,className:"w-full px-4 py-3 border border-amber-200 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent resize-none",placeholder:"Tell us about yourself and your reading interests..."}):e.jsx("p",{className:"text-gray-900 px-4 py-3 bg-amber-50 rounded-lg min-h-[100px] whitespace-pre-wrap",children:r.bio||"No bio added yet"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Reading Goal (books per year)"}),h?e.jsx("input",{type:"number",min:"1",max:"365",value:r.readingGoal,onChange:N=>l(p=>({...p,readingGoal:parseInt(N.target.value)||12})),className:"w-full px-4 py-3 border border-amber-200 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent"}):e.jsxs("p",{className:"text-gray-900 px-4 py-3 bg-amber-50 rounded-lg",children:[r.readingGoal," books per year"]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-amber-800 mb-4",children:"Favorite Genres"}),h&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:n,onChange:N=>f(N.target.value),onKeyPress:N=>N.key==="Enter"&&x(),placeholder:"Add a genre...",className:"flex-1 px-4 py-2 border border-amber-200 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent"}),e.jsx("button",{onClick:x,className:"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors duration-200",children:"Add"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.favoriteGenres.map((N,p)=>e.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-amber-100 text-amber-800 rounded-full text-sm font-medium",children:[N,h&&e.jsx("button",{onClick:()=>k(N),className:"text-amber-600 hover:text-amber-800 transition-colors duration-200",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},p)),"                    ",r.favoriteGenres.length===0&&e.jsx("p",{className:"text-gray-500 italic",children:"No favorite genres added yet"})]}),e.jsxs("div",{className:"space-y-6 mt-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",style:{color:o.colors.primary},children:"App Settings"}),e.jsx("div",{className:"p-6 rounded-xl border",style:{backgroundColor:o.colors.surface,borderColor:o.colors.border},children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-1",style:{color:o.colors.textPrimary},children:"Appearance"}),e.jsx("p",{className:"text-sm",style:{color:o.colors.textSecondary},children:"Choose your preferred theme for the app"})]}),e.jsx(et,{})]})})})]}),"                  ",e.jsxs("div",{className:"mt-8 p-6 rounded-xl",style:{background:`linear-gradient(to right, ${o.colors.surfaceSecondary}, ${o.colors.surfaceElevated})`},children:[e.jsx("h3",{className:"text-lg font-bold mb-4",style:{color:o.colors.primary},children:"Reading Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",style:{color:o.colors.primary},children:"0"}),e.jsx("div",{className:"text-sm",style:{color:o.colors.textSecondary},children:"Books Read"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",style:{color:o.colors.primary},children:"0"}),e.jsx("div",{className:"text-sm",style:{color:o.colors.textSecondary},children:"Pages Read"})]})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",style:{color:o.colors.textPrimary},children:"Preferences"}),e.jsx("div",{className:"p-4 rounded-xl",style:{backgroundColor:o.colors.surface},children:e.jsx(et,{})})]})]})]}),h&&e.jsx("div",{className:"mt-8 flex justify-end",children:e.jsx("button",{onClick:j,disabled:d,className:"px-8 py-3 bg-amber-600 text-white rounded-lg hover:bg-amber-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200 flex items-center gap-2",children:d?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save Changes"]})})})]})]})})]}),v&&e.jsx(tr,{message:v.message,type:v.type,onClose:()=>m(null)})]}):e.jsx(Se,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-amber-50 to-orange-100 flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("h1",{className:"text-2xl font-bold text-amber-800 mb-4",children:"Please sign in to view your profile"})})})})},rr=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"app-titlebar hidden",children:e.jsxs("div",{className:"app-titlebar-content",children:[e.jsx("div",{className:"app-titlebar-icon",children:"📚"}),e.jsx("span",{children:"Bookish"})]})}),"      ",e.jsx(Es,{children:e.jsx(Ps,{children:e.jsx(Ss,{children:e.jsx(bs,{children:e.jsx(Nt,{basename:"/Bookish",children:e.jsx(Bs,{children:e.jsxs(St,{children:[e.jsx(W,{path:"/",element:e.jsx(Gs,{})}),e.jsx(W,{path:"/welcome",element:e.jsx(Ds,{})}),e.jsx(W,{path:"/search",element:e.jsx(Js,{})}),e.jsx(W,{path:"/library",element:e.jsx(Vs,{})}),e.jsx(W,{path:"/book",element:e.jsx($s,{})}),e.jsx(W,{path:"/reading",element:e.jsx(Ws,{})}),e.jsx(W,{path:"/notes",element:e.jsx(Xs,{})}),e.jsx(W,{path:"/notes/add",element:e.jsx(Zs,{})}),e.jsx(W,{path:"/pet",element:e.jsx(er,{})}),e.jsx(W,{path:"/stats",element:e.jsx(Qs,{})}),e.jsx(W,{path:"/profile",element:e.jsx(sr,{})})]})})})})})})})]});"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()});es.createRoot(document.getElementById("root")).render(e.jsx(E.StrictMode,{children:e.jsx(rr,{})}));
