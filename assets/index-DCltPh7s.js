const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/quagga.min-jt3L0bPw.js","assets/vendor-C_B3iYp5.js"])))=>i.map(i=>d[i]);
var lt=Object.defineProperty;var ct=(c,t,m)=>t in c?lt(c,t,{enumerable:!0,configurable:!0,writable:!0,value:m}):c[t]=m;var ne=(c,t,m)=>ct(c,typeof t!="symbol"?t+"":t,m);import{a as dt,b as ut,g as mt,c as ye,r as C,u as Y,d as ze,e as ht,B as xt,R as ft,f as K}from"./vendor-C_B3iYp5.js";import{r as gt,c as pt,a as yt}from"./gun-CJ6ok8hl.js";import{B as H,U as Ve,L as bt,E as vt,a as wt,A as Ce,T as Xe,P as te,H as we,b as fe,S as jt,c as je,d as Nt,e as St,C as se,f as kt,F as At,g as De,h as oe,i as Et,j as Bt,k as W,l as _e,m as Te,X as Ee,n as Fe,I as Ct,o as Dt,p as _t,q as Tt,r as ie,s as Ft,t as Qe,u as Pt,v as It,M as Rt,w as Ot,x as Ze,y as Pe,z as Ne,D as Ut,G as Gt,J as Ie,K as Re,Z as Mt,R as Lt}from"./icons-Dk7LfCst.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function m(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=m(r);fetch(r.href,s)}})();var be={exports:{}},ae={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oe;function Jt(){if(Oe)return ae;Oe=1;var c=dt(),t=Symbol.for("react.element"),m=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,r=c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function i(g,u,l){var a,d={},x=null,p=null;l!==void 0&&(x=""+l),u.key!==void 0&&(x=""+u.key),u.ref!==void 0&&(p=u.ref);for(a in u)n.call(u,a)&&!s.hasOwnProperty(a)&&(d[a]=u[a]);if(g&&g.defaultProps)for(a in u=g.defaultProps,u)d[a]===void 0&&(d[a]=u[a]);return{$$typeof:t,type:g,key:x,ref:p,props:d,_owner:r.current}}return ae.Fragment=m,ae.jsx=i,ae.jsxs=i,ae}var Ue;function $t(){return Ue||(Ue=1,be.exports=Jt()),be.exports}var e=$t(),me={},Ge;function Ht(){if(Ge)return me;Ge=1;var c=ut();return me.createRoot=c.createRoot,me.hydrateRoot=c.hydrateRoot,me}var Yt=Ht(),Kt=gt();const et=mt(Kt);var ge={exports:{}};ge.exports;var Me;function qt(){return Me||(Me=1,function(c){(function(){function t(n,r){return r?pt(n):n.slice?t[s(n)]:function(i,g){n(i={exports:{}}),t[s(g)]=i.exports};function s(i){return i.split("/").slice(-1).toString().replace(".js","")}}var m=c;t(function(n){typeof self<"u"&&(n.window=self),typeof window<"u"&&(n.window=window);var r=n.window||n,s,i=r.SEA||{};(i.window=n.window)&&(i.window.SEA=i);try{s+""!=typeof m&&(m.exports=i)}catch{}n.exports=i})(t,"./root"),t(function(n){var r=t("./root");try{r.window&&location.protocol.indexOf("s")<0&&location.host.indexOf("localhost")<0&&!/^127\.\d+\.\d+\.\d+$/.test(location.hostname)&&location.protocol.indexOf("file:")<0&&(console.warn("HTTPS needed for WebCrypto in SEA, redirecting..."),location.protocol="https:")}catch{}})(t,"./https"),t(function(n){var r;if(r+""==typeof btoa){if(r+""==typeof Buffer)try{ye.Buffer=t("buffer",1).Buffer}catch{console.log("Please `npm install buffer` or add it to your package.json !")}ye.btoa=function(s){return Buffer.from(s,"binary").toString("base64")},ye.atob=function(s){return Buffer.from(s,"base64").toString("binary")}}})(t,"./base64"),t(function(n){t("./base64");function r(){}Object.assign(r,{from:Array.from}),r.prototype=Object.create(Array.prototype),r.prototype.toString=function(s,i,g){s=s||"utf8",i=i||0;const u=this.length;if(s==="hex"){const l=new Uint8Array(this);return[...Array((g&&g+1||u)-i).keys()].map(a=>l[a+i].toString(16).padStart(2,"0")).join("")}if(s==="utf8")return Array.from({length:(g||u)-i},(l,a)=>String.fromCharCode(this[a+i])).join("");if(s==="base64")return btoa(this)},n.exports=r})(t,"./array"),t(function(n){t("./base64");var r=t("./array");function s(...i){return console.warn("new SafeBuffer() is depreciated, please use SafeBuffer.from()"),s.from(...i)}s.prototype=Object.create(Array.prototype),Object.assign(s,{from(){if(!Object.keys(arguments).length||arguments[0]==null)throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");const i=arguments[0];let g;if(typeof i=="string"){const l=arguments[1]||"utf8";if(l==="hex"){const a=i.match(/([\da-fA-F]{2})/g).map(d=>parseInt(d,16));if(!a||!a.length)throw new TypeError("Invalid first argument for type 'hex'.");g=r.from(a)}else if(l==="utf8"||l==="binary"){const a=i.length,d=new Uint16Array(a);Array.from({length:a},(x,p)=>d[p]=i.charCodeAt(p)),g=r.from(d)}else if(l==="base64"){const a=atob(i),d=a.length,x=new Uint8Array(d);Array.from({length:d},(p,h)=>x[h]=a.charCodeAt(h)),g=r.from(x)}else l==="binary"?g=r.from(i):console.info("SafeBuffer.from unknown encoding: "+l);return g}if(i.byteLength,i.byteLength?i.byteLength:i.length){let l;return i instanceof ArrayBuffer&&(l=new Uint8Array(i)),r.from(l||i)}},alloc(i,g=0){return r.from(new Uint8Array(Array.from({length:i},()=>g)))},allocUnsafe(i){return r.from(new Uint8Array(Array.from({length:i})))},concat(i){if(!Array.isArray(i))throw new TypeError("First argument must be Array containing ArrayBuffer or Uint8Array instances.");return r.from(i.reduce((g,u)=>g.concat(Array.from(u)),[]))}}),s.prototype.from=s.from,s.prototype.toString=r.prototype.toString,n.exports=s})(t,"./buffer"),t(function(n){const r=t("./root"),s={Buffer:t("./buffer")};var i={},g;if(JSON.parseAsync=JSON.parseAsync||function(l,a,d){var x;try{a(x,JSON.parse(l,d))}catch(p){a(p)}},JSON.stringifyAsync=JSON.stringifyAsync||function(l,a,d,x){var p;try{a(p,JSON.stringify(l,d,x))}catch(h){a(h)}},s.parse=function(l,a){return new Promise(function(d,x){JSON.parseAsync(l,function(p,h){p?x(p):d(h)},a)})},s.stringify=function(l,a,d){return new Promise(function(x,p){JSON.stringifyAsync(l,function(h,y){h?p(h):x(y)},a,d)})},r.window&&(s.crypto=r.window.crypto||r.window.msCrypto,s.subtle=(s.crypto||i).subtle||(s.crypto||i).webkitSubtle,s.TextEncoder=r.window.TextEncoder,s.TextDecoder=r.window.TextDecoder,s.random=l=>s.Buffer.from(s.crypto.getRandomValues(new Uint8Array(s.Buffer.alloc(l))))),!s.TextDecoder){const{TextEncoder:l,TextDecoder:a}=t((g+""==typeof m?".":"")+"./lib/text-encoding",1);s.TextDecoder=a,s.TextEncoder=l}if(!s.crypto)try{var u=t("crypto",1);Object.assign(s,{crypto:u,random:a=>s.Buffer.from(u.randomBytes(a))});const{Crypto:l}=t("@peculiar/webcrypto",1);s.ossl=s.subtle=new l({directory:"ossl"}).subtle}catch{console.log("Please `npm install @peculiar/webcrypto` or add it to your package.json !")}n.exports=s})(t,"./shim"),t(function(n){var r=t("./root"),s=t("./shim"),i={};i.pbkdf2={hash:{name:"SHA-256"},iter:1e5,ks:64},i.ecdsa={pair:{name:"ECDSA",namedCurve:"P-256"},sign:{name:"ECDSA",hash:{name:"SHA-256"}}},i.ecdh={name:"ECDH",namedCurve:"P-256"},i.jwk=function(g,u){g=g.split(".");var l=g[0],a=g[1],d={kty:"EC",crv:"P-256",x:l,y:a,ext:!0};return d.key_ops=u?["sign"]:["verify"],u&&(d.d=u),d},i.keyToJwk=function(g){return{kty:"oct",k:g.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""),ext:!1,alg:"A256GCM"}},i.recall={validity:12*60*60,hook:function(g){return g}},i.check=function(g){return typeof g=="string"&&g.slice(0,4)==="SEA{"},i.parse=async function(u){try{var l=typeof u=="string";return l&&u.slice(0,4)==="SEA{"&&(u=u.slice(3)),l?await s.parse(u):u}catch{}return u},r.opt=i,n.exports=i})(t,"./settings"),t(function(n){var r=t("./shim");n.exports=async function(s,i){var g=typeof s=="string"?s:await r.stringify(s),u=await r.subtle.digest({name:i||"SHA-256"},new r.TextEncoder().encode(g));return r.Buffer.from(u)}})(t,"./sha256"),t(function(n){const r=t("./shim"),s=r.subtle,i=r.ossl?r.ossl:s,g=u=>i.digest({name:"SHA-1"},new ArrayBuffer(u));n.exports=g})(t,"./sha1"),t(function(n){var r=t("./root"),s=t("./shim"),i=t("./settings"),g=t("./sha256"),u;r.work=r.work||(async(l,a,d,x)=>{try{var p=(a||{}).epub||a;if(x=x||{},p instanceof Function&&(d=p,p=u),l=typeof l=="string"?l:await s.stringify(l),(x.name||"").toLowerCase().slice(0,3)==="sha"){var h=s.Buffer.from(await g(l,x.name),"binary").toString(x.encode||"base64");if(d)try{d(h)}catch(o){console.log(o)}return h}p=p||s.random(9);var y=await(s.ossl||s.subtle).importKey("raw",new s.TextEncoder().encode(l),{name:x.name||"PBKDF2"},!1,["deriveBits"]),v=await(s.ossl||s.subtle).deriveBits({name:x.name||"PBKDF2",iterations:x.iterations||i.pbkdf2.iter,salt:new s.TextEncoder().encode(x.salt||p),hash:x.hash||i.pbkdf2.hash},y,x.length||i.pbkdf2.ks*8);l=s.random(l.length);var N=s.Buffer.from(v,"binary").toString(x.encode||"base64");if(d)try{d(N)}catch(o){console.log(o)}return N}catch(o){if(console.log(o),r.err=o,r.throw)throw o;d&&d();return}}),n.exports=r.work})(t,"./work"),t(function(n){var r=t("./root"),s=t("./shim");t("./settings"),r.name=r.name||(async(i,g)=>{try{if(i)try{i()}catch(u){console.log(u)}return}catch(u){if(console.log(u),r.err=u,r.throw)throw u;i&&i();return}}),r.pair=r.pair||(async(i,g)=>{try{var u=s.ossl||s.subtle,l=await s.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]).then(async x=>{var p={};p.priv=(await s.subtle.exportKey("jwk",x.privateKey)).d;var h=await s.subtle.exportKey("jwk",x.publicKey);return p.pub=h.x+"."+h.y,p});try{var a=await u.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]).then(async x=>{var p={};p.epriv=(await u.exportKey("jwk",x.privateKey)).d;var h=await u.exportKey("jwk",x.publicKey);return p.epub=h.x+"."+h.y,p})}catch(x){if(r.window)throw x;if(x=="Error: ECDH is not a supported algorithm")console.log("Ignoring ECDH...");else throw x}a=a||{};var d={pub:l.pub,priv:l.priv,epub:a.epub,epriv:a.epriv};if(i)try{i(d)}catch(x){console.log(x)}return d}catch(x){if(console.log(x),r.err=x,r.throw)throw x;i&&i();return}}),n.exports=r.pair})(t,"./pair"),t(function(n){var r=t("./root"),s=t("./shim"),i=t("./settings"),g=t("./sha256"),u;r.sign=r.sign||(async(l,a,d,x)=>{try{if(x=x||{},!(a||x).priv){if(!r.I)throw"No signing key.";a=await r.I(null,{what:l,how:"sign",why:x.why})}if(u===l)throw"`undefined` not allowed.";var p=await i.parse(l),h=x.check=x.check||p;if(r.verify&&(r.opt.check(h)||h&&h.s&&h.m)&&u!==await r.verify(h,a)){var w=await i.parse(h);if(x.raw||(w="SEA"+await s.stringify(w)),d)try{d(w)}catch(A){console.log(A)}return w}var y=a.pub,v=a.priv,N=i.jwk(y,v),o=await g(p),f=await(s.ossl||s.subtle).importKey("jwk",N,{name:"ECDSA",namedCurve:"P-256"},!1,["sign"]).then(S=>(s.ossl||s.subtle).sign({name:"ECDSA",hash:{name:"SHA-256"}},S,new Uint8Array(o))),w={m:p,s:s.Buffer.from(f,"binary").toString(x.encode||"base64")};if(x.raw||(w="SEA"+await s.stringify(w)),d)try{d(w)}catch(S){console.log(S)}return w}catch(S){if(console.log(S),r.err=S,r.throw)throw S;d&&d();return}}),n.exports=r.sign})(t,"./sign"),t(function(n){var r=t("./root"),s=t("./shim"),i=t("./settings"),g=t("./sha256"),u;r.verify=r.verify||(async(d,x,p,h)=>{try{var y=await i.parse(d);if(x===!1){var v=await i.parse(y.m);if(p)try{p(v)}catch(k){console.log(k)}return v}h=h||{};var N=x.pub||x,o=r.opt.slow_leak?await r.opt.slow_leak(N):await(s.ossl||s.subtle).importKey("jwk",i.jwk(N),{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),f=await g(y.m),w,S,A,b;try{if(w=s.Buffer.from(y.s,h.encode||"base64"),S=new Uint8Array(w),A=await(s.ossl||s.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},o,S,new Uint8Array(f)),!A)throw"Signature did not match."}catch{if(r.opt.fallback)return await r.opt.fall_verify(d,x,p,h)}var j=A?await i.parse(y.m):u;if(p)try{p(j)}catch(k){console.log(k)}return j}catch(k){if(console.log(k),r.err=k,r.throw)throw k;p&&p();return}}),n.exports=r.verify;var l={};r.opt.slow_leak=d=>{if(l[d])return l[d];var x=i.jwk(d);return l[d]=(s.ossl||s.subtle).importKey("jwk",x,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),l[d]};var a=r.opt;r.opt.fall_verify=async function(d,x,p,h,y){if(y===r.opt.fallback)throw"Signature did not match";y=y||1;var v=d||"";d=r.opt.unpack(d)||d;var N=await i.parse(d),o=x.pub||x,f=await r.opt.slow_leak(o),w=y<=r.opt.fallback?s.Buffer.from(await s.subtle.digest({name:"SHA-256"},new s.TextEncoder().encode(await i.parse(N.m)))):await g(N.m),S,A,b;try{if(S=s.Buffer.from(N.s,h.encode||"base64"),A=new Uint8Array(S),b=await(s.ossl||s.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},f,A,new Uint8Array(w)),!b)throw"Signature did not match."}catch{try{S=s.Buffer.from(N.s,"utf8"),A=new Uint8Array(S),b=await(s.ossl||s.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},f,A,new Uint8Array(w))}catch{if(!b)throw"Signature did not match."}}var j=b?await i.parse(N.m):u;if(a.fall_soul=v["#"],a.fall_key=v["."],a.fall_val=d,a.fall_state=v[">"],p)try{p(j)}catch(k){console.log(k)}return j},r.opt.fallback=2})(t,"./verify"),t(function(n){var r=t("./shim"),s=t("./settings"),i=t("./sha256");const g=async(u,l,a)=>{const d=u+(l||r.random(8)).toString("utf8"),x=r.Buffer.from(await i(d),"binary"),p=s.keyToJwk(x);return await r.subtle.importKey("jwk",p,{name:"AES-GCM"},!1,["encrypt","decrypt"])};n.exports=g})(t,"./aeskey"),t(function(n){var r=t("./root"),s=t("./shim");t("./settings");var i=t("./aeskey"),g;r.encrypt=r.encrypt||(async(u,l,a,d)=>{try{d=d||{};var x=(l||d).epriv||l;if(g===u)throw"`undefined` not allowed.";if(!x){if(!r.I)throw"No encryption key.";l=await r.I(null,{what:u,how:"encrypt",why:d.why}),x=l.epriv||l}var p=typeof u=="string"?u:await s.stringify(u),h={s:s.random(9),iv:s.random(15)},y=await i(x,h.s,d).then(N=>s.subtle.encrypt({name:d.name||"AES-GCM",iv:new Uint8Array(h.iv)},N,new s.TextEncoder().encode(p))),v={ct:s.Buffer.from(y,"binary").toString(d.encode||"base64"),iv:h.iv.toString(d.encode||"base64"),s:h.s.toString(d.encode||"base64")};if(d.raw||(v="SEA"+await s.stringify(v)),a)try{a(v)}catch(N){console.log(N)}return v}catch(N){if(console.log(N),r.err=N,r.throw)throw N;a&&a();return}}),n.exports=r.encrypt})(t,"./encrypt"),t(function(n){var r=t("./root"),s=t("./shim"),i=t("./settings"),g=t("./aeskey");r.decrypt=r.decrypt||(async(u,l,a,d)=>{try{d=d||{};var x=(l||d).epriv||l;if(!x){if(!r.I)throw"No decryption key.";l=await r.I(null,{what:u,how:"decrypt",why:d.why}),x=l.epriv||l}var p=await i.parse(u),h,y,v;try{h=s.Buffer.from(p.s,d.encode||"base64"),y=s.Buffer.from(p.iv,d.encode||"base64"),v=s.Buffer.from(p.ct,d.encode||"base64");var N=await g(x,h,d).then(f=>s.subtle.decrypt({name:d.name||"AES-GCM",iv:new Uint8Array(y),tagLength:128},f,new Uint8Array(v)))}catch{if(d.encode==="utf8")throw"Could not decrypt";if(r.opt.fallback)return d.encode="utf8",await r.decrypt(u,l,a,d)}var o=await i.parse(new s.TextDecoder("utf8").decode(N));if(a)try{a(o)}catch(f){console.log(f)}return o}catch(f){if(console.log(f),r.err=f,r.throw)throw f;a&&a();return}}),n.exports=r.decrypt})(t,"./decrypt"),t(function(n){var r=t("./root"),s=t("./shim");t("./settings"),r.secret=r.secret||(async(g,u,l,a)=>{try{if(a=a||{},!u||!u.epriv||!u.epub){if(!r.I)throw"No secret mix.";u=await r.I(null,{what:g,how:"secret",why:a.why})}var d=g.epub||g,x=u.epub,p=u.epriv,h=s.ossl||s.subtle,y=i(d),v=Object.assign({public:await h.importKey(...y,!0,[])},{name:"ECDH",namedCurve:"P-256"}),N=i(x,p),o=await h.importKey(...N,!1,["deriveBits"]).then(async w=>{var S=await h.deriveBits(v,w,256),A=new Uint8Array(S),b=await h.importKey("raw",A,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);return h.exportKey("jwk",b).then(({k:j})=>j)}),f=o;if(l)try{l(f)}catch(w){console.log(w)}return f}catch(w){if(console.log(w),r.err=w,r.throw)throw w;l&&l();return}});var i=(g,u)=>{var[l,a]=g.split("."),d=u?{d:u}:{};return["jwk",Object.assign(d,{x:l,y:a,kty:"EC",crv:"P-256",ext:!0}),{name:"ECDH",namedCurve:"P-256"}]};n.exports=r.secret})(t,"./secret"),t(function(n){var r=t("./root");r.certify=r.certify||(async(s,i={},g,u,l={})=>{try{if(console.log("SEA.certify() is an early experimental community supported method that may change API behavior without warning in any future version."),s=(()=>{var f=[];if(s){if((typeof s=="string"||Array.isArray(s))&&s.indexOf("*")>-1)return"*";if(typeof s=="string")return s;if(Array.isArray(s)){if(s.length===1&&s[0])return typeof s[0]=="object"&&s[0].pub?s[0].pub:typeof s[0]=="string"?s[0]:null;s.map(w=>{typeof w=="string"?f.push(w):typeof w=="object"&&w.pub&&f.push(w.pub)})}return typeof s=="object"&&s.pub?s.pub:f.length>0?f:null}})(),!s)return console.log("No certificant found.");const d=l.expiry&&(typeof l.expiry=="number"||typeof l.expiry=="string")?parseFloat(l.expiry):null,x=(i||{}).read?i.read:null,p=(i||{}).write?i.write:typeof i=="string"||Array.isArray(i)||i["+"]||i["#"]||i["."]||i["="]||i["*"]||i[">"]||i["<"]?i:null,h=(l||{}).block||(l||{}).blacklist||(l||{}).ban||{},y=h.read&&(typeof h.read=="string"||(h.read||{})["#"])?h.read:null,v=typeof h=="string"?h:h.write&&(typeof h.write=="string"||h.write["#"])?h.write:null;if(!x&&!p)return console.log("No policy found.");const N=JSON.stringify({c:s,...d?{e:d}:{},...x?{r:x}:{},...p?{w:p}:{},...y?{rb:y}:{},...v?{wb:v}:{}});var a=await r.sign(N,g,null,{raw:1});if(l.raw||(a="SEA"+JSON.stringify(a)),u)try{u(a)}catch(f){console.log(f)}return a}catch(d){if(r.err=d,r.throw)throw d;u&&u();return}}),n.exports=r.certify})(t,"./certify"),t(function(n){var r=t("./shim"),s=t("./root");s.work=t("./work"),s.sign=t("./sign"),s.verify=t("./verify"),s.encrypt=t("./encrypt"),s.decrypt=t("./decrypt"),s.certify=t("./certify"),s.random=s.random||r.random,s.Buffer=s.Buffer||t("./buffer"),s.keyid=s.keyid||(async i=>{try{const g=r.Buffer.concat(i.replace(/-/g,"+").replace(/_/g,"/").split(".").map(d=>r.Buffer.from(d,"base64"))),u=r.Buffer.concat([r.Buffer.from([153,g.length/256,g.length%256]),g]),l=await sha1hash(u),a=r.Buffer.from(l,"binary");return a.toString("hex",a.length-8)}catch(g){throw console.log(g),g}}),((s.window||{}).GUN||{}).SEA=s,n.exports=s})(t,"./sea"),t(function(n){var r=t("./sea"),s,i;r.window?s=r.window.GUN||{chain:{}}:s=t((i+""==typeof m?".":"")+"./gun",1),r.GUN=s;function g(l){this._={$:this}}g.prototype=function(){function l(){}return l.prototype=s.chain,new l}(),g.prototype.constructor=g,s.chain.user=function(l){var a=this,x=a.back(-1),d;if(l)return l=r.opt.pub((l._||"")["#"])||l,x.get("~"+l);if(d=x.back("user"))return d;var x=x._,p=x,h=p.opt.uuid||u;return(p=(d=p.user=a.chain(new g))._).opt={},p.opt.uuid=function(y){var v=h(),N=x.user;return!N||!(N=N.is)||!(N=N.pub)||(v="~"+N+"/"+v,y&&y.call&&y(null,v)),v},d};function u(){return s.state().toString(36).replace(".","")}s.User=g,g.GUN=s,g.SEA=s.SEA=r,n.exports=g})(t,"./user"),t(function(n){var r,s=""+r!=typeof GUN?GUN||{chain:{}}:t((""+r==typeof m?".":"")+"./gun",1);s.chain.then=function(i,g){var u=this,l=new Promise(function(a,d){u.once(a,g)});return i?l.then(i):l}})(t,"./then"),t(function(n){var r=t("./user"),s=r.SEA,i=r.GUN,g=function(){};r.prototype.create=function(...u){var l=typeof u[0]=="object"&&(u[0].pub||u[0].epub)?u[0]:typeof u[1]=="object"&&(u[1].pub||u[1].epub)?u[1]:null,a=l&&(l.pub||l.epub)?l.pub:typeof u[0]=="string"?u[0]:null,d=l&&(l.pub||l.epub)?l:a&&typeof u[1]=="string"?u[1]:null,x=u.filter(f=>typeof f=="function")[0]||null,p=u&&u.length>1&&typeof u[u.length-1]=="object"?u[u.length-1]:{},h=this,y=h._,v=h.back(-1);if(x=x||g,p=p||{},p.check!==!1){var N;if(a||(N="No user."),(d||"").length<8&&(N="Password too short!"),N)return x({err:i.log(N)}),h}if(y.ing)return(x||g)({err:i.log("User is already being created or authenticated!"),wait:!0}),h;y.ing=!0;var o={};return o.a=function(f){if(o.pubs=f,f&&!p.already){var w={err:i.log("User already created!")};y.ing=!1,(x||g)(w),h.leave();return}o.salt=String.random(64),s.work(d,o.salt,o.b)},o.b=function(f){o.proof=f,l?o.c(l):s.pair(o.c)},o.c=function(f){var w;o.pair=f||{},(w=y.root.user)&&(w._.sea=f,w.is={pub:f.pub,epub:f.epub,alias:a}),o.data={pub:f.pub},o.d()},o.d=function(){o.data.alias=a,o.e()},o.e=function(){o.data.epub=o.pair.epub,s.encrypt({priv:o.pair.priv,epriv:o.pair.epriv},o.proof,o.f,{raw:1})},o.f=function(f){o.data.auth=JSON.stringify({ek:f,s:o.salt}),o.g(o.data.auth)},o.g=function(f){var w;o.data.auth=o.data.auth||f,v.get(w="~"+o.pair.pub).put(o.data).on(o.h);var S={};S[w]={"#":w},v.get("~@"+a).put(S).get(w).on(o.i)},o.h=function(f,w,S,A){A.off(),o.h.ok=1,o.i()},o.i=function(f,w,S,A){A&&(o.i.ok=1,A.off()),!(!o.h.ok||!o.i.ok)&&(y.ing=!1,x({ok:0,pub:o.pair.pub}),g===x&&(l?h.auth(l):h.auth(a,d)))},v.get("~@"+a).once(o.a),h},r.prototype.leave=function(u,l){var a=this,d=a.back(-1)._.user;if(d&&(delete d.is,delete d._.is,delete d._.sea),s.window)try{var x={};x=s.window.sessionStorage,delete x.recall,delete x.pair}catch{}return a}})(t,"./create"),t(function(n){var r=t("./user"),s=r.SEA,i=r.GUN,g=function(){};r.prototype.auth=function(...l){var a=typeof l[0]=="object"&&(l[0].pub||l[0].epub)?l[0]:typeof l[1]=="object"&&(l[1].pub||l[1].epub)?l[1]:null,d=!a&&typeof l[0]=="string"?l[0]:null,x=(d||a&&!(a.priv&&a.epriv))&&typeof l[1]=="string"?l[1]:null,p=l.filter(S=>typeof S=="function")[0]||null,h=l&&l.length>1&&typeof l[l.length-1]=="object"?l[l.length-1]:{},y=this,v=y._,N=y.back(-1);if(v.ing)return(p||g)({err:i.log("User is already being created or authenticated!"),wait:!0}),y;v.ing=!0;var o={},f,w=9;return o.a=function(S){if(!S)return o.b();if(!S.pub){var A=[];return Object.keys(S).forEach(function(b){b!="_"&&A.push(S[b])}),o.b(A)}if(o.name)return o.f(S);o.c((o.data=S).auth)},o.b=function(S){var A=(o.list=(o.list||[]).concat(S||[])).shift();if(f===A){if(o.name)return o.err("Your user account is not published for dApps to access, please consider syncing it online, or allowing local access by adding your device as a peer.");if(d&&w--){N.get("~@"+d).once(o.a);return}return o.err("Wrong user or password.")}N.get(A).once(o.a)},o.c=function(S){if(f===S)return o.b();if(typeof S=="string")return o.c(u(S));s.work(x,(o.auth=S).s,o.d,o.enc)},o.d=function(S){s.decrypt(o.auth.ek,S,o.e,o.enc)},o.e=function(S){if(f===S)return o.enc?(o.enc=null,o.b()):(o.enc={encode:"utf8"},o.c(o.auth));o.half=S,o.f(o.data)},o.f=function(S){var A=o.half||{},b=o.data||{};o.g(o.lol={pub:S.pub||b.pub,epub:S.epub||b.epub,priv:S.priv||A.priv,epriv:S.epriv||A.epriv})},o.g=function(S){if(!S||!S.pub||!S.epub)return o.b();o.pair=S;var A=N._.user,b=A._;b.tag;var j=b.opt;b=A._=N.get("~"+S.pub)._,b.opt=j,A.is={pub:S.pub,epub:S.epub,alias:d||S.pub},b.sea=o.pair,v.ing=!1;try{x&&f==(u(v.root.graph["~"+S.pub].auth)||"")[":"]&&(h.shuffle=h.change=x)}catch{}if(h.change?o.z():(p||g)(b),s.window&&(y.back("user")._.opt||h).remember)try{var k={};k=s.window.sessionStorage,k.recall=!0,k.pair=JSON.stringify(S)}catch{}try{N._.tag.auth?N._.on("auth",b):setTimeout(function(){N._.on("auth",b)},1)}catch(D){i.log("Your 'auth' callback crashed with:",D)}},o.h=function(S){if(!S)return o.b();if(d=S.alias,d||(d=S.alias="~"+a.pub),!S.auth)return o.g(a);a=null,o.c((o.data=S).auth)},o.z=function(){o.salt=String.random(64),s.work(h.change,o.salt,o.y)},o.y=function(S){s.encrypt({priv:o.pair.priv,epriv:o.pair.epriv},S,o.x,{raw:1})},o.x=function(S){o.w(JSON.stringify({ek:S,s:o.salt}))},o.w=function(S){if(h.shuffle){console.log("migrate core account from UTF8 & shuffle");var A={};Object.keys(o.data).forEach(function(b){A[b]=o.data[b]}),delete A._,A.auth=S,N.get("~"+o.pair.pub).put(A)}N.get("~"+o.pair.pub).get("auth").put(S,p||g)},o.err=function(S){var A={err:i.log(S||"User cannot be found!")};v.ing=!1,(p||g)(A)},o.plugin=function(S){if(!(o.name=S))return o.err();var A=[S];S[0]!=="~"&&(A[1]="~"+S,A[2]="~@"+S),o.b(A)},a?a.priv&&a.epriv?o.g(a):N.get("~"+a.pub).once(o.h):d?N.get("~@"+d).once(o.a):!d&&!x&&s.name(o.plugin),y};function u(l){if(typeof l!="string")return l;try{l=JSON.parse(l)}catch{l={}}return l}})(t,"./auth"),t(function(n){var r=t("./user"),s=r.SEA;r.GUN,r.prototype.recall=function(i,g){var u=this,l=u.back(-1);if(i=i||{},i&&i.sessionStorage){if(s.window)try{var a={};a=s.window.sessionStorage,a&&(l._.opt.remember=!0,(u.back("user")._.opt||i).remember=!0,(a.recall||a.pair)&&l.user().auth(JSON.parse(a.pair),g))}catch{}return u}return u}})(t,"./recall"),t(function(n){var r=t("./user"),s=r.SEA,i=r.GUN,g=function(){};r.prototype.pair=function(){var u=this,l;try{l=new Proxy({DANGER:"â˜ "},{get:function(a,d,x){if(!(!u.is||!(u._||"").sea))return u._.sea[d]}})}catch{}return l},r.prototype.delete=async function(u,l,a){console.log("user.delete() IS DEPRECATED AND WILL BE MOVED TO A MODULE!!!");var d=this;d.back(-1);var x=d.back("user");try{x.auth(u,l,function(p){var h=(x.is||{}).pub;x.map().once(function(){this.put(null)}),x.leave(),(a||g)({ok:0})})}catch(p){i.log("User.delete failed! Error:",p)}return d},r.prototype.alive=async function(){console.log("user.alive() IS DEPRECATED!!!");const u=this.back(-1);try{return await authRecall(u),u._.user._}catch{const a="No session!";throw i.log(a),{err:a}}},r.prototype.trust=async function(u){console.log("`.trust` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!"),i.is(u)&&u.get("pub").get((l,a)=>{console.log(l,a)}),u.get("trust").get(path).put(theirPubkey)},r.prototype.grant=function(u,l){console.log("`.grant` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var a=this,d=a.back(-1).user(),x=d._.sea,p="";return a.back(function(h){h.is||(p+=h.get||"")}),async function(){var h,y=await d.get("grant").get(x.pub).get(p).then();y=await s.decrypt(y,x),y||(y=s.random(16).toString(),h=await s.encrypt(y,x),d.get("grant").get(x.pub).get(p).put(h));var v=u.get("pub").then(),N=u.get("epub").then();v=await v,N=await N;var o=await s.secret(N,x);h=await s.encrypt(y,o),d.get("grant").get(v).get(p).put(h,l)}(),a},r.prototype.secret=function(u,l){console.log("`.secret` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var a=this,d=a.back(-1).user(),x=d.pair(),p="";return a.back(function(h){h.is||(p+=h.get||"")}),async function(){var h,y=await d.get("trust").get(x.pub).get(p).then();y=await s.decrypt(y,x),y||(y=s.random(16).toString(),h=await s.encrypt(y,x),d.get("trust").get(x.pub).get(p).put(h)),h=await s.encrypt(u,y),a.put(h,l)}(),a},n.exports=r})(t,"./share"),t(function(n){var r=t("./sea"),s=t("./settings"),i,g=(r.window||"").GUN||t((""+i==typeof m?".":"")+"./gun",1);g.on("opt",function(h){h.sea||(h.sea={own:{}},h.on("put",u,h)),this.to.next(h)});function u(h){var y=this,v=y.as,N=h.put,o=N["#"],f=N["."],w=N[":"],S=N[">"],A=h["#"],b;if(!(!o||!f)){if((h._||"").faith&&(v.opt||"").faith&&typeof h._=="function"){r.opt.pack(N,function(k){r.verify(k,!1,function(D){N["="]=r.opt.unpack(D),y.to.next(h)})});return}var j=function(k){v.on("in",{"@":A,err:h.err=k})};if((h._||"").DBG&&((h._||"").DBG.c=+new Date),0<=o.indexOf("<?")&&(b=parseFloat(o.split("<?")[1]||""),b&&S<g.state()-b*1e3)){(b=h._)&&b.stun&&b.stun--;return}if(o==="~@"){u.alias(y,h,w,f,o,v,j);return}if(o.slice(0,2)==="~@"){u.pubs(y,h,w,f,o,v,j);return}if(b=r.opt.pub(o)){u.pub(y,h,w,f,o,v,j,v.user||"",b);return}if(0<=o.indexOf("#")){u.hash(y,h,w,f,o,v,j);return}u.any(y,h,w,f,o,v,j,v.user||"")}}u.hash=function(h,y,v,N,o,f,w){r.work(v,null,function(S){function A(b){let j="";for(let k=0;k<b.length;k++)j+=k-1&1?"":String.fromCharCode(parseInt(b.substring(k-1,k+1),16));return btoa(j)}if(S&&S===N.split("#").slice(-1)[0])return h.to.next(y);if(S&&S===A(N.split("#").slice(-1)[0]))return h.to.next(y);w("Data hash not same as hash!")},{name:"SHA-256"})},u.alias=function(h,y,v,N,o,f,w){if(!v)return w("Data must exist!");if("~@"+N===a(v))return h.to.next(y);w("Alias not same!")},u.pubs=function(h,y,v,N,o,f,w){if(!v)return w("Alias must exist!");if(N===a(v))return h.to.next(y);w("Alias not same!")},u.pub=async function(h,y,v,N,o,f,w,S,A){var b;const j=await s.parse(v)||{},k=(D,E,_)=>{if(D.m&&D.s&&E&&A)return r.verify(D,A,F=>{if(i!==F&&i!==F.e&&y.put[">"]&&y.put[">"]>parseFloat(F.e))return w("Certificate expired.");if(i!==F&&F.c&&F.w&&(F.c===E||F.c.indexOf("*")>-1)){let U=o.indexOf("/")>-1?o.replace(o.substring(0,o.indexOf("/")+1),""):"";String.match=String.match||g.text.match;const L=Array.isArray(F.w)?F.w:typeof F.w=="object"||typeof F.w=="string"?[F.w]:[];for(const B of L)if(String.match(U,B["#"])&&String.match(N,B["."])||!B["."]&&String.match(U,B["#"])||!B["#"]&&String.match(N,B["."])||String.match(U?U+"/"+N:N,B["#"]||B)){if(B["+"]&&B["+"].indexOf("*")>-1&&U&&U.indexOf(E)==-1&&N.indexOf(E)==-1)return w(`Path "${U}" or key "${N}" must contain string "${E}".`);if(F.wb&&(typeof F.wb=="string"||(F.wb||{})["#"])){var I=h.as.root.$.back(-1);return typeof F.wb=="string"&&F.wb.slice(0,1)!=="~"&&(I=I.get("~"+A)),I.get(F.wb).get(E).once(P=>P&&(P===1||P===!0)?w(`Certificant ${E} blocked.`):_(F))}return _(F)}return w("Certificate verification fail.")}})};if(N==="pub"&&"~"+A===o)return v===A?h.to.next(y):w("Account not same!");if((b=S.is)&&b.pub&&!j["*"]&&!j["+"]&&(A===b.pub||A!==b.pub&&((y._.msg||{}).opt||{}).cert)){r.opt.pack(y.put,D=>{r.sign(D,S._.sea,async function(E){if(i===E)return w(r.err||"Signature fail.");if(y.put[":"]={":":b=r.opt.unpack(E.m),"~":E.s},y.put["="]=b,A===S.is.pub){(b=a(v))&&((f.sea.own[b]=f.sea.own[b]||{})[A]=1),JSON.stringifyAsync(y.put[":"],function(_,F){return _?w(_||"Stringify error."):(y.put[":"]=F,h.to.next(y))});return}if(A!==S.is.pub&&((y._.msg||{}).opt||{}).cert){const _=await s.parse(y._.msg.opt.cert);_&&_.m&&_.s&&k(_,S.is.pub,F=>{y.put[":"]["+"]=_,y.put[":"]["*"]=S.is.pub,JSON.stringifyAsync(y.put[":"],function(I,U){return I?w(I||"Stringify error."):(y.put[":"]=U,h.to.next(y))})})}},{raw:1})});return}r.opt.pack(y.put,D=>{r.verify(D,j["*"]||A,function(E){var _;if(E=r.opt.unpack(E),i===E)return w("Unverified data.");if((_=a(E))&&A===r.opt.pub(_)&&((f.sea.own[_]=f.sea.own[_]||{})[A]=1),j["+"]&&j["+"].m&&j["+"].s&&j["*"])k(j["+"],j["*"],F=>(y.put["="]=E,h.to.next(y)));else return y.put["="]=E,h.to.next(y)})})},u.any=function(h,y,v,N,o,f,w,S){if(f.opt.secure)return w("Soul missing public key at '"+N+"'.");f.on("secure",function(A){if(this.off(),!f.opt.secure)return h.to.next(A);w("Data cannot be changed.")}).on.on("secure",y)};var l=g.valid,a=function(h,y){return typeof(y=l(h))=="string"&&y};(g.state||"").ify;var d=/[^\w_-]/;r.opt.pub=function(h){if(h&&(h=h.split("~"),!(!h||!(h=h[1]))&&(h=h.split(d).slice(0,2),!(!h||h.length!=2)&&(h[0]||"")[0]!=="@")))return h=h.slice(0,2).join("."),h},r.opt.stringy=function(h){},r.opt.pack=function(h,y,v,N,o){var f,w;if(r.opt.check(h))return y(h);h&&h["#"]&&h["."]&&h[">"]&&(f=h[":"],w=1),JSON.parseAsync(w?f:h,function(S,A){var b=i!==(A||"")[":"]&&(A||"")["~"];if(!b){y(h);return}y({m:{"#":o||h["#"],".":v||h["."],":":(A||"")[":"],">":h[">"]||g.state.is(N,v)},s:b})})};var x=r.opt;r.opt.unpack=function(h,y,v){var N;if(i!==h){if(h&&i!==(N=h[":"]))return N;if(y=y||x.fall_key,!v&&x.fall_val&&(v={},v[y]=x.fall_val),!(!y||!v)){if(h===v[y]||!r.opt.check(v[y]))return h;var o=v&&v._&&v._["#"]||x.fall_soul,f=g.state.is(v,y)||x.fall_state;if(h&&h.length===4&&o===h[0]&&y===h[1]&&p(f)===p(h[3]))return h[2];if(f<r.opt.shuffle_attack)return h}}},r.opt.shuffle_attack=15463296e5;var p=Math.floor})(t,"./index")})()}(ge)),ge.exports}qt();var Le={},Je;function Wt(){if(Je)return Le;Je=1;var c=typeof window<"u"?window.Gun:yt();return c.chain.promise=function(n){var m=this,n=n||function(r){return r};return new Promise(function(r,s){m.once(function(i,g){r({put:i,get:g,gun:this})})}).then(n)},c.chain.then=function(t){var m=this,n=new Promise((r,s)=>{m.once(function(i,g){r(i,g)})});return t?n.then(t):n},Le}Wt();console.log("ðŸ”« GunJS service file loading...");const z=et({peers:["https://gun-manhattan.herokuapp.com/gun","https://peer.evidently.digital/gun","https://gunmeetingserver.herokuapp.com/gun"]});console.log("ðŸ”« GunJS initialized with multiple peers");z.on("hi",c=>{console.log("ðŸ”« GunJS: Connected to peer",c)});z.on("bye",c=>{console.log("ðŸ”« GunJS: Disconnected from peer",c)});z.on("out",c=>{c&&c.err&&console.warn("ðŸ”« GunJS: Connection error:",c.err)});setTimeout(()=>{console.log("ðŸ”« GunJS connection test - gun object:",z),console.log("ðŸ”« GunJS internal state:",z._),z.get("test").put({hello:"world",timestamp:Date.now()}),console.log("ðŸ”« GunJS: Test data written")},2e3);const zt=z.user(),Vt=et.SEA;class Xt{constructor(){ne(this,"gun");ne(this,"user");ne(this,"SEA");console.log("GunJS: GunService constructor called"),this.gun=z,this.user=zt,this.SEA=Vt,console.log("GunJS: GunService initialized")}async signUp(t,m){return console.log("ðŸ”« GunJS: Attempting to sign up user:",t),new Promise(n=>{if(m.length<8){console.log("ðŸ”« GunJS: Password too short"),n({success:!1,error:"Password must be at least 8 characters"});return}const r=setTimeout(()=>{console.log("ðŸ”« GunJS: Sign up timed out"),n({success:!1,error:"Sign up request timed out. Please check your connection."})},1e4);this.user.create(t,m,s=>{if(clearTimeout(r),console.log("ðŸ”« GunJS: Sign up response:",s),s.err){console.log("ðŸ”« GunJS: Sign up error:",s.err),n({success:!1,error:s.err});return}console.log("ðŸ”« GunJS: Sign up successful"),n({success:!0})})})}async signIn(t,m){return console.log("ðŸ”« GunJS: Attempting to sign in user:",t),new Promise(n=>{const r=setTimeout(()=>{console.log("ðŸ”« GunJS: Sign in timed out"),n({success:!1,error:"Sign in request timed out. Please check your connection."})},1e4);this.user.auth(t,m,s=>{if(clearTimeout(r),console.log("ðŸ”« GunJS: Sign in response:",s),s.err){console.log("ðŸ”« GunJS: Sign in error:",s.err),n({success:!1,error:s.err});return}console.log("ðŸ”« GunJS: Sign in successful, user:",this.user.is),n({success:!0,user:{id:this.user.is.pub,username:this.user.is.alias,createdAt:new Date().toISOString()}})})})}signOut(){this.user.leave()}isAuthenticated(){return!!this.user.is}getCurrentUser(){return this.user.is?{id:this.user.is.pub,username:this.user.is.alias}:null}async recallUser(){return new Promise(t=>{const m=setTimeout(()=>{console.log("ðŸ”« GunJS: recallUser timed out"),t({success:!1})},3e3);this.user.recall({sessionStorage:!0},()=>{clearTimeout(m),this.user.is?(console.log("ðŸ”« GunJS: User recalled successfully:",this.user.is.alias),t({success:!0,user:{id:this.user.is.pub,username:this.user.is.alias,createdAt:new Date().toISOString()}})):(console.log("ðŸ”« GunJS: No user to recall"),t({success:!1}))})})}async updateProfile(t){return new Promise(m=>{if(!this.user.is){m({success:!1,error:"User not authenticated"});return}this.user.get("profile").put(t,n=>{if(n.err){m({success:!1,error:n.err});return}m({success:!0})})})}async getProfile(){return new Promise(t=>{if(!this.user.is){t({success:!1,error:"User not authenticated"});return}const m=setTimeout(()=>{console.log("ðŸ”« GunJS: getProfile timed out"),t({success:!1,error:"Profile request timed out"})},3e3);this.user.get("profile").once(n=>{clearTimeout(m),console.log("ðŸ”« GunJS: Profile loaded:",n),t({success:!0,profile:n||{}})})})}async syncUserBooks(t){return new Promise(m=>{if(!this.user.is){m({success:!1,error:"User not authenticated"});return}this.user.get("books").put(t,n=>{if(n.err){m({success:!1,error:n.err});return}m({success:!0})})})}async getUserBooks(){return new Promise(t=>{if(!this.user.is){t({success:!1,error:"User not authenticated"});return}this.user.get("books").once(m=>{t({success:!0,books:m||[]})})})}async syncUserNotes(t){return new Promise(m=>{if(!this.user.is){m({success:!1,error:"User not authenticated"});return}this.user.get("notes").put(t,n=>{if(n.err){m({success:!1,error:n.err});return}m({success:!0})})})}async getUserNotes(){return new Promise(t=>{if(!this.user.is){t({success:!1,error:"User not authenticated"});return}this.user.get("notes").once(m=>{t({success:!0,notes:m||[]})})})}async syncUserSessions(t){return new Promise(m=>{if(!this.user.is){m({success:!1,error:"User not authenticated"});return}this.user.get("sessions").put(t,n=>{if(n.err){m({success:!1,error:n.err});return}m({success:!0})})})}async getUserSessions(){return new Promise(t=>{if(!this.user.is){t({success:!1,error:"User not authenticated"});return}this.user.get("sessions").once(m=>{t({success:!0,sessions:m||[]})})})}async syncPetData(t){return new Promise(m=>{if(!this.user.is){m({success:!1,error:"User not authenticated"});return}this.user.get("pet").put(t,n=>{if(n.err){m({success:!1,error:n.err});return}m({success:!0})})})}async getUserPetData(){return new Promise(t=>{if(!this.user.is){t({success:!1,error:"User not authenticated"});return}this.user.get("pet").once(m=>{t({success:!0,petData:m||null})})})}async syncUserData(t,m){return new Promise(n=>{if(!this.user.is){n({success:!1,error:"User not authenticated"});return}this.user.get(t).put(m,r=>{if(r.err){n({success:!1,error:r.err});return}n({success:!0})})})}async getUserData(t){return new Promise(m=>{if(!this.user.is){m({success:!1,error:"User not authenticated"});return}this.user.get(t).once(n=>{m({success:!0,data:n||{}})})})}subscribeToUserData(t,m){this.user.is&&this.user.get(t).on(m)}unsubscribeFromUserData(t){this.user.is&&this.user.get(t).off()}}const $=new Xt;class Qt{constructor(){ne(this,"isOnline",!0);window.addEventListener("online",()=>{this.isOnline=!0,this.syncPendingChanges()}),window.addEventListener("offline",()=>{this.isOnline=!1})}async syncData(t,m){if($.isAuthenticated()&&this.isOnline)try{await $.syncUserData(t,m)}catch(n){console.warn("Failed to sync data to server:",n)}}async getData(t,m){if($.isAuthenticated()&&this.isOnline)try{const r=await $.getUserData(t);if(r.success&&r.data&&Object.keys(r.data).length>0)return r.data}catch(r){console.warn("Failed to get data from server:",r)}const n=localStorage.getItem(`bookish_${t}`);return n?JSON.parse(n):m}setLocalStorage(t,m){localStorage.setItem(`bookish_${t}`,JSON.stringify(m))}async syncPendingChanges(){if(!$.isAuthenticated())return;const t=["books","current_book","reading_sessions","notes","pet","stats","settings","streak"];for(const m of t)try{const n=localStorage.getItem(`bookish_${m}`);n&&await $.syncUserData(m,JSON.parse(n))}catch(n){console.warn(`Failed to sync ${m}:`,n)}}async getBooks(){return this.getData("books",[])}async saveBooks(t){this.setLocalStorage("books",t),await this.syncData("books",t)}async getCurrentBook(){return this.getData("current_book",null)}async setCurrentBook(t){this.setLocalStorage("current_book",t),await this.syncData("current_book",t)}async getReadingSessions(){return this.getData("reading_sessions",[])}async saveReadingSessions(t){this.setLocalStorage("reading_sessions",t),await this.syncData("reading_sessions",t)}async getNotes(){return this.getData("notes",[])}async saveNotes(t){this.setLocalStorage("notes",t),await this.syncData("notes",t)}async getPet(){const t={name:"Bookworm",level:1,experience:0,experienceToNextLevel:100,happiness:80,lastFed:new Date().toISOString()};return this.getData("pet",t)}async savePet(t){this.setLocalStorage("pet",t),await this.syncData("pet",t)}async getStats(){const t={totalBooksRead:0,totalPagesRead:0,totalReadingTime:0,readingTimeToday:0,readingTimeThisWeek:0,booksFinishedThisYear:0};return this.getData("stats",t)}async saveStats(t){this.setLocalStorage("stats",t),await this.syncData("stats",t)}async getSettings(){const t={reminders:[],theme:"light",petName:"Bookworm"};return this.getData("settings",t)}async saveSettings(t){this.setLocalStorage("settings",t),await this.syncData("settings",t)}async getStreak(){const t={currentStreak:0,longestStreak:0,lastReadDate:null};return this.getData("streak",t)}async saveStreak(t){this.setLocalStorage("streak",t),await this.syncData("streak",t)}async migrateLocalDataToServer(){if(!$.isAuthenticated())return;const t=[{key:"books",getter:()=>JSON.parse(localStorage.getItem("bookish_books")||"[]")},{key:"current_book",getter:()=>JSON.parse(localStorage.getItem("bookish_current_book")||"null")},{key:"reading_sessions",getter:()=>JSON.parse(localStorage.getItem("bookish_reading_sessions")||"[]")},{key:"notes",getter:()=>JSON.parse(localStorage.getItem("bookish_notes")||"[]")},{key:"pet",getter:()=>JSON.parse(localStorage.getItem("bookish_pet")||"null")},{key:"stats",getter:()=>JSON.parse(localStorage.getItem("bookish_stats")||"null")},{key:"settings",getter:()=>JSON.parse(localStorage.getItem("bookish_settings")||"null")},{key:"streak",getter:()=>JSON.parse(localStorage.getItem("bookish_streak")||"null")}];for(const m of t)try{const n=m.getter();n!==null&&(Array.isArray(n)?n.length>0:Object.keys(n).length>0)&&await $.syncUserData(m.key,n)}catch(n){console.warn(`Failed to migrate ${m.key}:`,n)}}}const M=new Qt,Q="https://openlibrary.org",Zt=async c=>{try{return(await(await fetch(`${Q}/search.json?q=${encodeURIComponent(c)}&limit=10`)).json()).docs.map(n=>({key:n.key,title:n.title,author_name:n.author_name,cover_i:n.cover_i,first_publish_year:n.first_publish_year,number_of_pages_median:n.number_of_pages_median}))}catch(t){return console.error("Error searching books:",t),[]}},es=async c=>{var t,m;try{const n=c.replace("/works/",""),s=await(await fetch(`${Q}/works/${n}.json`)).json();let i=s.number_of_pages_median;!i&&s.editions&&(i=await ts(s.editions)),i||(i=await ss(n));let g=[];if(s.authors&&s.authors.length>0){const u=s.authors.slice(0,3).map(async a=>{try{return(await(await fetch(`${Q}${a.author.key}.json`)).json()).name}catch{return null}});g=(await Promise.all(u)).filter(a=>a!==null)}return{key:s.key,title:s.title,author_name:g,cover_i:(t=s.covers)==null?void 0:t[0],first_publish_year:s.first_publish_year,description:((m=s.description)==null?void 0:m.value)||s.description||"",number_of_pages_median:i}}catch(n){return console.error("Error fetching book details:",n),null}},ts=async c=>{try{if(!c||!c.entries||c.entries.length===0)return;for(const t of c.entries.slice(0,3))try{const n=await(await fetch(`${Q}${t.key}.json`)).json();if(n.number_of_pages)return n.number_of_pages}catch(m){console.error("Error fetching edition:",m);continue}return}catch(t){console.error("Error getting page count from editions:",t);return}},ss=async c=>{try{const m=await(await fetch(`${Q}/works/${c}/editions.json?limit=5`)).json();if(m.entries&&m.entries.length>0){for(const n of m.entries)if(n.number_of_pages)return n.number_of_pages}return}catch(t){console.error("Error fetching editions for page count:",t);return}},rs=(c,t="M")=>c?`https://covers.openlibrary.org/b/id/${c}-${{S:"small",M:"medium",L:"large"}[t]}.jpg`:"/placeholder-cover.jpg",ns=async c=>{var t;try{return((t=(await(await fetch(`${Q}/subjects/${encodeURIComponent(c.toLowerCase())}.json?limit=10`)).json()).works)==null?void 0:t.map(r=>{var s;return{key:r.key,title:r.title,author_name:((s=r.authors)==null?void 0:s.map(i=>i.name))||[],cover_i:r.cover_id,first_publish_year:r.first_publish_year,number_of_pages_median:r.number_of_pages_median}}))||[]}catch(m){return console.error("Error searching books by subject:",m),[]}},as=async c=>{var t,m;try{const n=c.replace(/[-\s]/g,""),r=await fetch(`${Q}/isbn/${n}.json`);if(!r.ok)return null;const s=await r.json();return{key:s.key,title:s.title,author_name:((t=s.authors)==null?void 0:t.map(i=>i.name))||[],cover_i:(m=s.covers)==null?void 0:m[0],first_publish_year:s.publish_date?new Date(s.publish_date).getFullYear():void 0,number_of_pages_median:s.number_of_pages}}catch(n){return console.error("Error searching book by ISBN:",n),null}},os="bookish_reading_sessions",is="bookish_stats",ls="bookish_streak",Se="bookish_cached_books",ce=(c,t)=>{const m=localStorage.getItem(c);return m?JSON.parse(m):t},cs=(c,t)=>{localStorage.setItem(c,JSON.stringify(t))},tt=c=>ce(Se,{})[c]||null,$e=c=>{const t=ce(Se,{});t[c.key]={...c,cached_at:new Date().toISOString()},cs(Se,t)},Be=()=>ce(os,[]),He=c=>Be().filter(t=>t.bookId===c),ds=()=>({totalBooksRead:0,totalPagesRead:0,totalReadingTime:0,readingTimeToday:0,readingTimeThisWeek:0,booksFinishedThisYear:0}),st=()=>ce(is,ds()),us=()=>({currentStreak:0,longestStreak:0,lastReadDate:null}),rt=()=>ce(ls,us()),nt=C.createContext(void 0),Z=()=>{const c=C.useContext(nt);if(!c)throw new Error("useBooks must be used within a BookProvider");return c},ms=({children:c})=>{const[t,m]=C.useState([]),[n,r]=C.useState(null),[s,i]=C.useState([]),[g,u]=C.useState([]);C.useEffect(()=>{(async()=>{const o=(await M.getBooks()).map(w=>{const S=tt(w.key);return S?{...w,...S}:w});m(o);const f=await M.getCurrentBook();r(f)})()},[]),C.useEffect(()=>{(async()=>{if(n){const N=await M.getReadingSessions(),o=await M.getNotes();i(N.filter(f=>f.bookId===n.key)),u(o.filter(f=>f.bookId===n.key))}else i([]),u([])})()},[n]);const l=async v=>{const N=[...t],o=N.findIndex(f=>f.key===v.key);o>=0?N[o]=v:N.push(v),m(N),await M.saveBooks(N)},a=async v=>{const N=t.filter(A=>A.key!==v);m(N),await M.saveBooks(N);const o=await M.getReadingSessions(),f=await M.getNotes(),w=o.filter(A=>A.bookId!==v),S=f.filter(A=>A.bookId!==v);await M.saveReadingSessions(w),await M.saveNotes(S),n&&n.key===v&&(r(null),await M.setCurrentBook(null))},d=async v=>{r(v),await M.setCurrentBook(v)},x=async v=>{const N=await M.getReadingSessions(),o=N.findIndex(f=>f.id===v.id);o>=0?N[o]=v:N.push(v),await M.saveReadingSessions(N),n&&v.bookId===n.key&&i(N.filter(f=>f.bookId===n.key))},p=async v=>{const o=[...await M.getNotes(),v];await M.saveNotes(o),n&&v.bookId===n.key&&u(o.filter(f=>f.bookId===n.key))},h=async v=>{const o=(await M.getNotes()).map(f=>f.id===v.id?v:f);await M.saveNotes(o),n&&v.bookId===n.key&&u(o.filter(f=>f.bookId===n.key))},y=async v=>{const o=(await M.getNotes()).filter(f=>f.id!==v);await M.saveNotes(o),n&&u(o.filter(f=>f.bookId===n.key))};return e.jsx(nt.Provider,{value:{books:t,currentBook:n,sessions:s,notes:g,addBook:l,removeBook:a,setActiveBook:d,addSession:x,addNote:p,updateNote:h,deleteNote:y},children:c})},at=C.createContext(void 0),re=()=>{const c=C.useContext(at);if(!c)throw new Error("usePet must be used within a PetProvider");return c},ke=()=>({name:"Bookworm",level:1,experience:0,experienceToNext:100,happiness:100,hunger:50,energy:100,health:100,points:10,lastFed:new Date().toISOString(),lastPlayed:new Date().toISOString(),lastSlept:new Date().toISOString(),createdAt:new Date().toISOString(),totalBooksRead:0,totalReadingTime:0,evolutionStage:"egg",badges:[],mood:"content"}),ot=()=>({booksReadToday:0,readingTimeToday:0,streakDays:0,lastActiveDate:new Date().toISOString()}),hs=()=>{try{const c=localStorage.getItem("bookish_pet");if(c){const t=JSON.parse(c);return{...ke(),...t}}}catch(c){console.error("Error loading pet from storage:",c)}return ke()},xs=()=>{try{const c=localStorage.getItem("bookish_pet_stats");if(c)return JSON.parse(c)}catch(c){console.error("Error loading pet stats from storage:",c)}return ot()},fs=c=>{localStorage.setItem("bookish_pet",JSON.stringify(c))},gs=c=>{localStorage.setItem("bookish_pet_stats",JSON.stringify(c))},ps=({children:c})=>{const[t,m]=C.useState(hs),[n,r]=C.useState(xs);C.useEffect(()=>{fs(t)},[t]),C.useEffect(()=>{gs(n)},[n]),C.useEffect(()=>{const b=setInterval(()=>{const j=new Date,k=new Date(t.lastFed),D=(j.getTime()-k.getTime())/(1e3*60*60);D>1&&m(F=>{const I=Math.floor(D);return{...F,hunger:Math.max(0,F.hunger-I*2),energy:Math.max(0,F.energy-I),happiness:Math.max(0,F.happiness-I),mood:s(Math.max(0,F.happiness-I),Math.max(0,F.hunger-I*2),Math.max(0,F.energy-I))}});const E=j.toDateString(),_=new Date(n.lastActiveDate).toDateString();E!==_&&r(F=>({...F,booksReadToday:0,readingTimeToday:0,lastActiveDate:j.toISOString()}))},3e4);return()=>clearInterval(b)},[t.lastFed,n.lastActiveDate]);const s=(b,j,k)=>j<20?"hungry":k<20?"sleepy":b>80?"happy":b>60?"excited":b<30?"sad":"content",i=b=>100+b*50,g=(b,j)=>{let k=j,D=i(k);for(;b>=D;)k++,D=i(k);return{newLevel:k,newExpToNext:D}},u=b=>b<3?"egg":b<8?"baby":b<15?"child":b<25?"teen":b<40?"adult":"elder",l=()=>{const b=t.evolutionStage,j=t.mood,k={egg:{happy:"ðŸ¥š",content:"ðŸ¥š",sad:"ðŸ’”",excited:"âœ¨",sleepy:"ðŸ˜´",hungry:"ðŸ¥š"},baby:{happy:"ðŸ˜Š",content:"ðŸ›",sad:"ðŸ˜¢",excited:"ðŸ¤©",sleepy:"ðŸ˜´",hungry:"ðŸ˜‹"},child:{happy:"ðŸ˜„",content:"ðŸ¯",sad:"ðŸ˜­",excited:"ðŸ¤—",sleepy:"ðŸ’¤",hungry:"ðŸŽ"},teen:{happy:"ðŸ˜Ž",content:"ðŸ¦Š",sad:"ðŸ˜”",excited:"ðŸš€",sleepy:"ðŸ˜ª",hungry:"ðŸ•"},adult:{happy:"ðŸŒŸ",content:"ðŸ¦‰",sad:"ðŸ˜ž",excited:"ðŸŽ‰",sleepy:"ðŸ˜Œ",hungry:"ðŸ½ï¸"},elder:{happy:"ðŸ‘‘",content:"ðŸ‰",sad:"ðŸ˜Ÿ",excited:"ðŸŽŠ",sleepy:"ðŸ§˜",hungry:"ðŸ±"}};return k[b][j]||k[b].content},a=()=>{m(b=>{if(b.points<3)return b;const j=Math.min(100,b.hunger+30),k=Math.min(100,b.happiness+10),D=b.experience+5,{newLevel:E,newExpToNext:_}=g(D,b.level);return{...b,hunger:j,happiness:k,experience:D,level:E,experienceToNext:_,points:b.points-3,lastFed:new Date().toISOString(),evolutionStage:u(E),mood:s(k,j,b.energy)}})},d=()=>{m(b=>{if(b.points<5)return b;const j=Math.min(100,b.happiness+20),k=Math.max(0,b.energy-15),D=b.experience+10,{newLevel:E,newExpToNext:_}=g(D,b.level);return{...b,happiness:j,energy:k,experience:D,level:E,experienceToNext:_,points:b.points-5,lastPlayed:new Date().toISOString(),evolutionStage:u(E),mood:s(j,b.hunger,k)}})},x=()=>{m(b=>{const j=Math.min(100,b.energy+40),k=Math.min(100,b.health+10);return{...b,energy:j,health:k,lastSlept:new Date().toISOString(),mood:s(b.happiness,b.hunger,j)}})},p=(b,j=!1)=>{const E=Math.floor(b/5)+(j?50:0);E>0&&(m(_=>{const F=_.experience+E,I=Math.min(100,_.happiness+Math.floor(b/10)),U=_.totalReadingTime+b,{newLevel:L,newExpToNext:B}=g(F,_.level);return{..._,experience:F,level:L,experienceToNext:B,happiness:I,totalReadingTime:U,evolutionStage:u(L),mood:s(I,_.hunger,_.energy)}}),r(_=>({..._,readingTimeToday:_.readingTimeToday+b,lastActiveDate:new Date().toISOString()})))},h=()=>{m(b=>{const j=b.experience+50,k=Math.min(100,b.happiness+25),D=b.totalBooksRead+1,E=20,{newLevel:_,newExpToNext:F}=g(j,b.level),I=[...b.badges];return D===1&&!I.includes("first-book")&&I.push("first-book"),D===10&&!I.includes("book-lover")&&I.push("book-lover"),D===50&&!I.includes("bookworm")&&I.push("bookworm"),{...b,experience:j,level:_,experienceToNext:F,happiness:k,points:b.points+E,totalBooksRead:D,badges:I,evolutionStage:u(_),mood:s(k,b.hunger,b.energy)}}),r(b=>({...b,booksReadToday:b.booksReadToday+1,lastActiveDate:new Date().toISOString()}))},y=()=>({happy:"Your pet is very happy! Keep up the great reading!",excited:"Your pet is excited about your reading progress!",content:"Your pet is content and enjoying your company.",sad:"Your pet seems sad. Try feeding or playing with them!",sleepy:"Your pet is tired. Maybe they need some rest?",hungry:"Your pet is hungry! Don't forget to feed them."})[t.mood],v=()=>{const b=u(t.level+1),j=t.level<3?3:t.level<8?8:t.level<15?15:t.level<25?25:40;return{current:t.level,required:j,stage:b}},N=()=>{const b=t.level<3?3:t.level<8?8:t.level<15?15:t.level<25?25:40;return t.level>=b&&t.evolutionStage!==u(t.level)},o=()=>{m(b=>({...b,evolutionStage:u(b.level),happiness:100,health:100}))},f=()=>{const b=ke();m(b),r(ot())},w=b=>{m(j=>({...j,name:b}))},S=()=>t.happiness<30?"sad":t.happiness<70?"neutral":"happy",A=()=>t.experience/t.experienceToNext*100;return e.jsx(at.Provider,{value:{pet:t,petStats:n,feedPet:a,playWithPet:d,petSleep:x,updatePetFromReading:p,updatePetFromBookCompletion:h,getPetMood:y,getPetEvolutionRequirement:v,resetPet:f,updatePetName:w,getPetEmoji:l,canEvolve:N,evolvePet:o,getPetHappinessLevel:S,getLevelProgress:A},children:c})},X={GUEST_PROFILE:"bookish-guest-profile",GUEST_BOOKS:"bookish-guest-books",GUEST_READING_SESSIONS:"bookish-guest-reading-sessions",GUEST_NOTES:"bookish-guest-notes",GUEST_PET:"bookish-guest-pet"};class Ae{static get(t){try{const m=localStorage.getItem(t);return m?JSON.parse(m):null}catch(m){return console.error("Error reading from localStorage:",m),null}}static set(t,m){try{return localStorage.setItem(t,JSON.stringify(m)),!0}catch(n){return console.error("Error writing to localStorage:",n),!1}}static remove(t){try{return localStorage.removeItem(t),!0}catch(m){return console.error("Error removing from localStorage:",m),!1}}static clear(){try{return Object.values(X).forEach(t=>{localStorage.removeItem(t)}),!0}catch(t){return console.error("Error clearing localStorage:",t),!1}}static getGuestProfile(){return this.get(X.GUEST_PROFILE)}static setGuestProfile(t){return this.set(X.GUEST_PROFILE,{...t,lastUpdated:new Date().toISOString()})}static getGuestBooks(){return this.get(X.GUEST_BOOKS)||[]}static setGuestBooks(t){return this.set(X.GUEST_BOOKS,{books:t,lastUpdated:new Date().toISOString()})}static getGuestPet(){return this.get(X.GUEST_PET)}static setGuestPet(t){return this.set(X.GUEST_PET,{...t,lastUpdated:new Date().toISOString()})}}const it=C.createContext(void 0),ys={isAuthenticated:!1,user:null,isLoading:!0,error:null},bs=(c,t)=>{switch(t.type){case"AUTH_START":return{...c,isLoading:!0,error:null};case"AUTH_SUCCESS":return{...c,isAuthenticated:!0,user:t.payload,isLoading:!1,error:null};case"AUTH_FAILURE":return{...c,isAuthenticated:!1,user:null,isLoading:!1,error:t.payload};case"SIGN_OUT":return{...c,isAuthenticated:!1,user:null,isLoading:!1,error:null};case"CLEAR_ERROR":return{...c,error:null};case"UPDATE_USER":return{...c,user:c.user?{...c.user,...t.payload}:null};default:return c}},vs=({children:c})=>{const[t,m]=C.useReducer(bs,ys);C.useEffect(()=>{(async()=>{try{const d=new Promise((h,y)=>setTimeout(()=>y(new Error("Authentication check timeout")),5e3)),x=$.recallUser(),p=await Promise.race([x,d]);if(p&&p.success&&p.user){const h=new Promise((y,v)=>setTimeout(()=>v(new Error("Profile load timeout")),3e3));try{const y=await Promise.race([$.getProfile(),h]),v={...p.user,profile:y&&y.success?y.profile:void 0};m({type:"AUTH_SUCCESS",payload:v})}catch{const v={...p.user,profile:void 0};m({type:"AUTH_SUCCESS",payload:v})}}else m({type:"AUTH_FAILURE",payload:""})}catch(d){console.log("GunJS auth check failed (servers may be down):",d),m({type:"AUTH_FAILURE",payload:""})}})()},[]);const l={...t,signIn:async(a,d)=>{m({type:"AUTH_START"});try{const x=await $.signIn(a,d);if(x.success&&x.user){const p=await $.getProfile(),h={...x.user,profile:p.success?p.profile:void 0};return m({type:"AUTH_SUCCESS",payload:h}),{success:!0}}else return m({type:"AUTH_FAILURE",payload:x.error||"Sign in failed"}),{success:!1,error:x.error}}catch{const p="An unexpected error occurred";return m({type:"AUTH_FAILURE",payload:p}),{success:!1,error:p}}},signUp:async(a,d)=>{m({type:"AUTH_START"});try{const x=await $.signUp(a,d);return x.success?(m({type:"AUTH_FAILURE",payload:""}),{success:!0}):(m({type:"AUTH_FAILURE",payload:x.error||"Sign up failed"}),{success:!1,error:x.error})}catch{const p="An unexpected error occurred";return m({type:"AUTH_FAILURE",payload:p}),{success:!1,error:p}}},signOut:()=>{$.signOut(),m({type:"SIGN_OUT"})},updateProfile:async a=>{try{const d=await $.updateProfile(a);return d.success?(m({type:"UPDATE_USER",payload:{profile:a}}),{success:!0}):{success:!1,error:d.error}}catch{return{success:!1,error:"Failed to update profile"}}},clearError:()=>{m({type:"CLEAR_ERROR"})},continueAsGuest:()=>{let a={displayName:"Guest User",bio:"Browsing as a guest",favoriteGenres:[],readingGoal:0};const d=Ae.getGuestProfile();d&&(a={displayName:d.displayName||"Guest User",bio:d.bio||"Browsing as a guest",favoriteGenres:d.favoriteGenres||[],readingGoal:d.readingGoal||0});const x={id:"guest-"+Date.now(),username:"Guest User",email:"",createdAt:new Date().toISOString(),profile:a};m({type:"AUTH_SUCCESS",payload:x})}};return e.jsx(it.Provider,{value:l,children:c})},pe=()=>{const c=C.useContext(it);if(c===void 0)throw new Error("useAuth must be used within an AuthProvider");return c},ws=({onClose:c})=>{const[t,m]=C.useState(!1),[n,r]=C.useState(""),[s,i]=C.useState(""),[g,u]=C.useState(!1),[l,a]=C.useState(!1),{signIn:d,signUp:x,error:p,clearError:h,continueAsGuest:y}=pe(),v=async f=>{if(f.preventDefault(),!(!n.trim()||!s.trim())){a(!0),h();try{let w;t?(w=await x(n.trim(),s),w.success&&(m(!1),i(""),alert("Account created successfully! Please sign in."))):(w=await d(n.trim(),s),w.success&&c&&c())}finally{a(!1)}}},N=()=>{m(!t),i(""),h()},o=()=>{y(),c&&c()};return e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md mx-auto border border-[#F0EDE8]",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"bg-[#F0EDE8] rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:e.jsx(H,{className:"w-8 h-8 text-[#8B7355]"})}),e.jsx("h2",{className:"font-serif text-2xl font-medium text-[#3A3A3A] mb-2",children:t?"Join Bookish":"Welcome Back"}),e.jsx("p",{className:"text-[#8B7355]",children:t?"Start your reading journey with your virtual pet companion":"Continue your reading adventure with your book buddy"})]}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:["        ",e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-[#3A3A3A] mb-2",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#8B7355]"}),e.jsx("input",{id:"username",type:"text",value:n,onChange:f=>r(f.target.value),className:"pl-10 pr-4 py-3 w-full border-2 border-[#F0EDE8] rounded-xl focus:ring-2 focus:ring-[#8B7355] focus:border-[#8B7355] transition-colors bg-[#F7F5F3] text-[#3A3A3A]",placeholder:"Enter your username",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-[#3A3A3A] mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(bt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#8B7355]"}),"            ",e.jsx("input",{id:"password",type:g?"text":"password",value:s,onChange:f=>i(f.target.value),className:"pl-10 pr-12 py-3 w-full border-2 border-[#F0EDE8] rounded-xl focus:ring-2 focus:ring-[#8B7355] focus:border-[#8B7355] transition-colors bg-[#F7F5F3] text-[#3A3A3A]",placeholder:t?"Create a strong password":"Enter your password",minLength:t?8:void 0,required:!0}),e.jsx("button",{type:"button",onClick:()=>u(!g),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-[#8B7355] hover:text-[#3A3A3A] transition-colors",children:g?e.jsx(vt,{className:"w-5 h-5"}):e.jsx(wt,{className:"w-5 h-5"})})]}),t&&e.jsx("p",{className:"text-sm text-[#8B7355] mt-1",children:"Password must be at least 8 characters long"})]}),p&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl text-sm",children:p}),"        ",e.jsx("button",{type:"submit",disabled:l,className:"w-full bg-[#8B7355] text-white py-3 px-4 rounded-xl font-medium hover:bg-[#6B5B45] focus:ring-2 focus:ring-[#8B7355] focus:ring-offset-2 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:l?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),t?"Creating Account...":"Signing In..."]}):t?"Create Account":"Sign In"}),"        ",e.jsx("button",{type:"button",onClick:o,className:"w-full bg-gray-100 text-[#8B7355] py-3 px-4 rounded-xl font-medium hover:bg-gray-200 focus:ring-2 focus:ring-gray-300 focus:ring-offset-2 transition-all duration-200 border border-gray-200",children:"Continue as Guest"}),e.jsx("p",{className:"text-sm text-center text-[#8B7355] mt-2",children:"Guest mode: Explore the app with local storage (data saved on this device only)"})]}),"      ",e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-[#8B7355]",children:[t?"Already have an account?":"Don't have an account?"," ",e.jsx("button",{type:"button",onClick:N,className:"text-[#3A3A3A] hover:text-[#8B7355] font-medium transition-colors underline",children:t?"Sign In":"Sign Up"})]})}),"      ",c&&e.jsx("button",{onClick:c,className:"absolute top-4 right-4 text-[#8B7355] hover:text-[#3A3A3A] transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},js=({children:c,fallback:t})=>{const{isAuthenticated:m,isLoading:n}=pe();return n?e.jsx("div",{className:"min-h-screen bg-[#F7F5F3] flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 text-center border border-[#F0EDE8]",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#8B7355] mx-auto mb-4"}),e.jsx("p",{className:"text-[#8B7355] font-medium",children:"Loading your reading world..."})]})}):m?e.jsx(e.Fragment,{children:c}):t||e.jsx("div",{className:"min-h-screen bg-[#F7F5F3] flex items-center justify-center p-4",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsx(ws,{})})})},Ns=()=>{const c=Y(),t=[{icon:H,title:"Track Your Reading",description:"Organize your books into 'Want to Read', 'Currently Reading', and 'Completed' categories with beautiful progress tracking."},{icon:Xe,title:"Reading Sessions",description:"Time your reading sessions and watch your progress grow. See exactly how much time you've invested in each book."},{icon:te,title:"Take Notes",description:"Capture your thoughts, favorite quotes, and insights as you read. Never lose track of those brilliant moments."},{icon:we,title:"Virtual Pet Companion",description:"Care for your adorable reading companion that grows and evolves as you complete books and reading sessions."},{icon:fe,title:"Achievement System",description:"Unlock achievements and watch your reading streaks grow. Gamify your reading journey and stay motivated."},{icon:jt,title:"Beautiful Interface",description:"Enjoy a warm, book-inspired design that makes reading tracking a delightful experience every day."}],m=[{icon:je,title:"Build Better Habits",description:"Turn reading into a consistent, rewarding habit with gentle gamification and progress tracking."},{icon:Nt,title:"Stay Motivated",description:"Your virtual pet and achievement system keep you engaged and excited about your reading journey."},{icon:St,title:"Mindful Reading",description:"Take notes and track your thoughts to engage more deeply with every book you read."}];return e.jsxs("div",{className:"min-h-screen bg-[#F7F5F3] max-w-full overflow-x-hidden",children:[e.jsx("div",{className:"relative overflow-hidden",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-12 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-[#8B7355] rounded-2xl flex items-center justify-center",children:e.jsx(H,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"font-serif text-4xl lg:text-6xl font-bold text-[#3A3A3A] mb-2",children:"Bookish"}),e.jsx("p",{className:"text-lg lg:text-xl text-[#8B7355] font-medium",children:"Your Reading Companion"})]}),e.jsxs("div",{className:"text-center mb-8 max-w-2xl mx-auto",children:[e.jsx("h2",{className:"font-serif text-2xl lg:text-3xl font-medium text-[#3A3A3A] mb-4 leading-tight",children:"Transform Your Reading Journey with a Delightful Digital Companion"}),e.jsx("p",{className:"text-[#8B7355] leading-relaxed mb-6 text-base lg:text-lg",children:"Track your books, time your sessions, take meaningful notes, and care for your virtual pet as you build the reading habit you've always wanted."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsxs("button",{onClick:()=>c("/"),className:"bg-[#8B7355] text-white px-8 py-4 rounded-xl font-medium text-lg flex items-center gap-2 justify-center hover:bg-[#7A6349] transition-colors shadow-lg",children:["Start Reading Today",e.jsx(Ce,{className:"w-5 h-5"})]}),e.jsx("button",{onClick:()=>c("/search"),className:"bg-transparent border-2 border-[#8B7355] text-[#8B7355] px-8 py-4 rounded-xl font-medium text-lg hover:bg-[#8B7355] hover:text-white transition-colors",children:"Browse Books"})]})]}),e.jsx("div",{className:"relative mb-12 max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 border-4 border-[#F0EDE8]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-3 h-3 bg-red-400 rounded-full"}),e.jsx("div",{className:"w-3 h-3 bg-yellow-400 rounded-full"}),e.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-[#F0EDE8] rounded w-3/4"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-12 h-16 bg-[#8B7355] rounded"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-3 bg-[#F0EDE8] rounded w-full"}),e.jsx("div",{className:"h-2 bg-[#F0EDE8] rounded w-2/3"}),e.jsx("div",{className:"h-2 bg-[#E59554] rounded w-1/2"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-12 h-16 bg-[#D2691E] rounded"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-3 bg-[#F0EDE8] rounded w-full"}),e.jsx("div",{className:"h-2 bg-[#F0EDE8] rounded w-2/3"}),e.jsx("div",{className:"h-2 bg-[#E59554] rounded w-3/4"})]})]})]})]})})]})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-12 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h3",{className:"font-serif text-2xl lg:text-3xl font-medium text-[#3A3A3A] mb-3",children:"Everything You Need"}),e.jsx("p",{className:"text-[#8B7355] text-base lg:text-lg",children:"Powerful features designed to enhance your reading experience"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((n,r)=>e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-[#F0EDE8] rounded-xl flex items-center justify-center mb-4",children:e.jsx(n.icon,{className:"w-8 h-8 text-[#8B7355]"})}),e.jsx("h4",{className:"font-serif font-medium text-[#3A3A3A] mb-3 text-lg",children:n.title}),e.jsx("p",{className:"text-sm text-[#8B7355] leading-relaxed",children:n.description})]})},r))})]}),e.jsx("div",{className:"bg-[#F0EDE8] py-16",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h3",{className:"font-serif text-2xl lg:text-3xl font-medium text-[#3A3A3A] mb-3",children:"Why Choose Bookish?"}),e.jsx("p",{className:"text-[#8B7355] text-base lg:text-lg",children:"Join thousands of readers who've transformed their reading habits"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:m.map((n,r)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-[#8B7355] rounded-2xl flex items-center justify-center mx-auto mb-6",children:e.jsx(n.icon,{className:"w-10 h-10 text-white"})}),e.jsx("h4",{className:"font-serif font-medium text-[#3A3A3A] mb-3 text-lg",children:n.title}),e.jsx("p",{className:"text-sm text-[#8B7355] leading-relaxed",children:n.description})]},r))})]})}),e.jsx("div",{className:"max-w-4xl mx-auto px-6 py-16 lg:px-8",children:e.jsxs("div",{className:"bg-gradient-to-r from-[#8B7355] to-[#D2691E] rounded-2xl p-8 lg:p-12 text-white text-center",children:[e.jsx("h3",{className:"font-serif text-xl lg:text-2xl font-medium mb-8",children:"Join the Reading Revolution"}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl lg:text-4xl font-bold mb-1",children:"10K+"}),e.jsx("div",{className:"text-sm opacity-90",children:"Books Tracked"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl lg:text-4xl font-bold mb-1",children:"5K+"}),e.jsx("div",{className:"text-sm opacity-90",children:"Happy Readers"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl lg:text-4xl font-bold mb-1",children:"50K+"}),e.jsx("div",{className:"text-sm opacity-90",children:"Reading Hours"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl lg:text-4xl font-bold mb-1",children:"25K+"}),e.jsx("div",{className:"text-sm opacity-90",children:"Notes Written"})]})]}),e.jsxs("button",{onClick:()=>c("/"),className:"bg-white text-[#8B7355] px-8 py-4 rounded-xl font-medium flex items-center gap-2 mx-auto hover:bg-gray-50 transition-colors text-lg",children:["Get Started Free",e.jsx(Ce,{className:"w-5 h-5"})]})]})}),e.jsx("div",{className:"bg-[#3A3A3A] py-16",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-6 text-center lg:px-8",children:[e.jsx("h3",{className:"font-serif text-2xl lg:text-3xl font-medium text-white mb-4",children:"Ready to Begin?"}),e.jsx("p",{className:"text-gray-300 mb-8 leading-relaxed text-base lg:text-lg max-w-2xl mx-auto",children:"Start your reading journey today. Search for your first book, meet your virtual companion, and begin building the reading habit that will last a lifetime."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center max-w-md mx-auto",children:[e.jsx("button",{onClick:()=>c("/"),className:"flex-1 bg-[#D2691E] text-white px-6 py-4 rounded-xl font-medium hover:bg-[#B8541A] transition-colors",children:"Start Your Journey"}),e.jsx("button",{onClick:()=>c("/library"),className:"flex-1 bg-transparent border-2 border-gray-500 text-gray-300 px-6 py-4 rounded-xl font-medium hover:border-gray-400 hover:text-gray-200 transition-colors",children:"View Library"})]})]})})]})},Ss=({greeting:c})=>{var i;const t=Y(),{pet:m}=re(),{user:n}=pe(),r=(i=n==null?void 0:n.id)==null?void 0:i.startsWith("guest-"),s=()=>{const g=m.mood;return{happy:"ðŸ˜Š",excited:"ðŸ¤©",content:"ðŸ˜Œ",sad:"ðŸ˜¢",sleepy:"ðŸ˜´",hungry:"ðŸŽ"}[g]||"ðŸ˜Œ"};return e.jsx("header",{className:"p-4 bg-[#F7F5F3]",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"font-serif text-xl font-medium text-[#3A3A3A]",children:c}),e.jsx("p",{className:"text-sm text-[#8B7355]",children:"Ready to dive into a story?"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-[#F0EDE8] rounded-lg px-3 py-2 cursor-pointer hover:bg-[#E8E3DD] transition-colors",onClick:()=>t("/pet"),children:[e.jsx("span",{className:"text-lg",children:s()}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs font-medium text-[#3A3A3A]",children:m.name}),e.jsxs("p",{className:"text-xs text-[#8B7355]",children:["Lv.",m.level]})]})]}),"          ",e.jsx("button",{className:`w-8 h-8 rounded-full flex items-center justify-center transition-colors ${r?"bg-orange-100 hover:bg-orange-200":"bg-[#F0EDE8] hover:bg-[#E8E3DD]"}`,onClick:()=>t("/profile"),title:r?"Guest User":"Profile",children:e.jsx(Ve,{className:`w-5 h-5 ${r?"text-orange-600":"text-[#8B7355]"}`})})]})]})})},ks=({onContinueReading:c})=>{const{currentBook:t,sessions:m,setActiveBook:n}=Z(),[r,s]=C.useState(!0);if(C.useEffect(()=>{if(t){const p=JSON.parse(localStorage.getItem("bookish_books")||"[]").some(h=>h.key===t.key);s(p),p||n(null)}},[t,n]),!t||!r)return e.jsx("div",{className:"p-4 bg-[#F0EDE8] rounded-xl shadow-sm",children:e.jsx("div",{className:"flex items-center justify-center p-6 border-2 border-dashed border-[#8B7355] rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx(H,{className:"w-8 h-8 mx-auto text-[#8B7355] mb-2"}),e.jsx("h3",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-1",children:"No book selected"}),e.jsx("p",{className:"text-sm text-[#8B7355]",children:"Search for a book to start reading"})]})})});const i=[...m].sort((x,p)=>new Date(p.startTime).getTime()-new Date(x.startTime).getTime())[0],g=(i==null?void 0:i.endPage)||(i==null?void 0:i.startPage)||1,u=t.number_of_pages_median||0,l=u>0?Math.min(Math.round(g/u*100),100):0,a=u>0,d=a&&l>0;return e.jsxs("div",{className:"p-4 bg-[#F0EDE8] rounded-xl shadow-sm",children:[e.jsx("h2",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-3",children:"Currently Reading"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-24 h-36 rounded-md overflow-hidden shadow-md flex-shrink-0",children:t.cover_i?e.jsx("img",{src:`https://covers.openlibrary.org/b/id/${t.cover_i}-M.jpg`,alt:t.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-[#8B7355] flex items-center justify-center text-white p-2",children:e.jsx("span",{className:"text-xs text-center font-serif",children:t.title})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-serif text-base font-medium text-[#3A3A3A] line-clamp-2 mb-1",children:t.title}),t.author_name&&t.author_name.length>0&&e.jsxs("p",{className:"text-sm text-[#8B7355] mb-2",children:["by ",t.author_name[0]]}),d?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-[#8B7355] mb-2",children:[e.jsxs("span",{children:[l,"%"]}),e.jsx("div",{className:"flex-1 h-1.5 bg-[#F7F5F3] rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-[#E59554] rounded-full transition-all duration-300 ease-out",style:{width:`${l}%`}})})]}),e.jsxs("div",{className:"text-xs text-[#8B7355] mb-4",children:["Page ",g," of ",u]})]}):a?e.jsxs("div",{className:"text-xs text-[#8B7355] mb-4",children:["Page ",g," of ",u]}):e.jsxs("div",{className:"text-xs text-[#8B7355] mb-4",children:["Currently on page ",g,e.jsx("div",{className:"text-xs text-[#8B7355] opacity-75 mt-1",children:"Page count unavailable"})]}),e.jsxs("button",{onClick:c,className:"w-full py-2 px-4 bg-[#D2691E] text-white rounded-lg text-sm font-medium hover:bg-[#A0522D] transition-colors flex items-center justify-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"Continue Reading"]})]})]})]})},he=({icon:c,value:t,label:m,color:n})=>e.jsxs("div",{className:"flex flex-col items-center p-3 bg-white rounded-xl shadow-sm",children:[e.jsx("div",{className:`w-8 h-8 flex items-center justify-center rounded-full ${n} mb-1`,children:c}),e.jsx("span",{className:"font-serif text-lg font-medium text-[#3A3A3A]",children:t}),e.jsx("span",{className:"text-xs text-[#8B7355]",children:m})]}),As=()=>{const c=st(),t=rt(),m=n=>{if(n<60)return`${n} min`;const r=Math.floor(n/60),s=n%60;return s===0?`${r} hrs`:`${r}.${Math.floor(s/6)}`};return e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(he,{icon:e.jsx(se,{className:"w-5 h-5 text-white"}),value:m(c.readingTimeToday),label:"Today",color:"bg-[#E59554]"}),e.jsx(he,{icon:e.jsx(se,{className:"w-5 h-5 text-white"}),value:m(c.readingTimeThisWeek),label:"This Week",color:"bg-[#CD853F]"}),e.jsx(he,{icon:e.jsx(kt,{className:"w-5 h-5 text-white"}),value:c.totalBooksRead,label:"Books Read",color:"bg-[#8B7355]"}),e.jsx(he,{icon:e.jsx(At,{className:"w-5 h-5 text-white"}),value:t.currentStreak,label:"Streak",color:"bg-[#D2691E]"})]})},xe=({icon:c,label:t,onClick:m})=>e.jsxs("button",{onClick:m,className:"flex flex-col items-center justify-center p-4 bg-white rounded-xl shadow-sm hover:bg-[#F0EDE8] transition-colors",children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center rounded-full bg-[#F7F5F3] mb-2",children:e.jsx(c,{className:"w-5 h-5 text-[#8B7355]"})}),e.jsx("span",{className:"text-sm text-[#3A3A3A]",children:t})]}),Es=({type:c,title:t,timestamp:m,duration:n})=>{const r=()=>{switch(c){case"reading":return e.jsx(se,{className:"w-4 h-4 text-[#E59554]"});case"note":return e.jsx(De,{className:"w-4 h-4 text-[#8B7355]"});case"completed":return e.jsx(De,{className:"w-4 h-4 text-[#D2691E]"})}},s=i=>{const g=new Date,u=new Date(i),l=Math.floor((g.getTime()-u.getTime())/(1e3*60));if(l<1)return"just now";if(l<60)return`${l} minute${l===1?"":"s"} ago`;const a=Math.floor(l/60);if(a<24)return`${a} hour${a===1?"":"s"} ago`;const d=Math.floor(a/24);return`${d} day${d===1?"":"s"} ago`};return e.jsxs("div",{className:"flex items-center gap-3 p-3 border-b border-[#F0EDE8]",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-[#F7F5F3] flex items-center justify-center flex-shrink-0",children:r()}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-[#3A3A3A]",children:t}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-[#8B7355]",children:[e.jsx("span",{children:s(m)}),n&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[n," min"]})]})]})]})]})},Bs=()=>{const c=Y(),m=[...Be()].sort((r,s)=>new Date(s.startTime).getTime()-new Date(r.startTime).getTime()).slice(0,5),n=()=>{const r=new Date().getHours();return r<12?"Good morning":r<18?"Good afternoon":"Good evening"};return e.jsxs("div",{className:"max-w-md mx-auto min-h-screen bg-[#F7F5F3] pb-6",children:[e.jsx(Ss,{greeting:n()}),e.jsxs("main",{className:"px-4 py-2 space-y-6",children:[e.jsx(ks,{onContinueReading:()=>c("/reading")}),e.jsxs("section",{children:[e.jsx("h2",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-3",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(xe,{icon:oe,label:"Find Books",onClick:()=>c("/search")}),e.jsx(xe,{icon:te,label:"My Notes",onClick:()=>c("/notes")}),e.jsx(xe,{icon:Et,label:"My Library",onClick:()=>c("/library")}),e.jsx(xe,{icon:Bt,label:"Statistics",onClick:()=>c("/stats")})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-3",children:"Your Progress"}),e.jsx(As,{})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-1",children:"Recent Activity"}),m.length>0?e.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:m.map(r=>e.jsx(Es,{type:"reading",title:"Reading session completed",timestamp:r.endTime||r.startTime,duration:r.duration||0},r.id))}):e.jsx("p",{className:"text-sm text-[#8B7355] p-4 bg-white rounded-xl shadow-sm",children:"No recent activity. Start reading to track your progress!"})]}),e.jsx("section",{className:"text-center py-4",children:e.jsx("button",{onClick:()=>c("/welcome"),className:"text-sm text-[#8B7355] hover:text-[#3A3A3A] transition-colors underline",children:"Learn more about Bookish features"})})]})]})},Cs="modulepreload",Ds=function(c){return"/Bookish/"+c},Ye={},Ke=function(t,m,n){let r=Promise.resolve();if(m&&m.length>0){let i=function(l){return Promise.all(l.map(a=>Promise.resolve(a).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),u=(g==null?void 0:g.nonce)||(g==null?void 0:g.getAttribute("nonce"));r=i(m.map(l=>{if(l=Ds(l),l in Ye)return;Ye[l]=!0;const a=l.endsWith(".css"),d=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const x=document.createElement("link");if(x.rel=a?"stylesheet":Cs,a||(x.as="script"),x.crossOrigin="",x.href=l,u&&x.setAttribute("nonce",u),document.head.appendChild(x),a)return new Promise((p,h)=>{x.addEventListener("load",p),x.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(i){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=i,window.dispatchEvent(g),!g.defaultPrevented)throw i}return r.then(i=>{for(const g of i||[])g.status==="rejected"&&s(g.reason);return t().catch(s)})},_s=()=>{const c=Y(),[t,m]=C.useState(""),[n,r]=C.useState([]),[s,i]=C.useState(!1),[g,u]=C.useState("general"),[l,a]=C.useState(!1);C.useEffect(()=>()=>{if(typeof window<"u"&&window.Quagga)try{window.Quagga.stop()}catch{}},[]);const d=async f=>{if(f.preventDefault(),!!t.trim()){i(!0);try{let w;g==="subject"?w=await ns(t):w=await Zt(t),r(w)}catch(w){console.error("Error searching books:",w)}finally{i(!1)}}},x=async()=>{try{a(!0),setTimeout(()=>{h()},300)}catch(f){console.error("Error starting camera:",f),alert("Unable to access camera. Please check permissions."),a(!1)}},p=()=>{try{Ke(()=>import("./quagga.min-jt3L0bPw.js").then(f=>f.q),__vite__mapDeps([0,1])).then(f=>{const w=f.default;w.stop(),w.offDetected(),w.offProcessed(),console.log("Quagga stopped successfully")}).catch(f=>{console.log("Error stopping Quagga:",f)})}catch(f){console.log("Quagga cleanup error:",f)}a(!1)},h=async()=>{try{const f=document.querySelector("#barcode-scanner");if(!f){console.error("Scanner element not found");return}const S=(await Ke(()=>import("./quagga.min-jt3L0bPw.js").then(j=>j.q),__vite__mapDeps([0,1]))).default,A={inputStream:{name:"Live",type:"LiveStream",target:f,constraints:{width:480,height:320,facingMode:"environment"}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:1,frequency:5,decoder:{readers:["ean_reader","ean_8_reader"]},locate:!0};console.log("Initializing Quagga with config:",A),S.init(A,j=>{if(j){console.error("QuaggaJS initialization failed:",j),alert("Camera access failed. Please ensure you have granted camera permissions and are using HTTPS."),p();return}console.log("QuaggaJS initialized successfully"),S.start(),console.log("QuaggaJS started")}),S.onDetected(j=>{const k=j.codeResult.code;console.log("Barcode detected:",k);const D=v(k);console.log("Cleaned barcode:",D),y(D)?(console.log("Valid ISBN detected, searching..."),N(D),p()):console.log("Invalid ISBN format, continuing scan...")});let b=0;S.onProcessed(j=>{b++,b%30===0&&console.log("Processing frames... Count:",b),j&&j.codeResult&&j.codeResult.code&&console.log("Potential code detected:",j.codeResult.code)})}catch(f){console.error("Error loading Quagga:",f),alert("Failed to load barcode scanner. Please try again."),p()}},y=f=>{const w=f.replace(/[^0-9X]/gi,"");return w.length===10||w.length===13},v=f=>f.replace(/[^0-9X]/gi,""),N=async f=>{i(!0);try{const w=await as(f);w?(r([w]),m(f)):alert("No book found for this barcode")}catch(w){console.error("Error searching by ISBN:",w),alert("Error scanning barcode")}finally{i(!1)}},o=f=>{c(`/book?book=${encodeURIComponent(f.key)}`,{state:{bookData:f}})};return e.jsxs("div",{className:"max-w-md mx-auto min-h-screen bg-[#F7F5F3] pb-6",children:[e.jsxs("header",{className:"page-header p-4 bg-[#F0EDE8] shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("button",{onClick:()=>c(-1),className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-[#F7F5F3] transition-colors",children:e.jsx(W,{className:"w-5 h-5 text-[#8B7355]"})}),e.jsxs("form",{onSubmit:d,className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:t,onChange:f=>m(f.target.value),placeholder:g==="subject"?"Search by subject (e.g. science, fiction)...":"Search for books...",className:"w-full py-2 px-4 pr-10 bg-white border border-[#E5E5E5] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#E59554] text-[#3A3A3A]"}),e.jsx("button",{type:"submit",className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-7 h-7 flex items-center justify-center rounded-full bg-[#E59554] text-white",children:e.jsx(oe,{className:"w-4 h-4"})})]}),e.jsx("button",{onClick:x,className:"w-10 h-10 flex items-center justify-center rounded-full bg-[#E59554] text-white hover:bg-[#D2691E] transition-colors",children:e.jsx(_e,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex bg-white rounded-lg p-1",children:[e.jsxs("button",{onClick:()=>u("general"),className:`flex-1 flex items-center justify-center gap-2 py-2 px-3 rounded-md text-sm font-medium transition-colors ${g==="general"?"bg-[#E59554] text-white":"text-[#8B7355] hover:bg-[#F7F5F3]"}`,children:[e.jsx(oe,{className:"w-4 h-4"}),"General"]}),e.jsxs("button",{onClick:()=>u("subject"),className:`flex-1 flex items-center justify-center gap-2 py-2 px-3 rounded-md text-sm font-medium transition-colors ${g==="subject"?"bg-[#E59554] text-white":"text-[#8B7355] hover:bg-[#F7F5F3]"}`,children:[e.jsx(Te,{className:"w-4 h-4"}),"Subject"]})]})]}),l&&e.jsx("div",{className:"modal-overlay fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg p-4 m-4 max-w-sm w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-serif text-lg font-medium text-[#3A3A3A]",children:"Scan ISBN Barcode"}),e.jsx("button",{onClick:p,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-[#F7F5F3] transition-colors",children:e.jsx(Ee,{className:"w-5 h-5 text-[#8B7355]"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{id:"barcode-scanner",className:"w-full h-48 bg-black rounded-lg overflow-hidden relative",children:e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white text-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-2",children:"ðŸ“·"}),e.jsx("div",{children:"Initializing camera..."}),e.jsx("div",{className:"text-xs mt-1",children:"Make sure to allow camera access"})]})})}),e.jsx("div",{className:"absolute inset-0 border-2 border-[#E59554] rounded-lg pointer-events-none",children:e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-32 h-16 border-2 border-white rounded",children:e.jsx("div",{className:"absolute inset-0 border-t-2 border-[#E59554] animate-pulse"})})})]}),e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx("p",{className:"text-sm text-[#8B7355] mb-2",children:"Point camera at book's barcode"}),e.jsx("p",{className:"text-xs text-[#8B7355] mb-2",children:"Hold steady and ensure good lighting"}),e.jsx("p",{className:"text-xs text-[#8B7355] italic",children:"Looking for ISBN-13 barcodes (978...)"}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsx("button",{onClick:()=>{const f=prompt("Enter ISBN manually (if barcode scan fails):");f&&(N(f.trim()),p())},className:"text-xs text-[#E59554] underline",children:"Enter ISBN manually"})})]})]})}),e.jsx("main",{className:"px-4 py-4",children:s?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-[#E59554]"})}):n.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"font-serif text-lg font-medium text-[#3A3A3A]",children:g==="subject"?"Books in Subject":"Search Results"}),e.jsx("div",{className:"space-y-3",children:n.map(f=>e.jsxs("div",{onClick:()=>o(f),className:"flex gap-4 p-4 bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow cursor-pointer",children:[e.jsxs("div",{className:"w-12 h-16 bg-[#F0EDE8] rounded flex-shrink-0 overflow-hidden",children:[f.cover_i?e.jsx("img",{src:`https://covers.openlibrary.org/b/id/${f.cover_i}-M.jpg`,alt:f.title,className:"w-full h-full object-cover",onError:w=>{var A;const S=w.target;S.style.display="none",(A=S.nextElementSibling)==null||A.classList.remove("hidden")}}):null,e.jsx("div",{className:`w-full h-full flex items-center justify-center ${f.cover_i?"hidden":""}`,children:e.jsx(H,{className:"w-6 h-6 text-[#8B7355]"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-serif font-medium text-[#3A3A3A] text-sm leading-tight mb-1 truncate",children:f.title}),f.author_name&&e.jsxs("p",{className:"text-xs text-[#8B7355] mb-2 truncate",children:["by ",f.author_name[0]]}),f.first_publish_year&&e.jsx("p",{className:"text-xs text-[#8B7355]",children:f.first_publish_year})]})]},f.key))})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-6 text-center",children:[e.jsx(oe,{className:"w-12 h-12 text-[#8B7355] mb-4 opacity-70"}),e.jsx("h2",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-2",children:"Find your next great read"}),e.jsx("p",{className:"text-sm text-[#8B7355] max-w-xs mb-4",children:"Search for books by title, author, ISBN, or browse by subject. You can also scan a barcode!"}),e.jsxs("div",{className:"flex items-center justify-center gap-4 text-xs text-[#8B7355]",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_e,{className:"w-4 h-4"}),"Scan"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(oe,{className:"w-4 h-4"}),"Search"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Te,{className:"w-4 h-4"}),"Browse"]})]})]})})]})},de=({isOpen:c,onClose:t,onConfirm:m,title:n,message:r,type:s="confirm",confirmText:i="Confirm",cancelText:g="Cancel"})=>{if(!c)return null;const u=()=>{switch(s){case"alert":return e.jsx(Fe,{className:"w-8 h-8 text-red-500"});case"success":return e.jsx(Dt,{className:"w-8 h-8 text-green-500"});case"info":return e.jsx(Ct,{className:"w-8 h-8 text-blue-500"});default:return e.jsx(Fe,{className:"w-8 h-8 text-[#D2691E]"})}},l=()=>{m&&m(),t()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-sm mx-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[u(),e.jsx("div",{className:"flex-1",children:e.jsx("h3",{className:"font-serif text-lg font-medium text-[#3A3A3A]",children:n})}),e.jsx("button",{onClick:t,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-[#F0EDE8] transition-colors",children:e.jsx(Ee,{className:"w-5 h-5 text-[#8B7355]"})})]}),e.jsx("p",{className:"text-sm text-[#3A3A3A] leading-relaxed mb-6",children:r}),e.jsxs("div",{className:"flex gap-3",children:[s==="confirm"&&e.jsx("button",{onClick:t,className:"flex-1 py-3 px-4 bg-[#F0EDE8] text-[#8B7355] rounded-lg font-medium text-sm hover:bg-[#E8E3DD] transition-colors",children:g}),e.jsx("button",{onClick:l,className:`flex-1 py-3 px-4 rounded-lg font-medium text-sm transition-colors ${s==="success"?"bg-green-600 text-white hover:bg-green-700":s==="alert"?"bg-red-600 text-white hover:bg-red-700":"bg-[#D2691E] text-white hover:bg-[#B8541A]"}`,children:s==="confirm"?i:"OK"})]})]})})})},ue=()=>{const[c,t]=C.useState(!1),[m,n]=C.useState({title:"",message:""}),[r,s]=C.useState(null);return{isOpen:c,config:m,onConfirm:r,close:()=>{t(!1),s(null)},showConfirm:(l,a,d,x)=>{n({title:l,message:a,type:"confirm",confirmText:x==null?void 0:x.confirmText,cancelText:x==null?void 0:x.cancelText}),s(()=>d),t(!0)},showAlert:(l,a,d="info")=>{n({title:l,message:a,type:d}),s(null),t(!0)}}},Ts=()=>{const c=Y(),[t]=ze(),m=ht(),{books:n,setActiveBook:r,sessions:s,notes:i}=Z(),{updatePetFromBookCompletion:g}=re(),[u,l]=C.useState(!1),[a,d]=C.useState(null),[x,p]=C.useState(!1),[h,y]=C.useState(!1),[v,N]=C.useState(!1),o=ue(),f=t.get("book");if(C.useEffect(()=>{var T;if((T=m.state)!=null&&T.bookData)d(m.state.bookData);else{const R=n.find(G=>G.key===f);if(R)d(R);else{c("/");return}}},[f,n,m.state,c]),C.useEffect(()=>{if(a){const R=JSON.parse(localStorage.getItem("bookish_books")||"[]").some(O=>O.key===a.key);p(R);const G=tt(a.key);if(G&&G.description&&!a.description){d(O=>({...O,description:G.description,number_of_pages_median:G.number_of_pages_median||O.number_of_pages_median}));return}a.description||(l(!0),es(a.key).then(O=>{if(O){const q={...a,description:O.description,number_of_pages_median:O.number_of_pages_median||a.number_of_pages_median};d(q),$e(q)}}).catch(O=>{console.error("Error fetching book details:",O),G&&d(q=>({...q,...G}))}).finally(()=>{l(!1)}))}},[a]),!a)return e.jsx("div",{className:"max-w-md mx-auto min-h-screen bg-[#F7F5F3] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[#8B7355] mb-4",children:"Book not found"}),e.jsx("button",{onClick:()=>c("/search"),className:"bg-[#8B7355] text-white px-6 py-3 rounded-xl font-medium",children:"Back to Search"})]})});const w=T=>{const R=JSON.parse(localStorage.getItem("bookish_books")||"[]");if(!R.some(G=>G.key===a.key)){const G={...a,category:T,dateAdded:new Date().toISOString()};R.push(G),localStorage.setItem("bookish_books",JSON.stringify(R)),$e(G);const O=JSON.parse(localStorage.getItem("myBooks")||"[]");O.some(q=>q.key===a.key)||(O.push(G),localStorage.setItem("myBooks",JSON.stringify(O))),p(!0),y(!1),T==="currently-reading"&&(r(a),c("/reading"))}},S=()=>{o.showConfirm("Mark as Completed","Mark this book as completed? This will give your pet a big experience boost!",()=>{var q;const R=JSON.parse(localStorage.getItem("bookish_books")||"[]").map(V=>V.key===a.key?{...V,category:"completed",completedAt:new Date().toISOString()}:V);localStorage.setItem("bookish_books",JSON.stringify(R));const O=JSON.parse(localStorage.getItem("myBooks")||"[]").map(V=>V.key===a.key?{...V,category:"completed",completedAt:new Date().toISOString()}:V);localStorage.setItem("myBooks",JSON.stringify(O)),g(),a.key===((q=JSON.parse(localStorage.getItem("bookish_current_book")||"null"))==null?void 0:q.key)&&r(null),o.showAlert("Congratulations!","ðŸŽ‰ You've completed the book and your pet gained experience!","success"),setTimeout(()=>{c("/library")},1500)},{confirmText:"Mark Complete",cancelText:"Cancel"})},A=a.number_of_pages_median||0,b=[...s].filter(T=>T.bookId===a.key).sort((T,R)=>new Date(R.startTime).getTime()-new Date(T.startTime).getTime())[0],j=(b==null?void 0:b.endPage)||(b==null?void 0:b.startPage)||1,k=A>0?Math.min(Math.round(j/A*100),100):0,D=s.filter(T=>T.bookId===a.key).reduce((T,R)=>T+(R.duration||0),0),E=Math.floor(D/60),_=D%60,F=E>0?`${E} hr${E!==1?"s":""} ${_>0?`${_} min`:""}`:`${_} min`,I=i.filter(T=>T.bookId===a.key),L=JSON.parse(localStorage.getItem("bookish_books")||"[]").find(T=>T.key===a.key),B=(L==null?void 0:L.category)==="completed",P=()=>{c(-1)};return e.jsxs("div",{className:"max-w-md mx-auto min-h-screen bg-[#F7F5F3]",children:[e.jsx("div",{className:"p-4 bg-[#F7F5F3]",children:e.jsx("button",{onClick:P,className:"w-8 h-8 flex items-center justify-center bg-[#F0EDE8] rounded-full hover:bg-[#E8E3DD] transition-colors",children:e.jsx(W,{className:"w-5 h-5 text-[#8B7355]"})})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("div",{className:"w-24 h-32 rounded-lg overflow-hidden shadow-lg flex-shrink-0",children:a.cover_i?e.jsx("img",{src:`https://covers.openlibrary.org/b/id/${a.cover_i}-M.jpg`,alt:a.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-[#8B7355] flex items-center justify-center",children:e.jsx(H,{className:"w-8 h-8 text-white"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"font-serif text-xl font-medium text-[#3A3A3A] mb-2 leading-tight",children:a.title}),a.author_name&&a.author_name.length>0&&e.jsxs("p",{className:"text-sm text-[#8B7355] mb-3",children:["by ",a.author_name[0]]}),e.jsxs("div",{className:"space-y-1",children:[a.first_publish_year&&e.jsxs("p",{className:"text-xs text-[#8B7355]",children:["First published: ",a.first_publish_year]}),A>0&&e.jsxs("p",{className:"text-xs text-[#8B7355]",children:[A," pages"]})]})]})]}),x&&A>0&&e.jsxs("div",{className:"flex gap-3 mb-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-[#8B7355]",children:"Progress"}),e.jsxs("span",{className:"text-xs font-medium text-[#3A3A3A]",children:[k,"%"]})]}),e.jsx("div",{className:"w-full h-2 bg-[#F0EDE8] rounded-full overflow-hidden mb-2",children:e.jsx("div",{className:"h-full bg-[#E59554] rounded-full transition-all duration-300 ease-out",style:{width:`${k}%`}})}),e.jsxs("span",{className:"text-xs text-[#8B7355]",children:["Page ",j," of ",A]})]}),e.jsx("div",{className:"w-px bg-[#F0EDE8]"}),e.jsxs("div",{className:"flex flex-col items-center justify-center w-24",children:[e.jsx(Xe,{className:"w-5 h-5 text-[#8B7355] mb-1"}),e.jsx("span",{className:"text-sm font-medium text-[#3A3A3A]",children:F}),e.jsx("span",{className:"text-xs text-[#8B7355]",children:"Total Time"})]})]}),u?e.jsx("div",{className:"h-32 bg-[#F0EDE8] animate-pulse rounded-lg mb-6"}):a.description?e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-2",children:"About this book"}),e.jsxs("div",{className:"relative",children:[e.jsx("p",{className:`text-sm text-[#3A3A3A] leading-relaxed ${v?"":"line-clamp-4"}`,children:typeof a.description=="string"?a.description:"No description available."}),a.description&&a.description.length>200&&e.jsx("button",{onClick:()=>N(!v),className:"mt-2 flex items-center gap-1 text-sm font-medium text-[#8B7355] hover:text-[#3A3A3A] transition-colors",children:v?e.jsxs(e.Fragment,{children:["Show less",e.jsx(_t,{className:"w-4 h-4"})]}):e.jsxs(e.Fragment,{children:["Read more",e.jsx(Tt,{className:"w-4 h-4"})]})})]})]}):null,x&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h2",{className:"font-serif text-lg font-medium text-[#3A3A3A]",children:"My Notes"}),e.jsx("button",{onClick:()=>c("/notes"),className:"text-xs font-medium text-[#D2691E]",children:"View All"})]}),I.length>0?e.jsx("div",{className:"space-y-2",children:I.slice(0,2).map(T=>e.jsxs("div",{className:"p-3 bg-white rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("span",{className:"text-xs text-[#8B7355]",children:[T.chapter?`Chapter: ${T.chapter}`:"",T.chapter&&T.page?" â€¢ ":"",T.page?`Page ${T.page}`:""]}),e.jsx("span",{className:"text-xs text-[#8B7355]",children:new Date(T.createdAt).toLocaleDateString()})]}),e.jsx("p",{className:"text-sm text-[#3A3A3A] line-clamp-2",children:T.content})]},T.id))}):e.jsx("div",{className:"p-4 bg-white rounded-lg shadow-sm flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(te,{className:"w-6 h-6 text-[#8B7355] mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-[#8B7355] mb-1",children:"No notes yet"}),e.jsx("button",{onClick:()=>c("/notes/add"),className:"text-xs font-medium text-[#D2691E]",children:"Add Your First Note"})]})})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white border-t border-[#F0EDE8] flex gap-4 max-w-md mx-auto",children:x?e.jsx(e.Fragment,{children:B?e.jsxs("div",{className:"flex-1 py-3 px-4 bg-green-100 text-green-700 rounded-lg font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx(ie,{className:"w-5 h-5"}),"Completed"]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>c("/notes/add"),className:"flex-1 py-3 px-4 bg-white border border-[#D2691E] text-[#D2691E] rounded-lg font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx(te,{className:"w-5 h-5"}),"Add Note"]}),e.jsxs("button",{onClick:()=>{r(a),c("/reading")},className:"flex-1 py-3 px-4 bg-[#D2691E] text-white rounded-lg font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx(Ft,{className:"w-5 h-5"}),"Start Reading"]}),e.jsx("button",{onClick:S,className:"py-3 px-3 bg-green-600 text-white rounded-lg font-medium text-sm flex items-center justify-center",title:"Mark as Completed",children:e.jsx(ie,{className:"w-5 h-5"})})]})}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>c("/library"),className:"flex-1 py-3 px-4 bg-white border border-[#8B7355] text-[#8B7355] rounded-lg font-medium text-sm",children:"View Library"}),e.jsxs("button",{onClick:()=>y(!0),className:"flex-1 py-3 px-4 bg-[#8B7355] text-white rounded-lg font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx(Qe,{className:"w-5 h-5"}),"Add to Library"]})]})})]}),h&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-sm",children:[e.jsx("h3",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-4",children:"Add to Library"}),e.jsx("p",{className:"text-sm text-[#8B7355] mb-6",children:"Choose where to add this book:"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>w("want-to-read"),className:"w-full p-4 bg-[#F0EDE8] rounded-lg text-left hover:bg-[#E8E3DD] transition-colors",children:[e.jsx("div",{className:"font-medium text-[#3A3A3A] mb-1",children:"Want to Read"}),e.jsx("div",{className:"text-xs text-[#8B7355]",children:"Save for later reading"})]}),e.jsxs("button",{onClick:()=>w("currently-reading"),className:"w-full p-4 bg-[#8B7355] text-white rounded-lg text-left hover:bg-[#7A6349] transition-colors",children:[e.jsx("div",{className:"font-medium mb-1",children:"Start Reading Now"}),e.jsx("div",{className:"text-xs opacity-90",children:"Add to library and begin reading session"})]})]}),e.jsx("button",{onClick:()=>y(!1),className:"w-full mt-4 py-2 text-sm text-[#8B7355] hover:text-[#3A3A3A] transition-colors",children:"Cancel"})]})}),e.jsx(de,{isOpen:o.isOpen,onClose:o.close,onConfirm:o.onConfirm||void 0,title:o.config.title,message:o.config.message,type:o.config.type,confirmText:o.config.confirmText,cancelText:o.config.cancelText})]})},J=[];for(let c=0;c<256;++c)J.push((c+256).toString(16).slice(1));function Fs(c,t=0){return(J[c[t+0]]+J[c[t+1]]+J[c[t+2]]+J[c[t+3]]+"-"+J[c[t+4]]+J[c[t+5]]+"-"+J[c[t+6]]+J[c[t+7]]+"-"+J[c[t+8]]+J[c[t+9]]+"-"+J[c[t+10]]+J[c[t+11]]+J[c[t+12]]+J[c[t+13]]+J[c[t+14]]+J[c[t+15]]).toLowerCase()}let ve;const Ps=new Uint8Array(16);function Is(){if(!ve){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ve=crypto.getRandomValues.bind(crypto)}return ve(Ps)}const Rs=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),qe={randomUUID:Rs};function le(c,t,m){var r;if(qe.randomUUID&&!c)return qe.randomUUID();c=c||{};const n=c.random??((r=c.rng)==null?void 0:r.call(c))??Is();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Fs(n)}const ee="bookish_active_timer",Os=({bookId:c,startPage:t})=>{const[m,n]=C.useState({sessionId:null,startTime:null,totalElapsed:0,lastPauseTime:null,isActive:!1}),r=C.useRef();C.useEffect(()=>{const d=localStorage.getItem(ee);if(d)try{const x=JSON.parse(d);x.bookId===c?n(x.timerState):localStorage.removeItem(ee)}catch(x){console.error("Error loading timer state:",x),localStorage.removeItem(ee)}},[c]),C.useEffect(()=>{m.sessionId&&localStorage.setItem(ee,JSON.stringify({bookId:c,startPage:t,timerState:m}))},[m,c,t]),C.useEffect(()=>(m.isActive?r.current=setInterval(()=>{n(d=>({...d}))},1e3):r.current&&clearInterval(r.current),()=>{r.current&&clearInterval(r.current)}),[m.isActive]);const s=()=>{if(!m.startTime)return 0;let d=m.totalElapsed;if(m.isActive&&m.lastPauseTime===null){const x=Date.now(),p=new Date(m.startTime).getTime();d+=Math.floor((x-p)/1e3)}return d},i=s(),g=()=>{const d=new Date().toISOString();m.sessionId?n(x=>({...x,startTime:d,lastPauseTime:null,isActive:!0})):n({sessionId:le(),startTime:d,totalElapsed:0,lastPauseTime:null,isActive:!0})},u=()=>{if(!m.isActive||!m.startTime)return;const d=Date.now(),x=new Date(m.startTime).getTime(),p=Math.floor((d-x)/1e3);n(h=>({...h,totalElapsed:h.totalElapsed+p,lastPauseTime:new Date().toISOString(),isActive:!1}))},l=d=>{const x=s(),p={id:m.sessionId||le(),bookId:c,startTime:m.startTime||new Date().toISOString(),endTime:new Date().toISOString(),startPage:t,endPage:d,duration:Math.floor(x/60)};return n({sessionId:null,startTime:null,totalElapsed:0,lastPauseTime:null,isActive:!1}),localStorage.removeItem(ee),p},a=()=>{n({sessionId:null,startTime:null,totalElapsed:0,lastPauseTime:null,isActive:!1}),localStorage.removeItem(ee)};return{isActive:m.isActive,elapsedTime:i,startTimer:g,pauseTimer:u,stopTimer:l,resetTimer:a}},Us=()=>{const c=Y(),{currentBook:t,addSession:m,addNote:n}=Z(),{updatePetFromReading:r}=re(),s=ue(),[i,g]=C.useState(1),[u,l]=C.useState(1),[a,d]=C.useState(!1),[x,p]=C.useState(""),[h,y]=C.useState(""),[v,N]=C.useState(!1),[o,f]=C.useState(!1),{isActive:w,elapsedTime:S,startTimer:A,pauseTimer:b,stopTimer:j,resetTimer:k}=Os({bookId:(t==null?void 0:t.key)||"",startPage:1});if(C.useEffect(()=>{if(t&&!o){const B=localStorage.getItem("bookish_active_timer");if(B)try{const R=JSON.parse(B);if(R.bookId===t.key){g(R.startPage),l(R.startPage),f(!0);return}}catch(R){console.error("Error parsing active timer:",R)}const T=JSON.parse(localStorage.getItem("bookish_reading_sessions")||"[]").filter(R=>R.bookId===t.key);if(T.length>0){T.sort((G,O)=>new Date(O.startTime).getTime()-new Date(G.startTime).getTime());const R=T[0].endPage||T[0].startPage;g(R),l(R)}f(!0)}},[t,o]),C.useEffect(()=>{const B=P=>{w&&(P.preventDefault(),P.returnValue="You have an active reading session. Are you sure you want to leave?")};return window.addEventListener("beforeunload",B),()=>window.removeEventListener("beforeunload",B)},[w]),!t)return c("/"),null;const D=()=>{try{if(!t){s.showAlert("Error","No book selected","alert");return}if(u<i){s.showAlert("Invalid Page Range","End page cannot be less than start page","alert");return}if(S<=0){s.showAlert("No Time Recorded","Please start the timer to record reading time","alert");return}const B=j(u);if(!B)throw new Error("Failed to create session");if(m(B),B.duration&&r(B.duration),x.trim()){const P={id:le(),bookId:t.key,page:u,chapter:h.trim()||void 0,content:x.trim(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};n(P)}c("/")}catch(B){console.error("Error finishing session:",B),s.showAlert("Error","Failed to save reading session. Please try again.","alert")}},E=B=>{const P=Math.floor(B/3600),T=Math.floor(B%3600/60),R=B%60;return P>0?`${P}:${T.toString().padStart(2,"0")}:${R.toString().padStart(2,"0")}`:`${T.toString().padStart(2,"0")}:${R.toString().padStart(2,"0")}`},_=t.number_of_pages_median||9999,F=t.number_of_pages_median&&t.number_of_pages_median>0,I=()=>{const B=(t==null?void 0:t.number_of_pages_median)||0;return B>0&&u>=B},U=B=>{const P=Math.max(i,Math.min(B,_));l(P),t!=null&&t.number_of_pages_median&&P>=t.number_of_pages_median&&N(!0)},L=()=>{try{const B=j(u);if(B&&(m(B),B.duration&&r(B.duration)),x.trim()){const O={id:le(),bookId:t.key,page:u,chapter:h.trim()||void 0,content:x.trim(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};n(O)}const T=JSON.parse(localStorage.getItem("bookish_books")||"[]").map(O=>O.key===t.key?{...O,category:"completed",completedAt:new Date().toISOString()}:O);localStorage.setItem("bookish_books",JSON.stringify(T));const G=JSON.parse(localStorage.getItem("myBooks")||"[]").map(O=>O.key===t.key?{...O,category:"completed",completedAt:new Date().toISOString()}:O);localStorage.setItem("myBooks",JSON.stringify(G)),localStorage.removeItem("bookish_current_book"),r((B==null?void 0:B.duration)||0,!0),s.showAlert("Congratulations!","ðŸŽ‰ You've completed the book and your pet gained bonus experience!","success"),setTimeout(()=>{c("/library")},2e3)}catch(B){console.error("Error marking book as finished:",B),s.showAlert("Error","Failed to mark book as completed. Please try again.","alert")}};return e.jsxs("div",{className:"max-w-md mx-auto min-h-screen bg-[#F7F5F3] pb-20",children:[e.jsxs("header",{className:"p-4 bg-[#F0EDE8] flex items-center gap-3 shadow-sm",children:[e.jsx("button",{onClick:()=>{w||S>0?s.showConfirm("Leave Reading Session",w?"Your timer is still running. The session will continue in the background if you leave.":"You have an unsaved reading session. Do you want to save it or discard it?",()=>{!w&&S>0?D():c(-1)},{confirmText:w?"Leave (Keep Timer)":"Save & Leave",cancelText:"Stay"}):c(-1)},className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-[#F7F5F3] transition-colors",children:e.jsx(W,{className:"w-5 h-5 text-[#8B7355]"})}),e.jsx("h1",{className:"font-serif text-lg font-medium text-[#3A3A3A]",children:"Reading Session"}),w&&e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"})})]}),e.jsx("main",{className:"p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden mb-6",children:[e.jsxs("div",{className:"flex items-center p-4 border-b border-[#F0EDE8]",children:[e.jsx("div",{className:"w-12 h-16 rounded overflow-hidden mr-3",children:t.cover_i?e.jsx("img",{src:rs(t.cover_i,"S"),alt:t.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-[#8B7355]"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-serif text-base font-medium text-[#3A3A3A] line-clamp-1",children:t.title}),t.author_name&&t.author_name.length>0&&e.jsxs("p",{className:"text-sm text-[#8B7355]",children:["by ",t.author_name[0]]})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex justify-center mb-8",children:e.jsx("div",{className:"w-24 h-24 rounded-full bg-[#F7F5F3] flex items-center justify-center shadow-inner",children:e.jsx("span",{className:"font-serif text-2xl font-medium text-[#3A3A3A]",children:E(S)})})}),e.jsx("div",{className:"flex justify-center mb-8",children:e.jsx("button",{onClick:w?b:A,className:"w-16 h-16 rounded-full bg-[#D2691E] text-white flex items-center justify-center shadow-md hover:bg-[#A0522D] transition-colors",children:w?e.jsx(Pt,{className:"w-8 h-8"}):e.jsx(It,{className:"w-8 h-8"})})}),e.jsxs("div",{className:"flex gap-6 mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm text-[#8B7355] mb-2",children:"Start Page"}),e.jsx("input",{type:"number",value:i,onChange:B=>{const P=Math.max(1,Math.min(parseInt(B.target.value)||1,_));g(P),u<P&&l(P)},min:"1",max:_,className:"w-full p-2 border border-[#E5E5E5] rounded-md text-[#3A3A3A]",disabled:w||S>0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm text-[#8B7355] mb-2",children:"End Page"}),e.jsx("input",{type:"number",value:u,onChange:B=>U(parseInt(B.target.value)||i),min:i,max:_,className:"w-full p-2 border border-[#E5E5E5] rounded-md text-[#3A3A3A]"})]})]}),I()&&e.jsxs("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(fe,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-medium text-green-800",children:"Congratulations!"})]}),e.jsx("p",{className:"text-sm text-green-700 mb-3",children:"You've reached the last page! Would you like to mark this book as completed?"}),e.jsx("button",{onClick:L,className:"w-full py-2 px-4 bg-green-600 text-white rounded-lg font-medium text-sm hover:bg-green-700 transition-colors",children:"Mark as Finished"})]}),!F&&e.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-blue-700",children:"ðŸ“˜ Page count unavailable for this book. You can still track your reading progress by entering the pages you read."})}),e.jsx("button",{onClick:()=>d(!a),className:"w-full py-2 text-sm text-[#D2691E] mb-2",children:a?"Hide Note Form":"+ Add a note about this session"}),a&&e.jsxs("div",{className:"space-y-4 mb-4 p-4 bg-[#F7F5F3] rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-[#8B7355] mb-2",children:"Chapter (optional)"}),e.jsx("input",{type:"text",value:h,onChange:B=>y(B.target.value),placeholder:"e.g. Chapter 5",className:"w-full p-2 border border-[#E5E5E5] rounded-md text-[#3A3A3A]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-[#8B7355] mb-2",children:"Note"}),e.jsx("textarea",{value:x,onChange:B=>p(B.target.value),placeholder:"Write your thoughts about this reading session...",rows:4,className:"w-full p-2 border border-[#E5E5E5] rounded-md text-[#3A3A3A] resize-none"})]})]})]})]})}),e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white border-t border-[#F0EDE8] flex gap-4 max-w-md mx-auto",children:[e.jsxs("button",{onClick:()=>{s.showConfirm("Cancel Session",w?"This will stop your timer and discard the session. Are you sure?":"Are you sure you want to cancel this session? All progress will be lost.",()=>{k(),c(-1)},{confirmText:"Yes, Cancel",cancelText:"Keep Reading"})},className:"flex-1 py-3 px-4 bg-white border border-[#E5E5E5] text-[#8B7355] rounded-lg font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx(Ee,{className:"w-5 h-5"}),"Cancel"]}),I()?e.jsxs("button",{onClick:L,className:"flex-1 py-3 px-4 bg-green-600 text-white rounded-lg font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5"}),"Mark as Finished"]}):e.jsxs("button",{onClick:D,className:"flex-1 py-3 px-4 bg-[#D2691E] text-white rounded-lg font-medium text-sm flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:S<=0||u<i,children:[e.jsx(ie,{className:"w-5 h-5"}),"Finish Session"]})]}),v&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-xl p-6 w-full max-w-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(fe,{className:"w-8 h-8 text-green-600"})}),e.jsx("h3",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-2",children:"Congratulations!"}),e.jsxs("p",{className:"text-sm text-[#8B7355] mb-6",children:[`You've reached the last page of "`,t.title,'". Would you like to mark it as completed?']}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:L,className:"w-full py-3 px-4 bg-green-600 text-white rounded-lg font-medium text-sm hover:bg-green-700 transition-colors",children:"Yes, Mark as Completed"}),e.jsx("button",{onClick:()=>N(!1),className:"w-full py-2 px-4 bg-white border border-[#E5E5E5] text-[#8B7355] rounded-lg font-medium text-sm hover:bg-[#F7F5F3] transition-colors",children:"Continue Reading"})]})]})})}),e.jsx(de,{isOpen:s.isOpen,onClose:s.close,onConfirm:s.onConfirm||void 0,title:s.config.title,message:s.config.message,type:s.config.type,confirmText:s.config.confirmText,cancelText:s.config.cancelText})]})},Gs=()=>{const c=Y(),{books:t}=Z(),{updatePetFromBookCompletion:m}=re(),n=ue(),[r,s]=C.useState(null),[i,g]=C.useState(null),[u,l]=C.useState({}),[a,d]=C.useState([]);C.useEffect(()=>{(()=>{const k=JSON.parse(localStorage.getItem("bookish_books")||"[]");d(k)})()},[]),C.useEffect(()=>{const j=()=>{s(null)};if(r)return document.addEventListener("click",j),()=>document.removeEventListener("click",j)},[r]);const x=a.length>0?a:t,p=j=>{c(`/book?book=${j.key}`,{state:{bookData:j}})},h=(j,k)=>{k.stopPropagation(),n.showConfirm("Remove Book","Are you sure you want to remove this book from your library?",()=>{const E=JSON.parse(localStorage.getItem("bookish_books")||"[]").filter(L=>L.key!==j);localStorage.setItem("bookish_books",JSON.stringify(E));const F=JSON.parse(localStorage.getItem("myBooks")||"[]").filter(L=>L.key!==j);localStorage.setItem("myBooks",JSON.stringify(F));const I=JSON.parse(localStorage.getItem("bookish_cached_books")||"{}");delete I[j],localStorage.setItem("bookish_cached_books",JSON.stringify(I));const U=JSON.parse(localStorage.getItem("bookish_current_book")||"null");U&&U.key===j&&localStorage.removeItem("bookish_current_book"),d(E)},{confirmText:"Remove",cancelText:"Keep Book"}),s(null)},y=(j,k,D)=>{const _=JSON.parse(localStorage.getItem("bookish_books")||"[]").map(U=>U.key===j?{...U,category:k}:U);localStorage.setItem("bookish_books",JSON.stringify(_));const I=JSON.parse(localStorage.getItem("myBooks")||"[]").map(U=>U.key===j?{...U,category:k}:U);localStorage.setItem("myBooks",JSON.stringify(I)),d(_),g(null),s(null)},v=(j,k)=>{k.stopPropagation(),n.showConfirm("Mark as Completed","Mark this book as completed? This will give your pet a big experience boost!",()=>{y(j,"completed"),m(),setTimeout(()=>{n.showAlert("Book Completed!","ðŸŽ‰ Book marked as completed! Check your pet for an experience boost!","success")},100)},{confirmText:"Mark Complete",cancelText:"Cancel"}),s(null)},N=(j,k)=>{k.stopPropagation(),s(r===j?null:j)},o=j=>{const k=He(j);if(k.length===0)return 0;const D=k[k.length-1],E=t.find(_=>_.key===j);return!(E!=null&&E.number_of_pages_median)||!D.endPage?0:Math.min(100,Math.round(D.endPage/E.number_of_pages_median*100))},f=j=>He(j).reduce((D,E)=>D+(E.duration||0),0),w=j=>{const k=Math.floor(j/60),D=j%60;return k>0?`${k}h ${D}m`:`${D}m`},S=()=>{const j=[],k=[],D=[];return x.forEach(E=>{const _=o(E.key),F=f(E.key);E.category==="want-to-read"?D.push(E):E.category==="completed"||_>=100?k.push(E):E.category==="currently-reading"||_>0||F>0?j.push(E):D.push(E)}),{currentlyReading:j,completed:k,wantToRead:D}},A=j=>{const k=o(j.key),D=f(j.key),E=u[j.key]||{translateX:0,isDeleting:!1},_=B=>{const P=B.touches[0];l(T=>({...T,[j.key]:{...E,startX:P.clientX,startY:P.clientY}}))},F=B=>{const P=B.touches[0],T=u[j.key];if(!(T!=null&&T.startX)||!(T!=null&&T.startY))return;const R=P.clientX-T.startX,G=P.clientY-T.startY;Math.abs(G)>Math.abs(R)||R<-20&&l(O=>({...O,[j.key]:{...T,translateX:Math.max(R,-120)}}))},I=()=>{const B=u[j.key];B&&(B.translateX<-60?l(P=>({...P,[j.key]:{...B,translateX:-120,isDeleting:!0}})):l(P=>({...P,[j.key]:{...B,translateX:0,isDeleting:!1}})))},U=()=>{n.showConfirm("Remove Book","Are you sure you want to remove this book from your library?",()=>{const P=JSON.parse(localStorage.getItem("bookish_books")||"[]").filter(G=>G.key!==j.key);localStorage.setItem("bookish_books",JSON.stringify(P));const R=JSON.parse(localStorage.getItem("myBooks")||"[]").filter(G=>G.key!==j.key);localStorage.setItem("myBooks",JSON.stringify(R)),d(P),l(G=>{const O={...G};return delete O[j.key],O})},{confirmText:"Remove",cancelText:"Keep Book"})},L=()=>{l(B=>({...B,[j.key]:{translateX:0,isDeleting:!1}}))};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm cursor-pointer hover:shadow-md transition-shadow relative",style:{transform:`translateX(${E.translateX}px)`,transition:E.isDeleting||E.translateX===0?"transform 0.3s ease":"none",overflow:E.isDeleting?"hidden":"visible"},onTouchStart:_,onTouchMove:F,onTouchEnd:I,children:[e.jsxs("div",{className:"flex gap-3 p-4",onClick:()=>!E.isDeleting&&p(j),children:[e.jsxs("div",{className:"w-12 h-16 bg-[#F0EDE8] rounded flex-shrink-0 flex items-center justify-center",children:[j.cover_i?e.jsx("img",{src:`https://covers.openlibrary.org/b/id/${j.cover_i}-M.jpg`,alt:j.title,className:"w-full h-full object-cover rounded",onError:B=>{var T;const P=B.target;P.style.display="none",(T=P.nextElementSibling)==null||T.classList.remove("hidden")}}):null,e.jsx(H,{className:`w-6 h-6 text-[#8B7355] ${j.cover_i?"hidden":""}`})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-serif font-medium text-[#3A3A3A] text-sm leading-tight mb-1 truncate",children:j.title}),j.author_name&&e.jsxs("p",{className:"text-xs text-[#8B7355] mb-2 truncate",children:["by ",j.author_name[0]]}),k>0&&k<100&&e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-[#8B7355]",children:"Progress"}),e.jsxs("span",{className:"text-xs text-[#8B7355]",children:[k,"%"]})]}),e.jsx("div",{className:"w-full bg-[#F0EDE8] rounded-full h-1.5",children:e.jsx("div",{className:"bg-[#8B7355] h-1.5 rounded-full transition-all duration-300",style:{width:`${k}%`}})})]}),k>=100&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600 mb-2",children:[e.jsx(ie,{className:"w-3 h-3"}),e.jsx("span",{children:"Completed"})]}),D>0&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-[#8B7355]",children:[e.jsx(se,{className:"w-3 h-3"}),e.jsxs("span",{children:[w(D)," read"]})]})]})]}),!E.isDeleting&&e.jsx("button",{onClick:B=>N(j.key,B),className:"absolute top-3 right-3 w-6 h-6 rounded-full bg-[#F0EDE8] flex items-center justify-center hover:bg-[#E8E3DD] transition-colors",children:e.jsx(Rt,{className:"w-4 h-4 text-[#8B7355]"})}),"        ",r===j.key&&!E.isDeleting&&e.jsxs("div",{className:"absolute top-10 right-3 bg-white rounded-lg shadow-lg border border-[#E8E3DD] py-1 z-50 min-w-[180px]",children:[e.jsxs("button",{onClick:B=>{B.stopPropagation(),g(j.key),s(null)},className:"flex items-center gap-2 px-3 py-2 text-sm text-[#8B7355] hover:bg-[#F0EDE8] w-full text-left",children:[e.jsx(Ot,{className:"w-4 h-4"}),"Move to category"]}),j.category!=="completed"&&e.jsxs("button",{onClick:B=>v(j.key,B),className:"flex items-center gap-2 px-3 py-2 text-sm text-green-600 hover:bg-green-50 w-full text-left",children:[e.jsx(ie,{className:"w-4 h-4"}),"Mark as completed"]}),e.jsxs("button",{onClick:B=>h(j.key,B),className:"flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50 w-full text-left",children:[e.jsx(Ze,{className:"w-4 h-4"}),"Remove from library"]})]}),E.isDeleting&&e.jsx("div",{className:"absolute inset-0 bg-red-500 flex items-center justify-end pr-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:L,className:"px-3 py-1 text-xs bg-white text-red-500 rounded",children:"Cancel"}),e.jsx("button",{onClick:U,className:"px-3 py-1 text-xs bg-red-700 text-white rounded",children:"Delete"})]})})]},j.key)},b=(j,k)=>k.length===0?null:e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-4 flex items-center gap-2",children:[j,e.jsxs("span",{className:"text-sm text-[#8B7355] font-normal",children:["(",k.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:k.map(A)})]});return e.jsxs("div",{className:"max-w-md mx-auto min-h-screen bg-[#F7F5F3]",children:[e.jsx("header",{className:"p-4 bg-[#F7F5F3] border-b border-[#E8E3DD]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>c("/"),className:"w-8 h-8 rounded-full bg-[#F0EDE8] flex items-center justify-center",children:e.jsx(W,{className:"w-5 h-5 text-[#8B7355]"})}),e.jsx("h1",{className:"font-serif text-xl font-medium text-[#3A3A3A]",children:"My Library"})]})}),"      ",e.jsx("main",{className:"p-4",children:x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(H,{className:"w-16 h-16 text-[#8B7355] mx-auto mb-4"}),e.jsx("h2",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-2",children:"No books yet"}),e.jsx("p",{className:"text-sm text-[#8B7355] mb-6",children:"Start building your library by searching for books to read"}),e.jsx("button",{onClick:()=>c("/search"),className:"bg-[#8B7355] text-white px-6 py-3 rounded-xl font-medium",children:"Find Books"})]}):e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("p",{className:"text-sm text-[#8B7355]",children:[x.length," book",x.length!==1?"s":""," in your library"]})}),(()=>{const{currentlyReading:j,completed:k,wantToRead:D}=S();return e.jsxs(e.Fragment,{children:[b("Currently Reading",j),b("Want to Read",D),b("Completed",k)]})})()]})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-sm",children:[e.jsx("h3",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-4",children:"Move Book"}),e.jsx("p",{className:"text-sm text-[#8B7355] mb-6",children:"Choose a new category:"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>y(i,"want-to-read"),className:"w-full p-3 bg-[#F0EDE8] rounded-lg text-left hover:bg-[#E8E3DD] transition-colors",children:[e.jsx("div",{className:"font-medium text-[#3A3A3A]",children:"Want to Read"}),e.jsx("div",{className:"text-xs text-[#8B7355]",children:"Books you plan to read"})]}),e.jsxs("button",{onClick:()=>y(i,"currently-reading"),className:"w-full p-3 bg-[#E8E3DD] rounded-lg text-left hover:bg-[#DDD8CE] transition-colors",children:[e.jsx("div",{className:"font-medium text-[#3A3A3A]",children:"Currently Reading"}),e.jsx("div",{className:"text-xs text-[#8B7355]",children:"Books you're actively reading"})]}),e.jsxs("button",{onClick:()=>y(i,"completed"),className:"w-full p-3 bg-green-50 rounded-lg text-left hover:bg-green-100 transition-colors",children:[e.jsx("div",{className:"font-medium text-[#3A3A3A]",children:"Completed"}),e.jsx("div",{className:"text-xs text-green-600",children:"Books you've finished"})]})]}),e.jsx("button",{onClick:()=>g(null),className:"w-full mt-4 py-2 text-sm text-[#8B7355] hover:text-[#3A3A3A] transition-colors",children:"Cancel"}),"          "]})}),e.jsx(de,{isOpen:n.isOpen,onClose:n.close,onConfirm:n.onConfirm||void 0,title:n.config.title,message:n.config.message,type:n.config.type,confirmText:n.config.confirmText,cancelText:n.config.cancelText})]})},Ms=()=>{const c=Y(),{books:t}=Z(),{pet:m}=re(),n=st(),r=rt(),s=Be(),i=d=>{const x=Math.floor(d/60),p=d%60;return x>0?`${x}h ${p}m`:`${p}m`},g=()=>{if(s.length===0)return 0;const d=s.reduce((x,p)=>x+(p.duration||0),0);return Math.round(d/s.length)},l=(()=>{const d=new Date,x=new Date(d.getFullYear(),d.getMonth(),1),p=s.filter(v=>new Date(v.startTime)>=x),h=p.reduce((v,N)=>v+(N.duration||0),0),y=p.reduce((v,N)=>v+((N.endPage||0)-(N.startPage||0)),0);return{time:h,pages:y,sessions:p.length}})(),a=({icon:d,title:x,value:p,subtitle:h})=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-8 h-8 bg-[#F0EDE8] rounded-lg flex items-center justify-center",children:e.jsx(d,{className:"w-4 h-4 text-[#8B7355]"})}),e.jsx("span",{className:"text-sm text-[#8B7355] font-medium",children:x})]}),e.jsx("p",{className:"text-2xl font-serif font-medium text-[#3A3A3A] mb-1",children:p}),h&&e.jsx("p",{className:"text-xs text-[#8B7355]",children:h})]});return e.jsxs("div",{className:"max-w-md mx-auto min-h-screen bg-[#F7F5F3]",children:[e.jsx("header",{className:"p-4 bg-[#F7F5F3] border-b border-[#E8E3DD]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>c("/"),className:"w-8 h-8 rounded-full bg-[#F0EDE8] flex items-center justify-center",children:e.jsx(W,{className:"w-5 h-5 text-[#8B7355]"})}),e.jsx("h1",{className:"font-serif text-xl font-medium text-[#3A3A3A]",children:"Reading Statistics"})]})}),e.jsxs("main",{className:"p-4 space-y-6",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-3",children:"Overview"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(a,{icon:H,title:"Books Read",value:n.totalBooksRead.toString(),subtitle:"this year"}),e.jsx(a,{icon:se,title:"Total Time",value:i(n.totalReadingTime),subtitle:"all time"}),e.jsx(a,{icon:je,title:"Pages Read",value:n.totalPagesRead.toString(),subtitle:"all time"}),e.jsx(a,{icon:Pe,title:"Current Streak",value:`${r.currentStreak} days`,subtitle:`longest: ${r.longestStreak} days`})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-3",children:"This Month"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Ne,{className:"w-5 h-5 text-[#8B7355]"}),e.jsx("span",{className:"font-medium text-[#3A3A3A]",children:"Monthly Progress"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-serif font-medium text-[#3A3A3A]",children:l.sessions}),e.jsx("p",{className:"text-xs text-[#8B7355]",children:"sessions"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-serif font-medium text-[#3A3A3A]",children:i(l.time)}),e.jsx("p",{className:"text-xs text-[#8B7355]",children:"reading time"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-serif font-medium text-[#3A3A3A]",children:l.pages}),e.jsx("p",{className:"text-xs text-[#8B7355]",children:"pages"})]})]})]})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-3",children:"Recent Activity"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(a,{icon:se,title:"Today",value:i(n.readingTimeToday)}),e.jsx(a,{icon:Ne,title:"This Week",value:i(n.readingTimeThisWeek)}),e.jsx(a,{icon:je,title:"Average Session",value:i(g())}),e.jsx(a,{icon:H,title:"Books in Library",value:t.length.toString()})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-3",children:"Reading Companion"}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Ut,{className:"w-5 h-5 text-[#8B7355]"}),e.jsxs("span",{className:"font-medium text-[#3A3A3A]",children:[m.name,"'s Progress"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-serif font-medium text-[#3A3A3A]",children:m.level}),e.jsx("p",{className:"text-xs text-[#8B7355]",children:"level"})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-lg font-serif font-medium text-[#3A3A3A]",children:[m.happiness,"%"]}),e.jsx("p",{className:"text-xs text-[#8B7355]",children:"happiness"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-serif font-medium text-[#3A3A3A]",children:m.experience}),e.jsx("p",{className:"text-xs text-[#8B7355]",children:"experience"})]})]})]})]}),s.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Pe,{className:"w-16 h-16 text-[#8B7355] mx-auto mb-4"}),e.jsx("h3",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-2",children:"Start tracking your reading"}),e.jsx("p",{className:"text-sm text-[#8B7355] mb-6",children:"Begin a reading session to see your statistics here"}),e.jsx("button",{onClick:()=>c("/search"),className:"bg-[#8B7355] text-white px-6 py-3 rounded-xl font-medium",children:"Find a Book to Read"})]})]})]})},Ls=()=>{const c=Y(),{notes:t,books:m,deleteNote:n}=Z(),r=ue(),s=u=>{r.showConfirm("Delete Note","Are you sure you want to delete this note? This action cannot be undone.",()=>{n(u)},{confirmText:"Delete",cancelText:"Cancel"})},i=u=>{const l=m.find(a=>a.key===u);return l?l.title:"Unknown Book"},g=u=>new Date(u).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return e.jsxs("div",{className:"max-w-md mx-auto min-h-screen bg-[#F7F5F3]",children:[e.jsx("header",{className:"p-4 bg-[#F7F5F3] border-b border-[#E8E3DD]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>c(-1),className:"w-8 h-8 rounded-full bg-[#F0EDE8] flex items-center justify-center",children:e.jsx(W,{className:"w-5 h-5 text-[#8B7355]"})}),e.jsx("h1",{className:"font-serif text-xl font-medium text-[#3A3A3A]",children:"My Notes"})]}),e.jsx("button",{onClick:()=>c("/notes/add"),className:"w-8 h-8 rounded-full bg-[#8B7355] flex items-center justify-center",children:e.jsx(Qe,{className:"w-5 h-5 text-white"})})]})}),e.jsx("main",{className:"p-4",children:t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(te,{className:"w-16 h-16 text-[#8B7355] mx-auto mb-4"}),e.jsx("h2",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-2",children:"No notes yet"}),e.jsx("p",{className:"text-sm text-[#8B7355] mb-6",children:"Start taking notes while reading to remember important thoughts and insights"}),e.jsx("button",{onClick:()=>c("/notes/add"),className:"bg-[#8B7355] text-white px-6 py-3 rounded-xl font-medium",children:"Add Your First Note"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("p",{className:"text-sm text-[#8B7355]",children:[t.length," note",t.length!==1?"s":""]})}),"            ",t.map(u=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(H,{className:"w-4 h-4 text-[#8B7355]"}),e.jsx("span",{className:"text-sm font-medium text-[#3A3A3A] truncate",children:i(u.bookId)})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-[#8B7355]",children:[u.chapter&&e.jsxs("span",{children:["Chapter: ",u.chapter]}),u.page&&e.jsxs("span",{children:["Page ",u.page]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ne,{className:"w-3 h-3"}),e.jsx("span",{children:g(u.createdAt)})]})]})]}),e.jsx("button",{onClick:()=>s(u.id),className:"p-1 text-red-500 hover:bg-red-50 rounded",children:e.jsx(Ze,{className:"w-4 h-4"})})]}),"                ",e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"text-[#3A3A3A] leading-relaxed whitespace-pre-wrap",children:u.content})})]},u.id))]})}),e.jsx(de,{isOpen:r.isOpen,onClose:r.close,onConfirm:r.onConfirm||void 0,title:r.config.title,message:r.config.message,type:r.config.type,confirmText:r.config.confirmText,cancelText:r.config.cancelText})]})},Js=()=>{const c=Y(),[t]=ze(),{books:m,currentBook:n,addNote:r,notes:s,updateNote:i}=Z(),g=ue(),u=t.get("edit"),[l,a]=C.useState((n==null?void 0:n.key)||""),[d,x]=C.useState(""),[p,h]=C.useState(""),[y,v]=C.useState("");C.useEffect(()=>{var f;if(u){const w=s.find(S=>S.id===u);w&&(a(w.bookId),x(w.content),h(((f=w.page)==null?void 0:f.toString())||""),v(w.chapter||""))}},[u,s]);const N=()=>{var w;if(!d.trim()){g.showAlert("Content Required","Please add some content to your note before saving.","alert");return}const f={id:u||le(),bookId:l,content:d.trim(),page:p?parseInt(p):void 0,chapter:y.trim()||void 0,createdAt:u?((w=s.find(S=>S.id===u))==null?void 0:w.createdAt)||new Date().toISOString():new Date().toISOString(),updatedAt:new Date().toISOString()};u&&i?i(f):r(f),g.showAlert("Note Saved","Your note has been saved successfully!","success"),setTimeout(()=>{c("/notes")},1500)},o=()=>{d.trim()||y.trim()||p.trim()?g.showConfirm("Discard Note","You have unsaved changes. Are you sure you want to go back?",()=>{c(-1)},{confirmText:"Discard",cancelText:"Keep Editing"}):c(-1)};return e.jsxs("div",{className:"max-w-md mx-auto min-h-screen bg-[#F7F5F3]",children:[e.jsx("header",{className:"p-4 bg-[#F7F5F3] border-b border-[#E8E3DD]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:o,className:"w-8 h-8 rounded-full bg-[#F0EDE8] flex items-center justify-center",children:e.jsx(W,{className:"w-5 h-5 text-[#8B7355]"})}),e.jsx("h1",{className:"font-serif text-xl font-medium text-[#3A3A3A]",children:u?"Edit Note":"Add Note"})]}),e.jsxs("button",{onClick:N,className:"flex items-center gap-2 bg-[#8B7355] text-white px-4 py-2 rounded-lg text-sm font-medium",children:[e.jsx(Gt,{className:"w-4 h-4"}),"Save"]})]})}),e.jsxs("main",{className:"p-4 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#3A3A3A] mb-2",children:"Select Book"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:l,onChange:f=>a(f.target.value),className:"w-full p-3 pr-10 bg-white border border-[#E8E3DD] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#8B7355] text-[#3A3A3A] appearance-none",children:[e.jsx("option",{value:"",children:"Choose a book..."}),m.map(f=>e.jsx("option",{value:f.key,children:f.title},f.key))]}),e.jsx(H,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#8B7355] pointer-events-none"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#3A3A3A] mb-2",children:"Chapter (optional)"}),e.jsx("input",{type:"text",value:y,onChange:f=>v(f.target.value),placeholder:"e.g., Chapter 5",className:"w-full p-3 bg-white border border-[#E8E3DD] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#8B7355] text-[#3A3A3A]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#3A3A3A] mb-2",children:"Page (optional)"}),e.jsx("input",{type:"number",value:p,onChange:f=>h(f.target.value),placeholder:"Page number",className:"w-full p-3 bg-white border border-[#E8E3DD] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#8B7355] text-[#3A3A3A]"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#3A3A3A] mb-2",children:"Your Note"}),e.jsx("textarea",{value:d,onChange:f=>x(f.target.value),placeholder:"Write your thoughts, insights, or reflections about this part of the book...",rows:8,className:"w-full p-3 bg-white border border-[#E8E3DD] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#8B7355] text-[#3A3A3A] resize-none"}),e.jsxs("p",{className:"text-xs text-[#8B7355] mt-2",children:[d.length,"/500 characters"]})]}),e.jsxs("div",{className:"bg-[#F0EDE8] rounded-xl p-4",children:[e.jsx("h3",{className:"font-medium text-[#3A3A3A] mb-2",children:"ðŸ’¡ Note-taking tips:"}),e.jsxs("ul",{className:"text-sm text-[#8B7355] space-y-1",children:[e.jsx("li",{children:"â€¢ Write down key insights or quotes that resonate with you"}),e.jsx("li",{children:"â€¢ Note questions or thoughts the reading sparked"}),e.jsx("li",{children:"â€¢ Record connections to other books or personal experiences"}),e.jsx("li",{children:"â€¢ Include your emotional reactions or reflections"})]})]})]}),e.jsx(de,{isOpen:g.isOpen,onClose:g.close,onConfirm:g.onConfirm||void 0,title:g.config.title,message:g.config.message,type:g.config.type,confirmText:g.config.confirmText,cancelText:g.config.cancelText})]})},$s=()=>{const c=Y(),{pet:t,petStats:m,feedPet:n,playWithPet:r,petSleep:s,getPetMood:i,getPetEvolutionRequirement:g,resetPet:u,updatePetName:l,getPetEmoji:a,canEvolve:d,evolvePet:x}=re(),[p,h]=C.useState(!1),[y,v]=C.useState(t.name),[N,o]=C.useState(!1),f=E=>E>70?"bg-green-500":E>40?"bg-yellow-500":"bg-red-500",w=E=>`${Math.max(0,Math.min(100,E))}%`,S=()=>{y.trim()&&(l(y.trim()),h(!1))},A=()=>{u(),o(!1)},b=E=>({"first-book":"ðŸ“–","book-lover":"ðŸ“š",bookworm:"ðŸ›","speed-reader":"âš¡","night-owl":"ðŸ¦‰","early-bird":"ðŸ¦"})[E]||"ðŸ†",j=E=>({"first-book":"Read your first book","book-lover":"Read 10 books",bookworm:"Read 50 books","speed-reader":"Read for 100+ minutes in a day","night-owl":"Read after midnight","early-bird":"Read before 6 AM"})[E]||"Special achievement",k=E=>{const _=Math.floor(E/60),F=E%60;return _>0?`${_}h ${F}m`:`${F}m`},D=g();return e.jsxs("div",{className:"max-w-md mx-auto min-h-screen bg-[#F7F5F3]",children:[e.jsx("header",{className:"p-4 bg-[#F7F5F3] border-b border-[#E8E3DD]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>c(-1),className:"w-8 h-8 rounded-full bg-[#F0EDE8] flex items-center justify-center",children:e.jsx(W,{className:"w-5 h-5 text-[#8B7355]"})}),e.jsx("h1",{className:"font-serif text-xl font-medium text-[#3A3A3A]",children:"My Reading Pet"})]})}),e.jsxs("main",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 text-center",children:[e.jsx("div",{className:"text-8xl mb-4",children:a()}),e.jsxs("div",{className:"mb-4",children:[p?e.jsx("div",{className:"flex items-center justify-center gap-2",children:e.jsx("input",{type:"text",value:y,onChange:E=>v(E.target.value),className:"text-2xl font-serif font-medium bg-[#F0EDE8] rounded px-3 py-1 border text-center",onBlur:S,onKeyPress:E=>E.key==="Enter"&&S(),autoFocus:!0})}):e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("h2",{className:"text-2xl font-serif font-medium text-[#3A3A3A]",children:t.name}),e.jsx("button",{onClick:()=>h(!0),className:"p-1 text-[#8B7355] hover:bg-[#F0EDE8] rounded",children:e.jsx(te,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-lg text-[#8B7355] mb-2",children:[e.jsxs("span",{children:["Level ",t.level]}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{className:"capitalize",children:t.evolutionStage})]}),d()&&e.jsxs("button",{onClick:x,className:"bg-gradient-to-r from-[#D2691E] to-[#FF8C00] text-white px-6 py-2 rounded-full font-medium mb-2",children:["âœ¨ Evolve to ",D.stage,"!"]})]}),e.jsx("p",{className:"text-[#3A3A3A] mb-4",children:i()}),e.jsx("div",{className:"mb-4 p-3 bg-[#F0EDE8] rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-[#D2691E] mb-1",children:["ðŸ’° ",t.points]}),e.jsx("p",{className:"text-sm text-[#8B7355]",children:"Care Points (Earned from reading)"})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-[#8B7355] mb-2",children:[e.jsx("span",{children:"Experience"}),e.jsxs("span",{children:[t.experience,"/",t.experienceToNext]})]}),e.jsx("div",{className:"h-3 bg-[#F0EDE8] rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-[#D2691E] to-[#FF8C00] rounded-full transition-all duration-300",style:{width:`${t.experience/t.experienceToNext*100}%`}})})]}),"          ",e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("button",{onClick:n,disabled:t.points<3,className:`py-3 px-4 rounded-xl font-medium transition-colors flex flex-col items-center gap-1 ${t.points>=3?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[e.jsx(Ie,{className:"w-6 h-6"}),e.jsx("span",{className:"text-sm",children:"Feed"}),e.jsx("span",{className:"text-xs",children:"ðŸ’° 3 pts"})]}),e.jsxs("button",{onClick:r,disabled:t.points<5,className:`py-3 px-4 rounded-xl font-medium transition-colors flex flex-col items-center gap-1 ${t.points>=5?"bg-blue-100 text-blue-700 hover:bg-blue-200":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[e.jsx(we,{className:"w-6 h-6"}),e.jsx("span",{className:"text-sm",children:"Play"}),e.jsx("span",{className:"text-xs",children:"ðŸ’° 5 pts"})]}),e.jsxs("button",{onClick:s,className:"py-3 px-4 bg-purple-100 text-purple-700 rounded-xl font-medium hover:bg-purple-200 transition-colors flex flex-col items-center gap-1",children:[e.jsx(Re,{className:"w-6 h-6"}),e.jsx("span",{className:"text-sm",children:"Sleep"}),e.jsx("span",{className:"text-xs",children:"Free"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsx("h3",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-4",children:"Pet Stats"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{children:"Happiness"})]}),e.jsxs("span",{children:[t.happiness,"/100"]})]}),e.jsx("div",{className:"h-3 bg-[#F0EDE8] rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${f(t.happiness)} rounded-full transition-all duration-300`,style:{width:w(t.happiness)}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Hunger"})]}),e.jsxs("span",{children:[t.hunger,"/100"]})]}),e.jsx("div",{className:"h-3 bg-[#F0EDE8] rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${f(t.hunger)} rounded-full transition-all duration-300`,style:{width:w(t.hunger)}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Mt,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{children:"Energy"})]}),e.jsxs("span",{children:[t.energy,"/100"]})]}),e.jsx("div",{className:"h-3 bg-[#F0EDE8] rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${f(t.energy)} rounded-full transition-all duration-300`,style:{width:w(t.energy)}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{children:"Health"})]}),e.jsxs("span",{children:[t.health,"/100"]})]}),e.jsx("div",{className:"h-3 bg-[#F0EDE8] rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${f(t.health)} rounded-full transition-all duration-300`,style:{width:w(t.health)}})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsx("h3",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-4",children:"Reading Progress"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-[#D2691E]",children:t.totalBooksRead}),e.jsx("div",{className:"text-sm text-[#8B7355]",children:"Books Read"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-[#D2691E]",children:k(t.totalReadingTime)}),e.jsx("div",{className:"text-sm text-[#8B7355]",children:"Total Time"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-[#D2691E]",children:m.booksReadToday}),e.jsx("div",{className:"text-sm text-[#8B7355]",children:"Today's Books"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-[#D2691E]",children:k(m.readingTimeToday)}),e.jsx("div",{className:"text-sm text-[#8B7355]",children:"Today's Time"})]})]})]}),t.badges.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsx("h3",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-4",children:"Achievements"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.badges.map((E,_)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-[#F0EDE8] rounded-lg",children:[e.jsx("div",{className:"text-2xl",children:b(E)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-[#3A3A3A] capitalize text-sm",children:E.replace("-"," ")}),e.jsx("div",{className:"text-xs text-[#8B7355]",children:j(E)})]})]},_))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsx("h3",{className:"font-serif text-lg font-medium text-[#3A3A3A] mb-2",children:"Pet Management"}),e.jsx("p",{className:"text-sm text-[#8B7355] mb-4",children:"Reset your pet to start over with a new companion. This action cannot be undone."}),N?e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Are you sure you want to reset your pet?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:A,className:"px-4 py-2 bg-red-600 text-white rounded-lg text-sm font-medium",children:"Yes, Reset"}),e.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm font-medium",children:"Cancel"})]})]}):e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[e.jsx(Lt,{className:"w-4 h-4"}),"Reset Pet"]})]})]})]})},We=({children:c,className:t=""})=>e.jsx("div",{className:`min-h-screen bg-[#F7F5F3] ${t}`,children:c}),Hs=()=>{var N;const{user:c,signOut:t}=pe(),m=Y(),[n,r]=C.useState({displayName:"",bio:"",favoriteGenres:[],readingGoal:12}),[s,i]=C.useState(!1),[g,u]=C.useState(!1),[l,a]=C.useState(""),d=(N=c==null?void 0:c.id)==null?void 0:N.startsWith("guest-");C.useEffect(()=>{c&&x()},[c]);const x=async()=>{try{if(d){const f=Ae.getGuestProfile();if(f){r({displayName:f.displayName||"Guest User",bio:f.bio||"Browsing as a guest",favoriteGenres:f.favoriteGenres||[],readingGoal:f.readingGoal||12,joinedDate:f.joinedDate||(c==null?void 0:c.createdAt)});return}c!=null&&c.profile&&r({displayName:c.profile.displayName||"Guest User",bio:c.profile.bio||"Browsing as a guest",favoriteGenres:c.profile.favoriteGenres||[],readingGoal:c.profile.readingGoal||12,joinedDate:c.createdAt});return}const o=await $.getProfile();o.success&&o.profile&&r({displayName:o.profile.displayName||"",bio:o.profile.bio||"",favoriteGenres:o.profile.favoriteGenres||[],readingGoal:o.profile.readingGoal||12,joinedDate:o.profile.joinedDate})}catch(o){console.error("Error loading profile:",o)}},p=async()=>{if(c){u(!0);try{if(d){Ae.setGuestProfile(n),i(!1),console.log("Guest profile saved to localStorage:",n);return}await $.updateProfile(n),i(!1)}catch(o){console.error("Error saving profile:",o)}finally{u(!1)}}},h=()=>{l.trim()&&!n.favoriteGenres.includes(l.trim())&&(r(o=>({...o,favoriteGenres:[...o.favoriteGenres,l.trim()]})),a(""))},y=o=>{r(f=>({...f,favoriteGenres:f.favoriteGenres.filter(w=>w!==o)}))},v=()=>{t()};return c?e.jsx(We,{children:e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-amber-50 to-orange-100 py-8",children:[d&&e.jsx("div",{className:"max-w-4xl mx-auto px-4 mb-4",children:e.jsx("div",{className:"bg-orange-100 border border-orange-200 text-orange-800 px-4 py-3 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"                ",e.jsx("span",{className:"font-medium",children:"Guest Mode"}),e.jsx("span",{className:"ml-2",children:"- Profile changes saved locally. Create an account to sync across devices!"})]})})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:["            ",e.jsxs("div",{className:"bg-gradient-to-r from-amber-600 to-orange-600 px-8 py-12 text-white relative",children:[e.jsx("button",{onClick:()=>m(-1),className:"absolute top-4 left-4 p-2 rounded-full bg-white/20 hover:bg-white/30 transition-colors",title:"Go back",children:e.jsx(W,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[e.jsx("div",{className:"w-24 h-24 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-12 h-12 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})}),e.jsxs("div",{className:"text-center md:text-left flex-1",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:n.displayName||c.username||"Book Lover"}),e.jsx("p",{className:"text-amber-100 text-lg",children:n.bio||"A passionate reader exploring new worlds through books"}),n.joinedDate&&e.jsxs("p",{className:"text-amber-200 text-sm mt-2",children:["Member since ",new Date(n.joinedDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>i(!s),className:"px-6 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors duration-200 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),s?"Cancel":"Edit Profile"]}),e.jsxs("button",{onClick:v,className:"px-6 py-2 bg-red-500/80 hover:bg-red-600/80 rounded-lg transition-colors duration-200 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})]})]})]}),e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-amber-800 mb-4",children:"Personal Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Display Name"}),s?e.jsx("input",{type:"text",value:n.displayName,onChange:o=>r(f=>({...f,displayName:o.target.value})),className:"w-full px-4 py-3 border border-amber-200 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"Your display name"}):e.jsx("p",{className:"text-gray-900 px-4 py-3 bg-amber-50 rounded-lg",children:n.displayName||"Not set"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Bio"}),s?e.jsx("textarea",{value:n.bio,onChange:o=>r(f=>({...f,bio:o.target.value})),rows:4,className:"w-full px-4 py-3 border border-amber-200 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent resize-none",placeholder:"Tell us about yourself and your reading interests..."}):e.jsx("p",{className:"text-gray-900 px-4 py-3 bg-amber-50 rounded-lg min-h-[100px] whitespace-pre-wrap",children:n.bio||"No bio added yet"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Reading Goal (books per year)"}),s?e.jsx("input",{type:"number",min:"1",max:"365",value:n.readingGoal,onChange:o=>r(f=>({...f,readingGoal:parseInt(o.target.value)||12})),className:"w-full px-4 py-3 border border-amber-200 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent"}):e.jsxs("p",{className:"text-gray-900 px-4 py-3 bg-amber-50 rounded-lg",children:[n.readingGoal," books per year"]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-amber-800 mb-4",children:"Favorite Genres"}),s&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:o=>a(o.target.value),onKeyPress:o=>o.key==="Enter"&&h(),placeholder:"Add a genre...",className:"flex-1 px-4 py-2 border border-amber-200 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent"}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors duration-200",children:"Add"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.favoriteGenres.map((o,f)=>e.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-amber-100 text-amber-800 rounded-full text-sm font-medium",children:[o,s&&e.jsx("button",{onClick:()=>y(o),className:"text-amber-600 hover:text-amber-800 transition-colors duration-200",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},f)),n.favoriteGenres.length===0&&e.jsx("p",{className:"text-gray-500 italic",children:"No favorite genres added yet"})]}),e.jsxs("div",{className:"mt-8 p-6 bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl",children:[e.jsx("h3",{className:"text-lg font-bold text-amber-800 mb-4",children:"Reading Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-600",children:"0"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Books Read"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-600",children:"0"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Pages Read"})]})]})]})]})]}),s&&e.jsx("div",{className:"mt-8 flex justify-end",children:e.jsx("button",{onClick:p,disabled:g,className:"px-8 py-3 bg-amber-600 text-white rounded-lg hover:bg-amber-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200 flex items-center gap-2",children:g?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save Changes"]})})})]})]})})]})}):e.jsx(We,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-amber-50 to-orange-100 flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("h1",{className:"text-2xl font-bold text-amber-800 mb-4",children:"Please sign in to view your profile"})})})})},Ys=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"app-titlebar hidden",children:e.jsxs("div",{className:"app-titlebar-content",children:[e.jsx("div",{className:"app-titlebar-icon",children:"ðŸ“š"}),e.jsx("span",{children:"Bookish"})]})}),e.jsx(vs,{children:e.jsx(ps,{children:e.jsx(ms,{children:e.jsx(xt,{basename:"/Bookish",children:e.jsx(js,{children:e.jsxs(ft,{children:[e.jsx(K,{path:"/",element:e.jsx(Bs,{})}),e.jsx(K,{path:"/welcome",element:e.jsx(Ns,{})}),e.jsx(K,{path:"/search",element:e.jsx(_s,{})}),e.jsx(K,{path:"/library",element:e.jsx(Gs,{})}),e.jsx(K,{path:"/book",element:e.jsx(Ts,{})}),e.jsx(K,{path:"/reading",element:e.jsx(Us,{})}),e.jsx(K,{path:"/notes",element:e.jsx(Ls,{})}),e.jsx(K,{path:"/notes/add",element:e.jsx(Js,{})}),e.jsx(K,{path:"/pet",element:e.jsx($s,{})}),e.jsx(K,{path:"/stats",element:e.jsx(Ms,{})}),e.jsx(K,{path:"/profile",element:e.jsx(Hs,{})})]})})})})})})]});"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()});Yt.createRoot(document.getElementById("root")).render(e.jsx(C.StrictMode,{children:e.jsx(Ys,{})}));
